{"version":3,"sources":["assets\\Script\\21dian\\blackJackNetwork.js"],"names":["cc","Class","Component","onLoad","mainObj","node","getComponent","playerInfo","require","getInstant","audio","start","url","Lhjconfig","Server_IP","socket","io","connect","addEvent","on","emit","JSON","stringify","userid","playerId","gametype","sign","gameSign","data","changeResultJSON_Function","console","log","myCoin","Obj","score","userCoin","string","toFixed","userName","nickname","Helper","loadHead","headimgurl","texture","userHead","spriteFrame","window","BLACKJACK_LOBBYNET","disconnect","ResultCode","betCallBack","firstDeal","zhuang_card","hand_card","is_over","scheduleOnce","playerStatus","q_safe","overAction","win_res","user_score","playerCardNode","children","length","deal","is_fanbei","rollCoin","bet","myChipsLbl","ret","sys","isNative","parse"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    onLoad() {\r\n        this.mainObj = this.node.getComponent('blackJackMain');\r\n        this.playerInfo = require(\"PlayerInfo\").getInstant;\r\n        this.audio = this.node.getComponent('blackJackAudio');\r\n\r\n    },\r\n\r\n    start() {\r\n        this.url = Lhjconfig.Server_IP + ':13901';\r\n        this.socket = io.connect(this.url);\r\n        this.addEvent();\r\n    },\r\n\r\n\r\n    addEvent() {\r\n        this.socket.on('connected', () => {\r\n            this.socket.emit('LoginGame', JSON.stringify({\r\n                userid: this.playerInfo.playerId,\r\n                gametype: null,\r\n                sign: this.playerInfo.gameSign\r\n            }));\r\n        });\r\n\r\n        this.socket.on('loginGameResult', data => {\r\n            data = this.changeResultJSON_Function(data);\r\n            console.log('LoginGameResult:', data);\r\n            this.socket.emit('LoginRoom');\r\n            this.mainObj.myCoin = data.Obj.score;\r\n            this.mainObj.userCoin.string = (data.Obj.score / 100).toFixed(2);\r\n            this.mainObj.userName.string = data.Obj.nickname;\r\n            Helper.loadHead(data.Obj.headimgurl, texture => {\r\n                this.mainObj.userHead.spriteFrame = texture;\r\n            })\r\n            window.BLACKJACK_LOBBYNET.disconnect();\r\n        });\r\n\r\n        this.socket.on('LoginRoomResult', (data) => {\r\n            data = this.changeResultJSON_Function(data);\r\n            console.log('LoginRoomResult', data);\r\n        });\r\n\r\n        this.socket.on('lotteryResult', (data) => {\r\n            data = this.changeResultJSON_Function(data);\r\n            console.log('lotteryResult:', data);\r\n            if (!!data.ResultCode && data.ResultCode == 1) {\r\n                this.mainObj.betCallBack();\r\n                this.mainObj.firstDeal(data.zhuang_card[0], '', ...data.hand_card);\r\n            }\r\n            if (!data.is_over) {\r\n                this.scheduleOnce(() => {\r\n                    this.mainObj.playerStatus(data.q_safe ? 1 : 2);\r\n                }, 1.2);\r\n            } else {\r\n                this.mainObj.overAction(data.zhuang_card, data.win_res, data.user_score);\r\n            }\r\n        });\r\n\r\n        this.socket.on('sendCardResult', (data) => {\r\n            data = this.changeResultJSON_Function(data);\r\n            console.log('sendCardResult', data);\r\n            if (this.mainObj.playerCardNode.children.length != data.hand_card.length) {\r\n                this.mainObj.deal('', data.hand_card[data.hand_card.length - 1]);\r\n            }\r\n\r\n            if (data.is_fanbei) {\r\n                this.mainObj.rollCoin();\r\n                this.mainObj.myCoin = this.mainObj.myCoin - this.mainObj.bet;\r\n                this.mainObj.userCoin.string = (this.mainObj.myCoin / 100).toFixed(2);\r\n                this.mainObj.myChipsLbl.string = (this.mainObj.bet * 2 / 100).toFixed(2);\r\n            }\r\n\r\n            if (!data.is_over) {\r\n                this.scheduleOnce(() => {\r\n                    this.mainObj.playerStatus(3);\r\n                }, 0.3);\r\n            } else {\r\n                this.mainObj.overAction(data.zhuang_card, data.win_res, data.user_score);\r\n            }\r\n        });\r\n\r\n        this.socket.on('buySafeResult', (data) => {\r\n            data = this.changeResultJSON_Function(data);\r\n            console.log('buySafeResult', data);\r\n            this.mainObj.playerStatus(2);\r\n            this.mainObj.rollCoin(true);\r\n            this.mainObj.myCoin = this.mainObj.myCoin - this.mainObj.bet / 2;\r\n            this.mainObj.userCoin.string = (this.mainObj.myCoin / 100).toFixed(2);\r\n            this.mainObj.myChipsLbl.string = (this.mainObj.bet * 1.5 / 100).toFixed(2);\r\n        });\r\n    },\r\n\r\n    changeResultJSON_Function(ret) {\r\n        if (cc.sys.isNative) {\r\n            return JSON.parse(ret);\r\n        }\r\n        return ret;\r\n    },\r\n});"]}