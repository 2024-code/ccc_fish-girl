{"version":3,"sources":["assets\\Script\\Lobby\\LobbyMall.js"],"names":["cc","Class","Component","properties","shouhuo_bg","Node","xiangqing","duihuanjilu","diamondLab","Label","bangzhu","typeScroll","ScrollView","typePreb","Prefab","shopList","goodsItem","recordList","recordItem","goodsSp","Sprite","goodsIdLab","goodsPirceLab","goodsNumLab","goodsNameLab","goodsDecLab","needNumLb","shouhuoAdressEdit","EditBox","shouhuoNameEdit","shouhuoPhoneEdit","onLoad","init","playerInfo","require","getInstant","netWork","start","active","onOpenPanel","ret","content","removeAllChildren","string","playerDiamond","goodsList","i","newNode","instantiate","addChild","getComponent","setView","updateList","Object","keys","type","onBtnClick_exchange","socket","emit","updateShouhuo","res","address","playerName","phone","onBtnClick_submitInfo","adress","userName","onBtnClick_xiangqin","data","Helper","loadHead","goodsUrl","sp","spriteFrame","nowId","id","goodsPrice","goodsNum","goodsName","goodsDescribe","addBtn","parseInt","sunBtn","onBtnClick_submit","needNum","updateListData","onBtnClick_duihuanjilu","updateRecordData","onBtnClick_bangzhu","onBtnClick_closePanel","event","target","parent"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        shouhuo_bg: cc.Node,\r\n        xiangqing: cc.Node,\r\n        duihuanjilu: cc.Node,\r\n        diamondLab: cc.Label,\r\n        bangzhu: cc.Node,//帮助界面\r\n        typeScroll: cc.ScrollView,//商品类别列表\r\n        typePreb: cc.Prefab,\r\n        shopList: cc.ScrollView,//商品列表\r\n        goodsItem: cc.Prefab,\r\n        recordList: cc.ScrollView,//兑换记录列表\r\n        recordItem: cc.Prefab,\r\n        //商品详情页\r\n        goodsSp: cc.Sprite,\r\n        goodsIdLab: cc.Label,\r\n        goodsPirceLab: cc.Label,\r\n        goodsNumLab: cc.Label,\r\n        goodsNameLab: cc.Label,\r\n        goodsDecLab: cc.Label,\r\n        needNumLb: cc.Label,\r\n        //收货信息页\r\n        shouhuoAdressEdit: cc.EditBox,\r\n        shouhuoNameEdit: cc.EditBox,\r\n        shouhuoPhoneEdit: cc.EditBox,\r\n    },\r\n\r\n    onLoad() {\r\n        this.init();\r\n        this.playerInfo = require(\"PlayerInfo\").getInstant;\r\n        this.netWork = require(\"LobbyNetWork\");\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n    //初始化\r\n    init() {\r\n        this.shouhuo_bg.active = false;\r\n        this.xiangqing.active = false;\r\n        this.duihuanjilu.active = false;\r\n        this.bangzhu.active = false;\r\n    },\r\n    //打开商城面板\r\n    onOpenPanel(ret) {\r\n        this.typeScroll.content.removeAllChildren();\r\n        this.diamondLab.string = this.playerInfo.playerDiamond;\r\n        this.goodsList = ret;\r\n        for (let i in ret) {\r\n            let newNode = cc.instantiate(this.typePreb);\r\n            this.typeScroll.content.addChild(newNode);\r\n            newNode.getComponent(\"typeToggleCtrl\").setView(i);\r\n        }\r\n        this.updateList(Object.keys(ret)[0]);\r\n    },\r\n\r\n    updateList(type) {\r\n        this.shopList.content.removeAllChildren();\r\n        for (let i in this.goodsList[type]) {\r\n            let newNode = cc.instantiate(this.goodsItem);\r\n            this.shopList.content.addChild(newNode);\r\n            newNode.getComponent(\"goodsItem\").setView(this.goodsList[type][i]);\r\n        }\r\n    },\r\n    //点击收货\r\n    onBtnClick_exchange() {\r\n        this.shouhuo_bg.active = true;\r\n        this.netWork.socket.emit(\"getShopPlayerInfo\");\r\n    },\r\n    //更新收货信息\r\n    updateShouhuo(res) {\r\n        this.shouhuoAdressEdit.string = res[0].address;\r\n        this.shouhuoNameEdit.string = res[0].playerName;\r\n        this.shouhuoPhoneEdit.string = res[0].phone;\r\n    },\r\n    //提交收货信息\r\n    onBtnClick_submitInfo() {\r\n        this.shouhuo_bg.active = false;\r\n        this.netWork.socket.emit(\"updateShopPlayerInfo\", {\r\n            adress: this.shouhuoAdressEdit.string,\r\n            userName: this.shouhuoNameEdit.string,\r\n            phone: this.shouhuoPhoneEdit.string\r\n        });\r\n    },\r\n    //点击详情\r\n    onBtnClick_xiangqin(data) {\r\n        this.xiangqing.active = true;\r\n        Helper.loadHead(data.goodsUrl, sp => {\r\n            this.goodsSp.spriteFrame = sp;\r\n        });\r\n        this.nowId = data.id;\r\n        this.goodsIdLab.string = \"ID : \" + data.id;\r\n        this.goodsPirceLab.string = data.goodsPrice;\r\n        this.goodsNumLab.string = data.goodsNum;\r\n        this.goodsNameLab.string = data.goodsName;\r\n        this.goodsDecLab.string = data.goodsDescribe;\r\n        this.needNumLb.string = 1;\r\n        this.goodsPrice = data.goodsPrice;\r\n    },\r\n    //详情页增减数量\r\n    addBtn() {\r\n        if (parseInt(this.needNumLb.string) + 1 > parseInt(this.goodsNumLab.string)) {\r\n            return;\r\n        }\r\n        this.needNumLb.string = parseInt(this.needNumLb.string) + 1;\r\n        this.goodsPirceLab.string = this.goodsPrice * parseInt(this.needNumLb.string);\r\n    },\r\n\r\n    sunBtn() {\r\n        if (parseInt(this.needNumLb.string) <= 1) {\r\n            return;\r\n        }\r\n        this.needNumLb.string = parseInt(this.needNumLb.string) - 1;\r\n        this.goodsPirceLab.string = this.goodsPrice * parseInt(this.needNumLb.string);\r\n    },\r\n\r\n    onBtnClick_submit() {\r\n        this.xiangqing.active = false;\r\n        this.netWork.socket.emit(\"requestGetShopItem\", {\r\n            id: this.nowId,\r\n            needNum: parseInt(this.needNumLb.string),\r\n        });\r\n    },\r\n    //刷新商品数据\r\n    updateListData() {\r\n        this.netWork.socket.emit(\"getShoppingList\");\r\n    },\r\n    //点击兑换记录\r\n    onBtnClick_duihuanjilu() {\r\n        this.duihuanjilu.active = true;\r\n        this.netWork.socket.emit(\"getShouhuoRecord\");\r\n    },\r\n\r\n    updateRecordData(data) {\r\n        this.recordList.content.removeAllChildren();\r\n        for (let i in data) {\r\n            let newNode = cc.instantiate(this.recordItem);\r\n            this.recordList.content.addChild(newNode);\r\n            newNode.getComponent(\"shop_recordItem\").setView(data[i]);\r\n        }\r\n    },\r\n    //点击帮助\r\n    onBtnClick_bangzhu() {\r\n        this.bangzhu.active = true;\r\n    },\r\n    //通用关闭界面\r\n    onBtnClick_closePanel(event) {\r\n        //这里 event 是一个 Touch Event 对象，你可以通过 event.target 取到事件的发送节点\r\n        event.target.parent.active = false;\r\n    },\r\n});\r\n"]}