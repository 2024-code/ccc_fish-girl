
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/utils/GameUpdate.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'bae1e8w7pZABaolyBpOpwb+', 'GameUpdate');
// Script/utils/GameUpdate.js

"use strict";

/**
 * 游戏更新管理
 */
cc.Class({
  "extends": cc.Component,
  properties: {
    manifesttype: {
      "default": [],
      type: cc.Asset
    },
    _updating: false,
    _canRetry: false
  },
  onLoad: function onLoad() {
    this.gameArray = [0, 0, 0, 0, 0, 0, 0, 0];
    this.gameName = "";
    this.isChecking = false;
    this.playerInfo = require("PlayerInfo").getInstant;
  },

  /**
   * 检测版本
   * @param {*} event 
   */
  checkCb: function checkCb(event) {
    cc.log("Code: " + event.getEventCode());

    switch (event.getEventCode()) {
      case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:
        break;

      case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:
      case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:
        break;

      case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:
        var index = 1;

        switch (this.gameName) {
          case "GrabBull":
            this.gameArray[0] = 1;
            index = 1;
            break;

          case "Fish":
            this.gameArray[1] = 1;
            index = 2;
            break;

          case "Bull":
            this.gameArray[2] = 1;
            index = 3;
            break;

          case "Bde":
            this.gameArray[3] = 1;
            index = 4;
            break;

          case "TwoEight":
            this.gameArray[4] = 1;
            index = 5;
            break;

          case "LineGame":
            this.gameArray[5] = 1;
            index = 6;
            break;

          case "Land":
            this.gameArray[6] = 1;
            index = 7;
            break;
        }

        this.playerInfo.localVersion[index] = this.serverVersion;
        cc.log(this.serverVersion);
        cc.log(this.playerInfo.localVersion);
        this.writeGameVersion_Function(this.playerInfo.localVersion, function () {
          cc.game.restart();
        });
        this._updating = false;
        break;

      case jsb.EventAssetsManager.NEW_VERSION_FOUND:
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.active = true;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").getComponent("cc.ProgressBar").progress = 0;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").active = true;
        this.node.getComponent("LobbyMain").bg_Black.active = true;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("lb_Tips").getComponent("cc.Label").string = "游戏需要更新到 " + this.serverVersion + " 版本";
        break;

      default:
        break;
    }

    cc.eventManager.removeListener(this._checkListener);
    this._checkListener = null;
    this._updating = false;
    this.hotUpdate();
  },

  /**
   * 更新版本
   * @param {*} event 
   */
  updateCb: function updateCb(event) {
    //是否更新完成
    var isFinished = false; //是否需要更新

    var isUpdate = false;

    switch (event.getEventCode()) {
      case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:
        isUpdate = true;
        break;

      case jsb.EventAssetsManager.UPDATE_PROGRESSION:
        this.node.getComponent("LobbyMain").checkUpdateTime = 20;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").active = true;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").getComponent("cc.ProgressBar").progress = event.getDownloadedBytes() / event.getTotalBytes();
        event.getMessage();
        break;

      case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:
      case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:
        isUpdate = true;
        break;

      case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:
        cc.log("已是最新版本");
        this._updating = false;
        isUpdate = true;
        break;

      case jsb.EventAssetsManager.UPDATE_FINISHED:
        cc.log("更新完成");
        this.node.getComponent("LobbyMain").checkUpdateTimeOut = false;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").active = true;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").getComponent("cc.ProgressBar").progress = 1;
        isFinished = true;
        break;

      case jsb.EventAssetsManager.UPDATE_FAILED:
        this._updating = false;
        this._canRetry = true;
        break;

      case jsb.EventAssetsManager.ERROR_UPDATING:
        break;

      case jsb.EventAssetsManager.ERROR_DECOMPRESS:
        break;
    }

    if (isUpdate) {
      cc.eventManager.removeListener(this._updateListener);
      this._updateListener = null;
      this._updating = false;
    }

    if (isFinished) {
      cc.eventManager.removeListener(this._updateListener);
      this._updateListener = null;
      var paths = jsb.fileUtils.getSearchPaths();

      var local_paths = this._am.getLocalManifest().getSearchPaths();

      console.log(JSON.stringify(local_paths));
      Array.prototype.unshift(paths, local_paths);
      cc.sys.localStorage.setItem("HotUpdateSearchPaths", JSON.stringify(paths));
      jsb.fileUtils.setSearchPaths(paths);
      cc.audioEngine.stopAll();
      var index = 0;

      switch (this.gameName) {
        case "GrabBull":
          this.gameArray[0] = 1;
          index = 1;
          break;

        case "Fish":
          this.gameArray[1] = 1;
          index = 2;
          break;

        case "Bull":
          this.gameArray[2] = 1;
          index = 3;
          break;

        case "Bde":
          this.gameArray[3] = 1;
          index = 4;
          break;

        case "TwoEight":
          this.gameArray[4] = 1;
          index = 5;
          break;

        case "LineGame":
          this.gameArray[5] = 1;
          index = 6;
          break;

        case "Land":
          this.gameArray[6] = 1;
          index = 7;
      }

      var gameVersion = JSON.parse(cc.sys.localStorage.getItem("gameVersion"));
      this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").active = true;
      this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").getComponent("cc.ProgressBar").progress = 1;

      if (gameVersion !== null) {
        this.playerInfo.localVersion[index] = this.serverVersion;
        this.writeGameVersion_Function(this.playerInfo.localVersion, function () {
          cc.game.restart();
        });
      }
    }
  },

  /**
   * 重试
   */
  retry: function retry() {
    if (!this._updating && this._canRetry) {
      this._canRetry = false, this._am.downloadFailedAssets();
    }
  },

  /**
   * 检测更新
   */
  checkUpdate: function checkUpdate() {
    if (this._updating || this._am.getLocalManifest().isLoaded()) {
      this._checkListener = new jsb.EventListenerAssetsManager(this._am, this.checkCb.bind(this));
      cc.eventManager.addListener(this._checkListener, 1);

      this._am.checkUpdate();

      this._updating = true;
    }
  },

  /**
   * 热更新
   */
  hotUpdate: function hotUpdate() {
    this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCb.bind(this));
    cc.eventManager.addListener(this._updateListener, 1);
    this._failCount = 0;

    this._am.update();

    this.versionA === this.versionB ? this._updating = false : this._updating = true;
  },

  /**
   * 
   * @param {*} gameName 
   */
  checkGameUpdate_Function: function checkGameUpdate_Function(gameName) {
    this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("lb_Tips").getComponent("cc.Label").string = gameName;
    var index = 0;

    switch (gameName) {
      case "GrabBull":
        index = 0;
        break;

      case "Fish":
        index = 1;
        break;

      case "Bull":
        index = 2;
        break;

      case "Bde":
        index = 3;
        break;

      case "TwoEight":
        index = 4;
        break;

      case "LineGame":
        index = 5;
        break;

      case "Land":
        index = 6;
        break;

      case "Runing":
        index = 7;
        break;
    }

    this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("lb_Tips").getComponent("cc.Label").string = index;
    this.gameName = gameName;
    this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("lb_Tips").getComponent("cc.Label").string = this.gameName;

    if (this.gameArray[index]) {
      if (this.gameName == "LineGame") {//this.node.getComponent("LobbyMain").loginGameRoom_Function(this.node.getComponent("LobbyMain").com_GameMenu.getChildByName("LineGame").getComponent("LobbyButtonClick"), "LineGame");
      } else {
        this.node.getComponent("LobbyMain").gameMenuButtonClick_Function("com_" + this.gameName);
        this.node.getComponent("LobbyMain").bg_Black.active = false;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.active = false;
        this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("pb_Loading").getComponent("cc.ProgressBar").progress = 1;
      }
    } else {
      var path = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : "/") + gameName; //cc.log(path);

      this._am = new jsb.AssetsManager(this.manifestUrl[index], path);
      cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS || this._am.retain(); //cc.log(index);

      var self = this;
      this.serverVersion = 0;
      this.node.getComponent("LobbyMain").com_UpdateMessageBox.getChildByName("lb_Tips").getComponent("cc.Label").string = "获取版本号..."; //检测版本

      this._am.setVersionCompareHandle(function (versionA, versionB) {
        self.serverVersion = versionB;
        cc.log("JS Custom Version Compare: version A is " + versionA + ", version B is " + versionB);
        self.node.getComponent("LobbyMain").checkUpdateTimeOut = true;
        var versionAList = versionA.split(".");
        var versionBList = versionB.split(".");

        for (var i = 0; i < versionAList.length; i++) {
          var version_A = parseInt(versionAList[i]);
          var version_B = parseInt(versionBList[i] || 0);

          if (version_A !== version_B) {
            return -1;
          }
        }

        if (versionBList.length != versionAList.length) {
          return -1;
        } else {
          self._updating = false;
          return 0;
        }
      });

      this.size = 0;

      this._am.setVerifyCallback(function (err, ret) {
        ret.compressed, ret.md5, ret.path;
        return self.size = ret.size, true;
      });

      if (cc.sys.os === cc.sys.OS_ANDROID) {
        this._am.setMaxConcurrentTask(1);
      }

      this.checkUpdate();
    }
  },

  /**
   * 将游戏版本写入缓存数据
   * @param {*} version 
   * @param {*} callback 
   */
  writeGameVersion_Function: function writeGameVersion_Function(version, callback) {
    var data = null;
    data = {
      gameVersion: version
    }, cc.sys.localStorage.setItem("gameVersion", JSON.stringify(data));
    callback && callback();
  },

  /**
   * 销毁
   */
  onDestroy: function onDestroy() {
    if (this._updateListener) {
      cc.eventManager.removeListener(this._updateListener);
      this._updateListener = null;
    }

    if (this._am && !cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS) {
      this._am.release();
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFx1dGlsc1xcR2FtZVVwZGF0ZS5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm1hbmlmZXN0dHlwZSIsInR5cGUiLCJBc3NldCIsIl91cGRhdGluZyIsIl9jYW5SZXRyeSIsIm9uTG9hZCIsImdhbWVBcnJheSIsImdhbWVOYW1lIiwiaXNDaGVja2luZyIsInBsYXllckluZm8iLCJyZXF1aXJlIiwiZ2V0SW5zdGFudCIsImNoZWNrQ2IiLCJldmVudCIsImxvZyIsImdldEV2ZW50Q29kZSIsImpzYiIsIkV2ZW50QXNzZXRzTWFuYWdlciIsIkVSUk9SX05PX0xPQ0FMX01BTklGRVNUIiwiRVJST1JfRE9XTkxPQURfTUFOSUZFU1QiLCJFUlJPUl9QQVJTRV9NQU5JRkVTVCIsIkFMUkVBRFlfVVBfVE9fREFURSIsImluZGV4IiwibG9jYWxWZXJzaW9uIiwic2VydmVyVmVyc2lvbiIsIndyaXRlR2FtZVZlcnNpb25fRnVuY3Rpb24iLCJnYW1lIiwicmVzdGFydCIsIk5FV19WRVJTSU9OX0ZPVU5EIiwibm9kZSIsImdldENvbXBvbmVudCIsImNvbV9VcGRhdGVNZXNzYWdlQm94IiwiYWN0aXZlIiwiZ2V0Q2hpbGRCeU5hbWUiLCJwcm9ncmVzcyIsImJnX0JsYWNrIiwic3RyaW5nIiwiZXZlbnRNYW5hZ2VyIiwicmVtb3ZlTGlzdGVuZXIiLCJfY2hlY2tMaXN0ZW5lciIsImhvdFVwZGF0ZSIsInVwZGF0ZUNiIiwiaXNGaW5pc2hlZCIsImlzVXBkYXRlIiwiVVBEQVRFX1BST0dSRVNTSU9OIiwiY2hlY2tVcGRhdGVUaW1lIiwiZ2V0RG93bmxvYWRlZEJ5dGVzIiwiZ2V0VG90YWxCeXRlcyIsImdldE1lc3NhZ2UiLCJVUERBVEVfRklOSVNIRUQiLCJjaGVja1VwZGF0ZVRpbWVPdXQiLCJVUERBVEVfRkFJTEVEIiwiRVJST1JfVVBEQVRJTkciLCJFUlJPUl9ERUNPTVBSRVNTIiwiX3VwZGF0ZUxpc3RlbmVyIiwicGF0aHMiLCJmaWxlVXRpbHMiLCJnZXRTZWFyY2hQYXRocyIsImxvY2FsX3BhdGhzIiwiX2FtIiwiZ2V0TG9jYWxNYW5pZmVzdCIsImNvbnNvbGUiLCJKU09OIiwic3RyaW5naWZ5IiwiQXJyYXkiLCJwcm90b3R5cGUiLCJ1bnNoaWZ0Iiwic3lzIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInNldFNlYXJjaFBhdGhzIiwiYXVkaW9FbmdpbmUiLCJzdG9wQWxsIiwiZ2FtZVZlcnNpb24iLCJwYXJzZSIsImdldEl0ZW0iLCJyZXRyeSIsImRvd25sb2FkRmFpbGVkQXNzZXRzIiwiY2hlY2tVcGRhdGUiLCJpc0xvYWRlZCIsIkV2ZW50TGlzdGVuZXJBc3NldHNNYW5hZ2VyIiwiYmluZCIsImFkZExpc3RlbmVyIiwiX2ZhaWxDb3VudCIsInVwZGF0ZSIsInZlcnNpb25BIiwidmVyc2lvbkIiLCJjaGVja0dhbWVVcGRhdGVfRnVuY3Rpb24iLCJnYW1lTWVudUJ1dHRvbkNsaWNrX0Z1bmN0aW9uIiwicGF0aCIsImdldFdyaXRhYmxlUGF0aCIsIkFzc2V0c01hbmFnZXIiLCJtYW5pZmVzdFVybCIsIkVOQUJMRV9HQ19GT1JfTkFUSVZFX09CSkVDVFMiLCJyZXRhaW4iLCJzZWxmIiwic2V0VmVyc2lvbkNvbXBhcmVIYW5kbGUiLCJ2ZXJzaW9uQUxpc3QiLCJzcGxpdCIsInZlcnNpb25CTGlzdCIsImkiLCJsZW5ndGgiLCJ2ZXJzaW9uX0EiLCJwYXJzZUludCIsInZlcnNpb25fQiIsInNpemUiLCJzZXRWZXJpZnlDYWxsYmFjayIsImVyciIsInJldCIsImNvbXByZXNzZWQiLCJtZDUiLCJvcyIsIk9TX0FORFJPSUQiLCJzZXRNYXhDb25jdXJyZW50VGFzayIsInZlcnNpb24iLCJjYWxsYmFjayIsImRhdGEiLCJvbkRlc3Ryb3kiLCJyZWxlYXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsWUFBWSxFQUFFO0FBQ1YsaUJBQVMsRUFEQztBQUVWQyxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGQyxLQUROO0FBS1JDLElBQUFBLFNBQVMsRUFBRSxLQUxIO0FBTVJDLElBQUFBLFNBQVMsRUFBRTtBQU5ILEdBSFA7QUFXTEMsRUFBQUEsTUFBTSxFQUFFLGtCQUFXO0FBQ2YsU0FBS0MsU0FBTCxHQUFpQixDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxFQUFVLENBQVYsRUFBYSxDQUFiLEVBQWdCLENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLENBQWpCO0FBQ0EsU0FBS0MsUUFBTCxHQUFnQixFQUFoQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0IsS0FBbEI7QUFDQSxTQUFLQyxVQUFMLEdBQWtCQyxPQUFPLENBQUMsWUFBRCxDQUFQLENBQXNCQyxVQUF4QztBQUNILEdBaEJJOztBQWlCTDtBQUNKO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxPQUFPLEVBQUUsaUJBQVNDLEtBQVQsRUFBZ0I7QUFDckJqQixJQUFBQSxFQUFFLENBQUNrQixHQUFILENBQU8sV0FBV0QsS0FBSyxDQUFDRSxZQUFOLEVBQWxCOztBQUNBLFlBQVFGLEtBQUssQ0FBQ0UsWUFBTixFQUFSO0FBRUksV0FBS0MsR0FBRyxDQUFDQyxrQkFBSixDQUF1QkMsdUJBQTVCO0FBQ0k7O0FBQ0osV0FBS0YsR0FBRyxDQUFDQyxrQkFBSixDQUF1QkUsdUJBQTVCO0FBQ0EsV0FBS0gsR0FBRyxDQUFDQyxrQkFBSixDQUF1Qkcsb0JBQTVCO0FBQ0k7O0FBQ0osV0FBS0osR0FBRyxDQUFDQyxrQkFBSixDQUF1Qkksa0JBQTVCO0FBQ0ksWUFBSUMsS0FBSyxHQUFHLENBQVo7O0FBQ0EsZ0JBQVEsS0FBS2YsUUFBYjtBQUNBLGVBQUssVUFBTDtBQUNJLGlCQUFLRCxTQUFMLENBQWUsQ0FBZixJQUFvQixDQUFwQjtBQUNBZ0IsWUFBQUEsS0FBSyxHQUFHLENBQVI7QUFDQTs7QUFDSixlQUFLLE1BQUw7QUFDSSxpQkFBS2hCLFNBQUwsQ0FBZSxDQUFmLElBQW9CLENBQXBCO0FBQ0FnQixZQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNBOztBQUNKLGVBQUssTUFBTDtBQUNJLGlCQUFLaEIsU0FBTCxDQUFlLENBQWYsSUFBb0IsQ0FBcEI7QUFDQWdCLFlBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osZUFBSyxLQUFMO0FBQ0ksaUJBQUtoQixTQUFMLENBQWUsQ0FBZixJQUFvQixDQUFwQjtBQUNBZ0IsWUFBQUEsS0FBSyxHQUFHLENBQVI7QUFDQTs7QUFDSixlQUFLLFVBQUw7QUFDSSxpQkFBS2hCLFNBQUwsQ0FBZSxDQUFmLElBQW9CLENBQXBCO0FBQ0FnQixZQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNBOztBQUNKLGVBQUssVUFBTDtBQUNJLGlCQUFLaEIsU0FBTCxDQUFlLENBQWYsSUFBb0IsQ0FBcEI7QUFDQWdCLFlBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osZUFBSyxNQUFMO0FBQ0ksaUJBQUtoQixTQUFMLENBQWUsQ0FBZixJQUFvQixDQUFwQjtBQUNBZ0IsWUFBQUEsS0FBSyxHQUFHLENBQVI7QUFDQTtBQTVCSjs7QUE4QkEsYUFBS2IsVUFBTCxDQUFnQmMsWUFBaEIsQ0FBNkJELEtBQTdCLElBQXNDLEtBQUtFLGFBQTNDO0FBQ0E1QixRQUFBQSxFQUFFLENBQUNrQixHQUFILENBQU8sS0FBS1UsYUFBWjtBQUNBNUIsUUFBQUEsRUFBRSxDQUFDa0IsR0FBSCxDQUFPLEtBQUtMLFVBQUwsQ0FBZ0JjLFlBQXZCO0FBQ0EsYUFBS0UseUJBQUwsQ0FBK0IsS0FBS2hCLFVBQUwsQ0FBZ0JjLFlBQS9DLEVBQTRELFlBQVc7QUFDbkUzQixVQUFBQSxFQUFFLENBQUM4QixJQUFILENBQVFDLE9BQVI7QUFDSCxTQUZEO0FBR0EsYUFBS3hCLFNBQUwsR0FBaUIsS0FBakI7QUFDQTs7QUFDSixXQUFLYSxHQUFHLENBQUNDLGtCQUFKLENBQXVCVyxpQkFBNUI7QUFDSSxhQUFLQyxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REMsTUFBekQsR0FBa0UsSUFBbEU7QUFDQSxhQUFLSCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsWUFBeEUsRUFBc0ZILFlBQXRGLENBQW1HLGdCQUFuRyxFQUFxSEksUUFBckgsR0FBZ0ksQ0FBaEk7QUFDQSxhQUFLTCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsWUFBeEUsRUFBc0ZELE1BQXRGLEdBQStGLElBQS9GO0FBQ0EsYUFBS0gsSUFBTCxDQUFVQyxZQUFWLENBQXVCLFdBQXZCLEVBQW9DSyxRQUFwQyxDQUE2Q0gsTUFBN0MsR0FBc0QsSUFBdEQ7QUFDQSxhQUFLSCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsU0FBeEUsRUFBbUZILFlBQW5GLENBQWdHLFVBQWhHLEVBQTRHTSxNQUE1RyxHQUFxSCxhQUFhLEtBQUtaLGFBQWxCLEdBQWtDLEtBQXZKO0FBQ0E7O0FBQ0o7QUFDSTtBQXZEUjs7QUF5REE1QixJQUFBQSxFQUFFLENBQUN5QyxZQUFILENBQWdCQyxjQUFoQixDQUErQixLQUFLQyxjQUFwQztBQUNBLFNBQUtBLGNBQUwsR0FBc0IsSUFBdEI7QUFDQSxTQUFLcEMsU0FBTCxHQUFpQixLQUFqQjtBQUNBLFNBQUtxQyxTQUFMO0FBQ0gsR0FwRkk7O0FBc0ZMO0FBQ0o7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRSxrQkFBUzVCLEtBQVQsRUFBZ0I7QUFDdEI7QUFDQSxRQUFJNkIsVUFBVSxHQUFHLEtBQWpCLENBRnNCLENBR3RCOztBQUNBLFFBQUlDLFFBQVEsR0FBRyxLQUFmOztBQUNBLFlBQVE5QixLQUFLLENBQUNFLFlBQU4sRUFBUjtBQUVJLFdBQUtDLEdBQUcsQ0FBQ0Msa0JBQUosQ0FBdUJDLHVCQUE1QjtBQUNJeUIsUUFBQUEsUUFBUSxHQUFHLElBQVg7QUFDQTs7QUFDSixXQUFLM0IsR0FBRyxDQUFDQyxrQkFBSixDQUF1QjJCLGtCQUE1QjtBQUNJLGFBQUtmLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ2UsZUFBcEMsR0FBc0QsRUFBdEQ7QUFDQSxhQUFLaEIsSUFBTCxDQUFVQyxZQUFWLENBQXVCLFdBQXZCLEVBQW9DQyxvQkFBcEMsQ0FBeURFLGNBQXpELENBQXdFLFlBQXhFLEVBQXNGRCxNQUF0RixHQUErRixJQUEvRjtBQUNBLGFBQUtILElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ0Msb0JBQXBDLENBQXlERSxjQUF6RCxDQUF3RSxZQUF4RSxFQUFzRkgsWUFBdEYsQ0FBbUcsZ0JBQW5HLEVBQXFISSxRQUFySCxHQUFnSXJCLEtBQUssQ0FBQ2lDLGtCQUFOLEtBQTZCakMsS0FBSyxDQUFDa0MsYUFBTixFQUE3SjtBQUNBbEMsUUFBQUEsS0FBSyxDQUFDbUMsVUFBTjtBQUNBOztBQUNKLFdBQUtoQyxHQUFHLENBQUNDLGtCQUFKLENBQXVCRSx1QkFBNUI7QUFDQSxXQUFLSCxHQUFHLENBQUNDLGtCQUFKLENBQXVCRyxvQkFBNUI7QUFDSXVCLFFBQUFBLFFBQVEsR0FBRyxJQUFYO0FBQ0E7O0FBQ0osV0FBSzNCLEdBQUcsQ0FBQ0Msa0JBQUosQ0FBdUJJLGtCQUE1QjtBQUNJekIsUUFBQUEsRUFBRSxDQUFDa0IsR0FBSCxDQUFPLFFBQVA7QUFDQSxhQUFLWCxTQUFMLEdBQWlCLEtBQWpCO0FBQ0F3QyxRQUFBQSxRQUFRLEdBQUcsSUFBWDtBQUNBOztBQUNKLFdBQUszQixHQUFHLENBQUNDLGtCQUFKLENBQXVCZ0MsZUFBNUI7QUFDSXJELFFBQUFBLEVBQUUsQ0FBQ2tCLEdBQUgsQ0FBTyxNQUFQO0FBQ0EsYUFBS2UsSUFBTCxDQUFVQyxZQUFWLENBQXVCLFdBQXZCLEVBQW9Db0Isa0JBQXBDLEdBQXlELEtBQXpEO0FBQ0EsYUFBS3JCLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ0Msb0JBQXBDLENBQXlERSxjQUF6RCxDQUF3RSxZQUF4RSxFQUFzRkQsTUFBdEYsR0FBK0YsSUFBL0Y7QUFDQSxhQUFLSCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsWUFBeEUsRUFBc0ZILFlBQXRGLENBQW1HLGdCQUFuRyxFQUFxSEksUUFBckgsR0FBZ0ksQ0FBaEk7QUFDQVEsUUFBQUEsVUFBVSxHQUFHLElBQWI7QUFDQTs7QUFDSixXQUFLMUIsR0FBRyxDQUFDQyxrQkFBSixDQUF1QmtDLGFBQTVCO0FBQ0ksYUFBS2hELFNBQUwsR0FBaUIsS0FBakI7QUFDQSxhQUFLQyxTQUFMLEdBQWlCLElBQWpCO0FBQ0E7O0FBQ0osV0FBS1ksR0FBRyxDQUFDQyxrQkFBSixDQUF1Qm1DLGNBQTVCO0FBQ0k7O0FBQ0osV0FBS3BDLEdBQUcsQ0FBQ0Msa0JBQUosQ0FBdUJvQyxnQkFBNUI7QUFDSTtBQWxDUjs7QUFvQ0EsUUFBR1YsUUFBSCxFQUNBO0FBQ0kvQyxNQUFBQSxFQUFFLENBQUN5QyxZQUFILENBQWdCQyxjQUFoQixDQUErQixLQUFLZ0IsZUFBcEM7QUFDQSxXQUFLQSxlQUFMLEdBQXVCLElBQXZCO0FBQ0EsV0FBS25ELFNBQUwsR0FBaUIsS0FBakI7QUFDSDs7QUFDRCxRQUFJdUMsVUFBSixFQUNBO0FBQ0k5QyxNQUFBQSxFQUFFLENBQUN5QyxZQUFILENBQWdCQyxjQUFoQixDQUErQixLQUFLZ0IsZUFBcEM7QUFDQSxXQUFLQSxlQUFMLEdBQXVCLElBQXZCO0FBQ0EsVUFBSUMsS0FBSyxHQUFHdkMsR0FBRyxDQUFDd0MsU0FBSixDQUFjQyxjQUFkLEVBQVo7O0FBQ0EsVUFBSUMsV0FBVyxHQUFHLEtBQUtDLEdBQUwsQ0FBU0MsZ0JBQVQsR0FBNEJILGNBQTVCLEVBQWxCOztBQUNBSSxNQUFBQSxPQUFPLENBQUMvQyxHQUFSLENBQVlnRCxJQUFJLENBQUNDLFNBQUwsQ0FBZUwsV0FBZixDQUFaO0FBQ0FNLE1BQUFBLEtBQUssQ0FBQ0MsU0FBTixDQUFnQkMsT0FBaEIsQ0FBd0JYLEtBQXhCLEVBQStCRyxXQUEvQjtBQUNBOUQsTUFBQUEsRUFBRSxDQUFDdUUsR0FBSCxDQUFPQyxZQUFQLENBQW9CQyxPQUFwQixDQUE0QixzQkFBNUIsRUFBb0RQLElBQUksQ0FBQ0MsU0FBTCxDQUFlUixLQUFmLENBQXBEO0FBQ0F2QyxNQUFBQSxHQUFHLENBQUN3QyxTQUFKLENBQWNjLGNBQWQsQ0FBNkJmLEtBQTdCO0FBQ0EzRCxNQUFBQSxFQUFFLENBQUMyRSxXQUFILENBQWVDLE9BQWY7QUFDQSxVQUFJbEQsS0FBSyxHQUFHLENBQVo7O0FBQ0EsY0FBUSxLQUFLZixRQUFiO0FBQ0EsYUFBSyxVQUFMO0FBQ0ksZUFBS0QsU0FBTCxDQUFlLENBQWYsSUFBb0IsQ0FBcEI7QUFDQWdCLFVBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osYUFBSyxNQUFMO0FBQ0ksZUFBS2hCLFNBQUwsQ0FBZSxDQUFmLElBQW9CLENBQXBCO0FBQ0FnQixVQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNBOztBQUNKLGFBQUssTUFBTDtBQUNJLGVBQUtoQixTQUFMLENBQWUsQ0FBZixJQUFvQixDQUFwQjtBQUNBZ0IsVUFBQUEsS0FBSyxHQUFHLENBQVI7QUFDQTs7QUFDSixhQUFLLEtBQUw7QUFDSSxlQUFLaEIsU0FBTCxDQUFlLENBQWYsSUFBb0IsQ0FBcEI7QUFDQWdCLFVBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osYUFBSyxVQUFMO0FBQ0ksZUFBS2hCLFNBQUwsQ0FBZSxDQUFmLElBQW9CLENBQXBCO0FBQ0FnQixVQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNBOztBQUNKLGFBQUssVUFBTDtBQUNJLGVBQUtoQixTQUFMLENBQWUsQ0FBZixJQUFvQixDQUFwQjtBQUNBZ0IsVUFBQUEsS0FBSyxHQUFHLENBQVI7QUFDQTs7QUFDSixhQUFLLE1BQUw7QUFDSSxlQUFLaEIsU0FBTCxDQUFlLENBQWYsSUFBb0IsQ0FBcEI7QUFDQWdCLFVBQUFBLEtBQUssR0FBRyxDQUFSO0FBM0JKOztBQTZCQSxVQUFJbUQsV0FBVyxHQUFHWCxJQUFJLENBQUNZLEtBQUwsQ0FBVzlFLEVBQUUsQ0FBQ3VFLEdBQUgsQ0FBT0MsWUFBUCxDQUFvQk8sT0FBcEIsQ0FBNEIsYUFBNUIsQ0FBWCxDQUFsQjtBQUNBLFdBQUs5QyxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsWUFBeEUsRUFBc0ZELE1BQXRGLEdBQStGLElBQS9GO0FBQ0EsV0FBS0gsSUFBTCxDQUFVQyxZQUFWLENBQXVCLFdBQXZCLEVBQW9DQyxvQkFBcEMsQ0FBeURFLGNBQXpELENBQXdFLFlBQXhFLEVBQXNGSCxZQUF0RixDQUFtRyxnQkFBbkcsRUFBcUhJLFFBQXJILEdBQWdJLENBQWhJOztBQUNBLFVBQUd1QyxXQUFXLEtBQUssSUFBbkIsRUFDQTtBQUNJLGFBQUtoRSxVQUFMLENBQWdCYyxZQUFoQixDQUE2QkQsS0FBN0IsSUFBc0MsS0FBS0UsYUFBM0M7QUFDQSxhQUFLQyx5QkFBTCxDQUErQixLQUFLaEIsVUFBTCxDQUFnQmMsWUFBL0MsRUFBNEQsWUFBVztBQUNuRTNCLFVBQUFBLEVBQUUsQ0FBQzhCLElBQUgsQ0FBUUMsT0FBUjtBQUNILFNBRkQ7QUFHSDtBQUNKO0FBQ0osR0E3TEk7O0FBOExMO0FBQ0o7QUFDQTtBQUNJaUQsRUFBQUEsS0FBSyxFQUFFLGlCQUFXO0FBQ2QsUUFBRyxDQUFDLEtBQUt6RSxTQUFOLElBQW1CLEtBQUtDLFNBQTNCLEVBQ0E7QUFDSSxXQUFLQSxTQUFMLEdBQWlCLEtBQWpCLEVBQXdCLEtBQUt1RCxHQUFMLENBQVNrQixvQkFBVCxFQUF4QjtBQUNIO0FBQ0osR0F0TUk7O0FBd01MO0FBQ0o7QUFDQTtBQUNJQyxFQUFBQSxXQUFXLEVBQUUsdUJBQVc7QUFDcEIsUUFBRyxLQUFLM0UsU0FBTCxJQUFrQixLQUFLd0QsR0FBTCxDQUFTQyxnQkFBVCxHQUE0Qm1CLFFBQTVCLEVBQXJCLEVBQ0E7QUFDSSxXQUFLeEMsY0FBTCxHQUFzQixJQUFJdkIsR0FBRyxDQUFDZ0UsMEJBQVIsQ0FBbUMsS0FBS3JCLEdBQXhDLEVBQTZDLEtBQUsvQyxPQUFMLENBQWFxRSxJQUFiLENBQWtCLElBQWxCLENBQTdDLENBQXRCO0FBQ0FyRixNQUFBQSxFQUFFLENBQUN5QyxZQUFILENBQWdCNkMsV0FBaEIsQ0FBNEIsS0FBSzNDLGNBQWpDLEVBQWlELENBQWpEOztBQUNBLFdBQUtvQixHQUFMLENBQVNtQixXQUFUOztBQUNBLFdBQUszRSxTQUFMLEdBQWlCLElBQWpCO0FBQ0g7QUFDSixHQW5OSTs7QUFxTkw7QUFDSjtBQUNBO0FBQ0lxQyxFQUFBQSxTQUFTLEVBQUUscUJBQVc7QUFDbEIsU0FBS2MsZUFBTCxHQUF1QixJQUFJdEMsR0FBRyxDQUFDZ0UsMEJBQVIsQ0FBbUMsS0FBS3JCLEdBQXhDLEVBQTZDLEtBQUtsQixRQUFMLENBQWN3QyxJQUFkLENBQW1CLElBQW5CLENBQTdDLENBQXZCO0FBQ0FyRixJQUFBQSxFQUFFLENBQUN5QyxZQUFILENBQWdCNkMsV0FBaEIsQ0FBNEIsS0FBSzVCLGVBQWpDLEVBQWtELENBQWxEO0FBQ0EsU0FBSzZCLFVBQUwsR0FBa0IsQ0FBbEI7O0FBQ0EsU0FBS3hCLEdBQUwsQ0FBU3lCLE1BQVQ7O0FBQ0EsU0FBS0MsUUFBTCxLQUFrQixLQUFLQyxRQUF2QixHQUFrQyxLQUFLbkYsU0FBTCxHQUFpQixLQUFuRCxHQUEyRCxLQUFLQSxTQUFMLEdBQWlCLElBQTVFO0FBQ0gsR0E5Tkk7O0FBZ09MO0FBQ0o7QUFDQTtBQUNBO0FBQ0lvRixFQUFBQSx3QkFBd0IsRUFBRSxrQ0FBU2hGLFFBQVQsRUFBbUI7QUFDekMsU0FBS3NCLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ0Msb0JBQXBDLENBQXlERSxjQUF6RCxDQUF3RSxTQUF4RSxFQUFtRkgsWUFBbkYsQ0FBZ0csVUFBaEcsRUFBNEdNLE1BQTVHLEdBQXFIN0IsUUFBckg7QUFDQSxRQUFJZSxLQUFLLEdBQUcsQ0FBWjs7QUFDQSxZQUFRZixRQUFSO0FBRUksV0FBSyxVQUFMO0FBQ0llLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxNQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxNQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxLQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxVQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxVQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxNQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7O0FBQ0osV0FBSyxRQUFMO0FBQ0lBLFFBQUFBLEtBQUssR0FBRyxDQUFSO0FBQ0E7QUF6QlI7O0FBMkJBLFNBQUtPLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ0Msb0JBQXBDLENBQXlERSxjQUF6RCxDQUF3RSxTQUF4RSxFQUFtRkgsWUFBbkYsQ0FBZ0csVUFBaEcsRUFBNEdNLE1BQTVHLEdBQXFIZCxLQUFySDtBQUNBLFNBQUtmLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0EsU0FBS3NCLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ0Msb0JBQXBDLENBQXlERSxjQUF6RCxDQUF3RSxTQUF4RSxFQUFtRkgsWUFBbkYsQ0FBZ0csVUFBaEcsRUFBNEdNLE1BQTVHLEdBQXFILEtBQUs3QixRQUExSDs7QUFFQSxRQUFJLEtBQUtELFNBQUwsQ0FBZWdCLEtBQWYsQ0FBSixFQUNBO0FBQ0ksVUFBRyxLQUFLZixRQUFMLElBQWlCLFVBQXBCLEVBQ0EsQ0FDSTtBQUNILE9BSEQsTUFLQTtBQUNJLGFBQUtzQixJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0MwRCw0QkFBcEMsQ0FBaUUsU0FBUyxLQUFLakYsUUFBL0U7QUFDQSxhQUFLc0IsSUFBTCxDQUFVQyxZQUFWLENBQXVCLFdBQXZCLEVBQW9DSyxRQUFwQyxDQUE2Q0gsTUFBN0MsR0FBc0QsS0FBdEQ7QUFDQSxhQUFLSCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REMsTUFBekQsR0FBa0UsS0FBbEU7QUFDQSxhQUFLSCxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsWUFBeEUsRUFBc0ZILFlBQXRGLENBQW1HLGdCQUFuRyxFQUFxSEksUUFBckgsR0FBZ0ksQ0FBaEk7QUFDSDtBQUNKLEtBYkQsTUFlQTtBQUNJLFVBQUl1RCxJQUFJLEdBQUcsQ0FBQ3pFLEdBQUcsQ0FBQ3dDLFNBQUosR0FBZ0J4QyxHQUFHLENBQUN3QyxTQUFKLENBQWNrQyxlQUFkLEVBQWhCLEdBQWtELEdBQW5ELElBQTBEbkYsUUFBckUsQ0FESixDQUVJOztBQUNBLFdBQUtvRCxHQUFMLEdBQVcsSUFBSTNDLEdBQUcsQ0FBQzJFLGFBQVIsQ0FBc0IsS0FBS0MsV0FBTCxDQUFpQnRFLEtBQWpCLENBQXRCLEVBQStDbUUsSUFBL0MsQ0FBWDtBQUNBN0YsTUFBQUEsRUFBRSxDQUFDdUUsR0FBSCxDQUFPMEIsNEJBQVAsSUFBdUMsS0FBS2xDLEdBQUwsQ0FBU21DLE1BQVQsRUFBdkMsQ0FKSixDQUtJOztBQUNBLFVBQUlDLElBQUksR0FBRyxJQUFYO0FBQ0EsV0FBS3ZFLGFBQUwsR0FBcUIsQ0FBckI7QUFDQSxXQUFLSyxJQUFMLENBQVVDLFlBQVYsQ0FBdUIsV0FBdkIsRUFBb0NDLG9CQUFwQyxDQUF5REUsY0FBekQsQ0FBd0UsU0FBeEUsRUFBbUZILFlBQW5GLENBQWdHLFVBQWhHLEVBQTRHTSxNQUE1RyxHQUFxSCxVQUFySCxDQVJKLENBU0k7O0FBQ0EsV0FBS3VCLEdBQUwsQ0FBU3FDLHVCQUFULENBQWlDLFVBQVNYLFFBQVQsRUFBbUJDLFFBQW5CLEVBQTZCO0FBQzFEUyxRQUFBQSxJQUFJLENBQUN2RSxhQUFMLEdBQXFCOEQsUUFBckI7QUFDQTFGLFFBQUFBLEVBQUUsQ0FBQ2tCLEdBQUgsQ0FBTyw2Q0FBNkN1RSxRQUE3QyxHQUF3RCxpQkFBeEQsR0FBNEVDLFFBQW5GO0FBQ0FTLFFBQUFBLElBQUksQ0FBQ2xFLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixFQUFvQ29CLGtCQUFwQyxHQUF5RCxJQUF6RDtBQUNBLFlBQUkrQyxZQUFZLEdBQUdaLFFBQVEsQ0FBQ2EsS0FBVCxDQUFlLEdBQWYsQ0FBbkI7QUFDQSxZQUFJQyxZQUFZLEdBQUdiLFFBQVEsQ0FBQ1ksS0FBVCxDQUFlLEdBQWYsQ0FBbkI7O0FBQ0EsYUFBSyxJQUFJRSxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSCxZQUFZLENBQUNJLE1BQWpDLEVBQXlDRCxDQUFDLEVBQTFDLEVBQ0E7QUFDSSxjQUFJRSxTQUFTLEdBQUdDLFFBQVEsQ0FBQ04sWUFBWSxDQUFDRyxDQUFELENBQWIsQ0FBeEI7QUFDQSxjQUFJSSxTQUFTLEdBQUdELFFBQVEsQ0FBQ0osWUFBWSxDQUFDQyxDQUFELENBQVosSUFBbUIsQ0FBcEIsQ0FBeEI7O0FBQ0EsY0FBSUUsU0FBUyxLQUFLRSxTQUFsQixFQUNBO0FBQ0ksbUJBQU8sQ0FBRSxDQUFUO0FBQ0g7QUFDSjs7QUFDRCxZQUFHTCxZQUFZLENBQUNFLE1BQWIsSUFBdUJKLFlBQVksQ0FBQ0ksTUFBdkMsRUFDQTtBQUNJLGlCQUFPLENBQUMsQ0FBUjtBQUNILFNBSEQsTUFLQTtBQUNJTixVQUFBQSxJQUFJLENBQUM1RixTQUFMLEdBQWlCLEtBQWpCO0FBQ0EsaUJBQU8sQ0FBUDtBQUNIO0FBQ0osT0F4QkQ7O0FBeUJBLFdBQUtzRyxJQUFMLEdBQVksQ0FBWjs7QUFDQSxXQUFLOUMsR0FBTCxDQUFTK0MsaUJBQVQsQ0FBMkIsVUFBU0MsR0FBVCxFQUFjQyxHQUFkLEVBQW1CO0FBQzFDQSxRQUFBQSxHQUFHLENBQUNDLFVBQUosRUFDQUQsR0FBRyxDQUFDRSxHQURKLEVBRUFGLEdBQUcsQ0FBQ25CLElBRko7QUFHQSxlQUFPTSxJQUFJLENBQUNVLElBQUwsR0FBWUcsR0FBRyxDQUFDSCxJQUFoQixFQUNQLElBREE7QUFFSCxPQU5EOztBQU9BLFVBQUc3RyxFQUFFLENBQUN1RSxHQUFILENBQU80QyxFQUFQLEtBQWNuSCxFQUFFLENBQUN1RSxHQUFILENBQU82QyxVQUF4QixFQUNBO0FBQ0ksYUFBS3JELEdBQUwsQ0FBU3NELG9CQUFULENBQThCLENBQTlCO0FBQ0g7O0FBQ0QsV0FBS25DLFdBQUw7QUFDSDtBQUNKLEdBdFVJOztBQXdVTDtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0lyRCxFQUFBQSx5QkFBeUIsRUFBRSxtQ0FBU3lGLE9BQVQsRUFBa0JDLFFBQWxCLEVBQTRCO0FBQ25ELFFBQUlDLElBQUksR0FBRyxJQUFYO0FBQ0FBLElBQUFBLElBQUksR0FBRztBQUNIM0MsTUFBQUEsV0FBVyxFQUFFeUM7QUFEVixLQUFQLEVBR0F0SCxFQUFFLENBQUN1RSxHQUFILENBQU9DLFlBQVAsQ0FBb0JDLE9BQXBCLENBQTRCLGFBQTVCLEVBQTJDUCxJQUFJLENBQUNDLFNBQUwsQ0FBZXFELElBQWYsQ0FBM0MsQ0FIQTtBQUlBRCxJQUFBQSxRQUFRLElBQUlBLFFBQVEsRUFBcEI7QUFDSCxHQXBWSTs7QUFzVkw7QUFDSjtBQUNBO0FBQ0lFLEVBQUFBLFNBQVMsRUFBRSxxQkFBVztBQUNsQixRQUFHLEtBQUsvRCxlQUFSLEVBQ0E7QUFDSTFELE1BQUFBLEVBQUUsQ0FBQ3lDLFlBQUgsQ0FBZ0JDLGNBQWhCLENBQStCLEtBQUtnQixlQUFwQztBQUNBLFdBQUtBLGVBQUwsR0FBdUIsSUFBdkI7QUFDSDs7QUFDRCxRQUFHLEtBQUtLLEdBQUwsSUFBWSxDQUFDL0QsRUFBRSxDQUFDdUUsR0FBSCxDQUFPMEIsNEJBQXZCLEVBQ0E7QUFDSSxXQUFLbEMsR0FBTCxDQUFTMkQsT0FBVDtBQUNIO0FBQ0o7QUFuV0ksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOa4uOaIj+abtOaWsOeuoeeQhlxyXG4gKi9cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBtYW5pZmVzdHR5cGU6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkFzc2V0XHJcbiAgICAgICAgfSxcclxuICAgICAgICBfdXBkYXRpbmc6IGZhbHNlLFxyXG4gICAgICAgIF9jYW5SZXRyeTogZmFsc2VcclxuICAgIH0sXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZUFycmF5ID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdO1xyXG4gICAgICAgIHRoaXMuZ2FtZU5hbWUgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuaXNDaGVja2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucGxheWVySW5mbyA9IHJlcXVpcmUoXCJQbGF5ZXJJbmZvXCIpLmdldEluc3RhbnQ7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiDmo4DmtYvniYjmnKxcclxuICAgICAqIEBwYXJhbSB7Kn0gZXZlbnQgXHJcbiAgICAgKi9cclxuICAgIGNoZWNrQ2I6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgY2MubG9nKFwiQ29kZTogXCIgKyBldmVudC5nZXRFdmVudENvZGUoKSk7XHJcbiAgICAgICAgc3dpdGNoIChldmVudC5nZXRFdmVudENvZGUoKSkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfTk9fTE9DQUxfTUFOSUZFU1Q6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkVSUk9SX0RPV05MT0FEX01BTklGRVNUOlxyXG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfUEFSU0VfTUFOSUZFU1Q6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkFMUkVBRFlfVVBfVE9fREFURTpcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDE7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMuZ2FtZU5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJHcmFiQnVsbFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzBdID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiRmlzaFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzFdID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiQnVsbFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzJdID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiQmRlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lQXJyYXlbM10gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJUd29FaWdodFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzRdID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiTGluZUdhbWVcIjpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVBcnJheVs1XSA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSA2O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkxhbmRcIjpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVBcnJheVs2XSA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSA3O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJJbmZvLmxvY2FsVmVyc2lvbltpbmRleF0gPSB0aGlzLnNlcnZlclZlcnNpb247XHJcbiAgICAgICAgICAgICAgICBjYy5sb2codGhpcy5zZXJ2ZXJWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIGNjLmxvZyh0aGlzLnBsYXllckluZm8ubG9jYWxWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMud3JpdGVHYW1lVmVyc2lvbl9GdW5jdGlvbih0aGlzLnBsYXllckluZm8ubG9jYWxWZXJzaW9uLGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLmdhbWUucmVzdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5ORVdfVkVSU0lPTl9GT1VORDpcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJwYl9Mb2FkaW5nXCIpLmdldENvbXBvbmVudChcImNjLlByb2dyZXNzQmFyXCIpLnByb2dyZXNzID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJwYl9Mb2FkaW5nXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmJnX0JsYWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9VcGRhdGVNZXNzYWdlQm94LmdldENoaWxkQnlOYW1lKFwibGJfVGlwc1wiKS5nZXRDb21wb25lbnQoXCJjYy5MYWJlbFwiKS5zdHJpbmcgPSBcIua4uOaIj+mcgOimgeabtOaWsOWIsCBcIiArIHRoaXMuc2VydmVyVmVyc2lvbiArIFwiIOeJiOacrFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MuZXZlbnRNYW5hZ2VyLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2NoZWNrTGlzdGVuZXIpO1xyXG4gICAgICAgIHRoaXMuX2NoZWNrTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5ob3RVcGRhdGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrDniYjmnKxcclxuICAgICAqIEBwYXJhbSB7Kn0gZXZlbnQgXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZUNiOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIC8v5piv5ZCm5pu05paw5a6M5oiQXHJcbiAgICAgICAgdmFyIGlzRmluaXNoZWQgPSBmYWxzZTtcclxuICAgICAgICAvL+aYr+WQpumcgOimgeabtOaWsFxyXG4gICAgICAgIHZhciBpc1VwZGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZ2V0RXZlbnRDb2RlKCkpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkVSUk9SX05PX0xPQ0FMX01BTklGRVNUOlxyXG4gICAgICAgICAgICAgICAgaXNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5VUERBVEVfUFJPR1JFU1NJT046XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNoZWNrVXBkYXRlVGltZSA9IDIwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5jb21fVXBkYXRlTWVzc2FnZUJveC5nZXRDaGlsZEJ5TmFtZShcInBiX0xvYWRpbmdcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJwYl9Mb2FkaW5nXCIpLmdldENvbXBvbmVudChcImNjLlByb2dyZXNzQmFyXCIpLnByb2dyZXNzID0gZXZlbnQuZ2V0RG93bmxvYWRlZEJ5dGVzKCkgLyBldmVudC5nZXRUb3RhbEJ5dGVzKCk7XHJcbiAgICAgICAgICAgICAgICBldmVudC5nZXRNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkVSUk9SX0RPV05MT0FEX01BTklGRVNUOlxyXG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfUEFSU0VfTUFOSUZFU1Q6XHJcbiAgICAgICAgICAgICAgICBpc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkFMUkVBRFlfVVBfVE9fREFURTpcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhcIuW3suaYr+acgOaWsOeJiOacrFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLlVQREFURV9GSU5JU0hFRDpcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhcIuabtOaWsOWujOaIkFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY2hlY2tVcGRhdGVUaW1lT3V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9VcGRhdGVNZXNzYWdlQm94LmdldENoaWxkQnlOYW1lKFwicGJfTG9hZGluZ1wiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5jb21fVXBkYXRlTWVzc2FnZUJveC5nZXRDaGlsZEJ5TmFtZShcInBiX0xvYWRpbmdcIikuZ2V0Q29tcG9uZW50KFwiY2MuUHJvZ3Jlc3NCYXJcIikucHJvZ3Jlc3MgPSAxO1xyXG4gICAgICAgICAgICAgICAgaXNGaW5pc2hlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLlVQREFURV9GQUlMRUQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FuUmV0cnkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9VUERBVElORzpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfREVDT01QUkVTUzpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihpc1VwZGF0ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLl91cGRhdGVMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzRmluaXNoZWQpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2MuZXZlbnRNYW5hZ2VyLnJlbW92ZUxpc3RlbmVyKHRoaXMuX3VwZGF0ZUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgcGF0aHMgPSBqc2IuZmlsZVV0aWxzLmdldFNlYXJjaFBhdGhzKCk7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbF9wYXRocyA9IHRoaXMuX2FtLmdldExvY2FsTWFuaWZlc3QoKS5nZXRTZWFyY2hQYXRocygpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShsb2NhbF9wYXRocykpO1xyXG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUudW5zaGlmdChwYXRocywgbG9jYWxfcGF0aHMpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJIb3RVcGRhdGVTZWFyY2hQYXRoc1wiLCBKU09OLnN0cmluZ2lmeShwYXRocykpO1xyXG4gICAgICAgICAgICBqc2IuZmlsZVV0aWxzLnNldFNlYXJjaFBhdGhzKHBhdGhzKTtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcEFsbCgpO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuZ2FtZU5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcIkdyYWJCdWxsXCI6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVBcnJheVswXSA9IDE7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IDE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIkZpc2hcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzFdID0gMTtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiQnVsbFwiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lQXJyYXlbMl0gPSAxO1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSAzO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJCZGVcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzNdID0gMTtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiVHdvRWlnaHRcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzRdID0gMTtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiTGluZUdhbWVcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZUFycmF5WzVdID0gMTtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiTGFuZFwiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lQXJyYXlbNl0gPSAxO1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSA3XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGdhbWVWZXJzaW9uID0gSlNPTi5wYXJzZShjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJnYW1lVmVyc2lvblwiKSk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJwYl9Mb2FkaW5nXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJwYl9Mb2FkaW5nXCIpLmdldENvbXBvbmVudChcImNjLlByb2dyZXNzQmFyXCIpLnByb2dyZXNzID0gMTtcclxuICAgICAgICAgICAgaWYoZ2FtZVZlcnNpb24gIT09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVySW5mby5sb2NhbFZlcnNpb25baW5kZXhdID0gdGhpcy5zZXJ2ZXJWZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53cml0ZUdhbWVWZXJzaW9uX0Z1bmN0aW9uKHRoaXMucGxheWVySW5mby5sb2NhbFZlcnNpb24sZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuZ2FtZS5yZXN0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIOmHjeivlVxyXG4gICAgICovXHJcbiAgICByZXRyeTogZnVuY3Rpb24oKSB7IFxyXG4gICAgICAgIGlmKCF0aGlzLl91cGRhdGluZyAmJiB0aGlzLl9jYW5SZXRyeSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhblJldHJ5ID0gZmFsc2UsIHRoaXMuX2FtLmRvd25sb2FkRmFpbGVkQXNzZXRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOajgOa1i+abtOaWsFxyXG4gICAgICovXHJcbiAgICBjaGVja1VwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYodGhpcy5fdXBkYXRpbmcgfHwgdGhpcy5fYW0uZ2V0TG9jYWxNYW5pZmVzdCgpLmlzTG9hZGVkKCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl9jaGVja0xpc3RlbmVyID0gbmV3IGpzYi5FdmVudExpc3RlbmVyQXNzZXRzTWFuYWdlcih0aGlzLl9hbSwgdGhpcy5jaGVja0NiLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICBjYy5ldmVudE1hbmFnZXIuYWRkTGlzdGVuZXIodGhpcy5fY2hlY2tMaXN0ZW5lciwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2FtLmNoZWNrVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0aW5nID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog54Ot5pu05pawXHJcbiAgICAgKi9cclxuICAgIGhvdFVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlTGlzdGVuZXIgPSBuZXcganNiLkV2ZW50TGlzdGVuZXJBc3NldHNNYW5hZ2VyKHRoaXMuX2FtLCB0aGlzLnVwZGF0ZUNiLmJpbmQodGhpcykpO1xyXG4gICAgICAgIGNjLmV2ZW50TWFuYWdlci5hZGRMaXN0ZW5lcih0aGlzLl91cGRhdGVMaXN0ZW5lciwgMSk7XHJcbiAgICAgICAgdGhpcy5fZmFpbENvdW50ID0gMDtcclxuICAgICAgICB0aGlzLl9hbS51cGRhdGUoKTtcclxuICAgICAgICB0aGlzLnZlcnNpb25BID09PSB0aGlzLnZlcnNpb25CID8gdGhpcy5fdXBkYXRpbmcgPSBmYWxzZSA6IHRoaXMuX3VwZGF0aW5nID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7Kn0gZ2FtZU5hbWUgXHJcbiAgICAgKi9cclxuICAgIGNoZWNrR2FtZVVwZGF0ZV9GdW5jdGlvbjogZnVuY3Rpb24oZ2FtZU5hbWUpIHtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9VcGRhdGVNZXNzYWdlQm94LmdldENoaWxkQnlOYW1lKFwibGJfVGlwc1wiKS5nZXRDb21wb25lbnQoXCJjYy5MYWJlbFwiKS5zdHJpbmcgPSBnYW1lTmFtZTtcclxuICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgIHN3aXRjaCAoZ2FtZU5hbWUpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2FzZSBcIkdyYWJCdWxsXCI6XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIkZpc2hcIjpcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiQnVsbFwiOlxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSAyO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJCZGVcIjpcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gMztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiVHdvRWlnaHRcIjpcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiTGluZUdhbWVcIjpcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiTGFuZFwiOlxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSA2O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJSdW5pbmdcIjpcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gNztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9VcGRhdGVNZXNzYWdlQm94LmdldENoaWxkQnlOYW1lKFwibGJfVGlwc1wiKS5nZXRDb21wb25lbnQoXCJjYy5MYWJlbFwiKS5zdHJpbmcgPSBpbmRleDtcclxuICAgICAgICB0aGlzLmdhbWVOYW1lID0gZ2FtZU5hbWU7XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5jb21fVXBkYXRlTWVzc2FnZUJveC5nZXRDaGlsZEJ5TmFtZShcImxiX1RpcHNcIikuZ2V0Q29tcG9uZW50KFwiY2MuTGFiZWxcIikuc3RyaW5nID0gdGhpcy5nYW1lTmFtZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZUFycmF5W2luZGV4XSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZ2FtZU5hbWUgPT0gXCJMaW5lR2FtZVwiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikubG9naW5HYW1lUm9vbV9GdW5jdGlvbih0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9HYW1lTWVudS5nZXRDaGlsZEJ5TmFtZShcIkxpbmVHYW1lXCIpLmdldENvbXBvbmVudChcIkxvYmJ5QnV0dG9uQ2xpY2tcIiksIFwiTGluZUdhbWVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmdhbWVNZW51QnV0dG9uQ2xpY2tfRnVuY3Rpb24oXCJjb21fXCIgKyB0aGlzLmdhbWVOYW1lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuYmdfQmxhY2suYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9VcGRhdGVNZXNzYWdlQm94LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5jb21fVXBkYXRlTWVzc2FnZUJveC5nZXRDaGlsZEJ5TmFtZShcInBiX0xvYWRpbmdcIikuZ2V0Q29tcG9uZW50KFwiY2MuUHJvZ3Jlc3NCYXJcIikucHJvZ3Jlc3MgPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IChqc2IuZmlsZVV0aWxzID8ganNiLmZpbGVVdGlscy5nZXRXcml0YWJsZVBhdGgoKSA6IFwiL1wiKSArIGdhbWVOYW1lO1xyXG4gICAgICAgICAgICAvL2NjLmxvZyhwYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5fYW0gPSBuZXcganNiLkFzc2V0c01hbmFnZXIodGhpcy5tYW5pZmVzdFVybFtpbmRleF0sIHBhdGgpO1xyXG4gICAgICAgICAgICBjYy5zeXMuRU5BQkxFX0dDX0ZPUl9OQVRJVkVfT0JKRUNUUyB8fCB0aGlzLl9hbS5yZXRhaW4oKTtcclxuICAgICAgICAgICAgLy9jYy5sb2coaW5kZXgpO1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuc2VydmVyVmVyc2lvbiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1VwZGF0ZU1lc3NhZ2VCb3guZ2V0Q2hpbGRCeU5hbWUoXCJsYl9UaXBzXCIpLmdldENvbXBvbmVudChcImNjLkxhYmVsXCIpLnN0cmluZyA9IFwi6I635Y+W54mI5pys5Y+3Li4uXCI7XHJcbiAgICAgICAgICAgIC8v5qOA5rWL54mI5pysXHJcbiAgICAgICAgICAgIHRoaXMuX2FtLnNldFZlcnNpb25Db21wYXJlSGFuZGxlKGZ1bmN0aW9uKHZlcnNpb25BLCB2ZXJzaW9uQikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXJ2ZXJWZXJzaW9uID0gdmVyc2lvbkI7XHJcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJKUyBDdXN0b20gVmVyc2lvbiBDb21wYXJlOiB2ZXJzaW9uIEEgaXMgXCIgKyB2ZXJzaW9uQSArIFwiLCB2ZXJzaW9uIEIgaXMgXCIgKyB2ZXJzaW9uQik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNoZWNrVXBkYXRlVGltZU91dCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbkFMaXN0ID0gdmVyc2lvbkEuc3BsaXQoXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHZlcnNpb25CTGlzdCA9IHZlcnNpb25CLnNwbGl0KFwiLlwiKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVyc2lvbkFMaXN0Lmxlbmd0aDsgaSsrKSBcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbl9BID0gcGFyc2VJbnQodmVyc2lvbkFMaXN0W2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbl9CID0gcGFyc2VJbnQodmVyc2lvbkJMaXN0W2ldIHx8IDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2ZXJzaW9uX0EgIT09IHZlcnNpb25fQilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodmVyc2lvbkJMaXN0Lmxlbmd0aCAhPSB2ZXJzaW9uQUxpc3QubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl91cGRhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgICAgICAgICAgdGhpcy5fYW0uc2V0VmVyaWZ5Q2FsbGJhY2soZnVuY3Rpb24oZXJyLCByZXQpIHtcclxuICAgICAgICAgICAgICAgIHJldC5jb21wcmVzc2VkLFxyXG4gICAgICAgICAgICAgICAgcmV0Lm1kNSxcclxuICAgICAgICAgICAgICAgIHJldC5wYXRoO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuc2l6ZSA9IHJldC5zaXplLFxyXG4gICAgICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYoY2Muc3lzLm9zID09PSBjYy5zeXMuT1NfQU5EUk9JRClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYW0uc2V0TWF4Q29uY3VycmVudFRhc2soMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jaGVja1VwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlsIbmuLjmiI/niYjmnKzlhpnlhaXnvJPlrZjmlbDmja5cclxuICAgICAqIEBwYXJhbSB7Kn0gdmVyc2lvbiBcclxuICAgICAqIEBwYXJhbSB7Kn0gY2FsbGJhY2sgXHJcbiAgICAgKi9cclxuICAgIHdyaXRlR2FtZVZlcnNpb25fRnVuY3Rpb246IGZ1bmN0aW9uKHZlcnNpb24sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xyXG4gICAgICAgIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGdhbWVWZXJzaW9uOiB2ZXJzaW9uXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJnYW1lVmVyc2lvblwiLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDplIDmr4FcclxuICAgICAqL1xyXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZih0aGlzLl91cGRhdGVMaXN0ZW5lcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLl91cGRhdGVMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fYW0gJiYgIWNjLnN5cy5FTkFCTEVfR0NfRk9SX05BVElWRV9PQkpFQ1RTKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fYW0ucmVsZWFzZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiJdfQ==