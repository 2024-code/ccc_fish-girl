
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/game_hongbao/HongBaoMain.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '51e42SapZhAm6b0a4TXPwe0', 'HongBaoMain');
// Script/game_hongbao/HongBaoMain.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    maskPanel: cc.Node,
    //各种弹板黑背景
    roomPrice_lab: cc.Label,
    //房间红包金额
    roomRule_lab: cc.Label,
    //房间红包规则
    getHbCoin_lab: cc.Label,
    //得到的红包金额
    hbScrollview: cc.ScrollView,
    hbItem: cc.Prefab,
    hbDetailPanel: cc.Node,
    //红包详情面板
    hbDetail_lab: cc.Label,
    playerScrollview: cc.ScrollView,
    playerItem: cc.Prefab,
    playerNode: cc.Node,
    horseLamp_Node: cc.Node,
    horseLamp_lab: cc.Label
  },
  onLoad: function onLoad() {
    cc.log('进入红包达人================================================');
    this.playerInfo = require("PlayerInfo").getInstant;
    this.playerInfo.setGameObj_Function(this);
    this.netWork = require("HongBaoNetWork").getInstant;
    this.netWork.sethongbaoObj_Function(this);
    this.netWork.gameSocket.emit("hbInit");
    this.hongbaoPlayer = this.playerNode.getComponent("HongBaoPlayer");
  },
  start: function start() {
    this.horseLamp_Node.active = false;
  },
  gameInit: function gameInit(data) {
    this.nowHbId = 0;
    this.lampList = [];
    this.nowPrice = data.hbPrice; //每个红包的价格

    this.roomPrice_lab.string = "\u91D1\u989D" + this.nowPrice / this.playerInfo.exchangeRate + "\u5143";
    this.roomRule_lab.string = data.ruleType == 0 ? "最小接龙" : "最大接龙";
    this.hbList = data.hbList;
    cc.log(this.hbList);
    this.hbScrollview.content.removeAllChildren();

    for (var i = 0; i < this.hbList.length; i++) {
      var item = new cc.instantiate(this.hbItem);
      item.getComponent("HongBaoPreb").initData(this.hbList[i]);
      this.hbScrollview.content.addChild(item);
    }

    this.hbScrollview.scrollToBottom(0.2);
  },
  createMsg: function createMsg(info) {},
  //金币结算
  billing_Function: function billing_Function(data) {
    cc.log("coinresult----", data);
    this.hongbaoPlayer.updateView(data);
  },
  //刷新红包列表
  updateHongBaoList: function updateHongBaoList(data) {
    this.hbList.push(data);
    var item = new cc.instantiate(this.hbItem);
    this.hbScrollview.content.addChild(item);
    item.getComponent("HongBaoPreb").initData(data);
    this.hbScrollview.scrollToBottom(0.2);
  },
  //领取红包
  getHongBao: function getHongBao(data) {
    cc.log("getHongBao----", data);
    this.maskPanel.getChildByName("开始抢红包").active = false;

    switch (data.ResultCode) {
      case 0:
        //领取成功
        this.updateHbInList(data.ResultData);
        this.getHbCoin_lab.string = (data.packageMoney / this.playerInfo.exchangeRate).toFixed(2);
        this.open_panel("抢到红包");
        break;

      case 1000:
        //没有剩余了
        this.updateHbInList(data.ResultData);
        this.open_panel("未抢到红包");
        break;

      case 1001:
        //领过了
        this.updateHbInList(data.ResultData);
        this.open_hbDetail(data.ResultData);
        break;
    }
  },
  //更新红包状态
  updateHbInList: function updateHbInList(data) {
    var itemList = this.hbScrollview.content.children;

    for (var i = 0; i < itemList.length; i++) {
      if (data.hbId == itemList[i].getComponent("HongBaoPreb").data.hbId) {
        itemList[i].getComponent("HongBaoPreb").initData(data);
        itemList[i].getComponent("HongBaoPreb").initUI(data);
      }
    }
  },
  //打开红包详情
  open_hbDetail: function open_hbDetail(data) {
    this.hbDetailPanel.active = true;
    this.hbScrollview.node.active = false;

    if (data.nowNum > 0) {
      this.hbDetail_lab.string = "\u5F53\u524D\u5269\u4F59\u7EA2\u5305" + data.nowNum + "\u4E2A";
    } else {
      this.hbDetail_lab.string = data.maxNum + "\u4E2A\u7EA2\u5305\uFF0C" + this.showTime(data.receiveList[data.maxNum - 1].date - data.receiveList[0].date) + "\u62A2\u5B8C";
    }

    this.playerScrollview.content.removeAllChildren();

    for (var i = 0; i < data.receiveList.length; i++) {
      var item = new cc.instantiate(this.playerItem);
      item.getComponent("HongBaoPlayerItem").initData(data.receiveList[i]);
      this.playerScrollview.content.addChild(item);
    }
  },
  //关闭红包详情
  close_hbDetail: function close_hbDetail() {
    this.hbDetailPanel.active = false;
    this.hbScrollview.node.active = true;
  },
  //断开连接
  disconnectNetWork_Function: function disconnectNetWork_Function() {},
  //打开某个弹板
  open_panel: function open_panel(name, callback) {
    this.maskPanel.active = true;
    this.panelAction1(this.maskPanel.getChildByName(name), callback);
  },
  //关闭某个弹板
  close_panel: function close_panel(name, callback) {
    this.panelAction2(this.maskPanel.getChildByName(name), callback);
  },
  //打开弹板动效
  panelAction1: function panelAction1(node, callback) {
    node.scale = 0.8;
    node.active = true;
    node.runAction(cc.sequence(cc.scaleTo(0.2, 1.1), cc.scaleTo(0.1, 0.9), cc.scaleTo(0.1, 1), cc.callFunc(function () {
      callback && callback();
    })));
  },
  //关闭弹板动效
  panelAction2: function panelAction2(node, callback) {
    var _this = this;

    node.runAction(cc.sequence(cc.scaleTo(0.1, 1.1), cc.scaleTo(0.2, 0.8), cc.callFunc(function () {
      node.active = false;
      _this.maskPanel.active = false;
      callback && callback();
    })));
  },
  //跑马灯
  horseLamp: function horseLamp(data) {
    var _this2 = this;

    this.lampList.push(data);

    if (this.lampList.length == 1) {
      var cb = function cb() {
        _this2.horseLamp_Node.active = true;
        _this2.horseLamp_lab.node.x = 550;
        _this2.horseLamp_lab.string = _this2.lampList[0].luckName + "\u62BD\u4E2D " + _this2.lampList[0].hostName + "\u7684" + (_this2.lampList[0].type == 0 ? "最小红包" : "最大红包") + "\uFF0C2\u79D2\u540E\u53D1\u9001\u65B0\u7EA2\u5305\u54E6";

        _this2.horseLamp_lab.node.runAction(cc.sequence(cc.moveTo(10, -1500, 0), cc.callFunc(function () {
          _this2.lampList.shift();

          if (_this2.lampList.length == 0) {
            _this2.horseLamp_Node.active = false;
          } else {
            cb();
          }
        })));
      };

      cb();
    }
  },
  //时间差转换
  showTime: function showTime(time) {
    var leftd = Math.floor(time / (1000 * 60 * 60 * 24)),
        //计算天数
    lefth = Math.floor(time / (1000 * 60 * 60) % 24),
        //计算小时数
    leftm = Math.floor(time / (1000 * 60) % 60),
        //计算分钟数
    lefts = Math.floor(time / 1000 % 60); //计算秒数

    var result = "";

    if (leftd > 0) {
      result += leftd + "天";
    }

    if (lefth > 0) {
      result += lefth + "小时";
    }

    if (leftm > 0) {
      result += leftm + "分";
    }

    if (lefts > 0) {
      result += lefts + "秒";
    }

    return result;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxnYW1lX2hvbmdiYW9cXEhvbmdCYW9NYWluLmpzIl0sIm5hbWVzIjpbImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibWFza1BhbmVsIiwiTm9kZSIsInJvb21QcmljZV9sYWIiLCJMYWJlbCIsInJvb21SdWxlX2xhYiIsImdldEhiQ29pbl9sYWIiLCJoYlNjcm9sbHZpZXciLCJTY3JvbGxWaWV3IiwiaGJJdGVtIiwiUHJlZmFiIiwiaGJEZXRhaWxQYW5lbCIsImhiRGV0YWlsX2xhYiIsInBsYXllclNjcm9sbHZpZXciLCJwbGF5ZXJJdGVtIiwicGxheWVyTm9kZSIsImhvcnNlTGFtcF9Ob2RlIiwiaG9yc2VMYW1wX2xhYiIsIm9uTG9hZCIsImxvZyIsInBsYXllckluZm8iLCJyZXF1aXJlIiwiZ2V0SW5zdGFudCIsInNldEdhbWVPYmpfRnVuY3Rpb24iLCJuZXRXb3JrIiwic2V0aG9uZ2Jhb09ial9GdW5jdGlvbiIsImdhbWVTb2NrZXQiLCJlbWl0IiwiaG9uZ2Jhb1BsYXllciIsImdldENvbXBvbmVudCIsInN0YXJ0IiwiYWN0aXZlIiwiZ2FtZUluaXQiLCJkYXRhIiwibm93SGJJZCIsImxhbXBMaXN0Iiwibm93UHJpY2UiLCJoYlByaWNlIiwic3RyaW5nIiwiZXhjaGFuZ2VSYXRlIiwicnVsZVR5cGUiLCJoYkxpc3QiLCJjb250ZW50IiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJpIiwibGVuZ3RoIiwiaXRlbSIsImluc3RhbnRpYXRlIiwiaW5pdERhdGEiLCJhZGRDaGlsZCIsInNjcm9sbFRvQm90dG9tIiwiY3JlYXRlTXNnIiwiaW5mbyIsImJpbGxpbmdfRnVuY3Rpb24iLCJ1cGRhdGVWaWV3IiwidXBkYXRlSG9uZ0Jhb0xpc3QiLCJwdXNoIiwiZ2V0SG9uZ0JhbyIsImdldENoaWxkQnlOYW1lIiwiUmVzdWx0Q29kZSIsInVwZGF0ZUhiSW5MaXN0IiwiUmVzdWx0RGF0YSIsInBhY2thZ2VNb25leSIsInRvRml4ZWQiLCJvcGVuX3BhbmVsIiwib3Blbl9oYkRldGFpbCIsIml0ZW1MaXN0IiwiY2hpbGRyZW4iLCJoYklkIiwiaW5pdFVJIiwibm9kZSIsIm5vd051bSIsIm1heE51bSIsInNob3dUaW1lIiwicmVjZWl2ZUxpc3QiLCJkYXRlIiwiY2xvc2VfaGJEZXRhaWwiLCJkaXNjb25uZWN0TmV0V29ya19GdW5jdGlvbiIsIm5hbWUiLCJjYWxsYmFjayIsInBhbmVsQWN0aW9uMSIsImNsb3NlX3BhbmVsIiwicGFuZWxBY3Rpb24yIiwic2NhbGUiLCJydW5BY3Rpb24iLCJzZXF1ZW5jZSIsInNjYWxlVG8iLCJjYWxsRnVuYyIsImhvcnNlTGFtcCIsImNiIiwieCIsImx1Y2tOYW1lIiwiaG9zdE5hbWUiLCJ0eXBlIiwibW92ZVRvIiwic2hpZnQiLCJ0aW1lIiwibGVmdGQiLCJNYXRoIiwiZmxvb3IiLCJsZWZ0aCIsImxlZnRtIiwibGVmdHMiLCJyZXN1bHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0FBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBR0xDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxTQUFTLEVBQUVKLEVBQUUsQ0FBQ0ssSUFETjtBQUNXO0FBQ25CQyxJQUFBQSxhQUFhLEVBQUVOLEVBQUUsQ0FBQ08sS0FGVjtBQUVnQjtBQUN4QkMsSUFBQUEsWUFBWSxFQUFFUixFQUFFLENBQUNPLEtBSFQ7QUFHZTtBQUN2QkUsSUFBQUEsYUFBYSxFQUFFVCxFQUFFLENBQUNPLEtBSlY7QUFJZ0I7QUFDeEJHLElBQUFBLFlBQVksRUFBRVYsRUFBRSxDQUFDVyxVQUxUO0FBTVJDLElBQUFBLE1BQU0sRUFBRVosRUFBRSxDQUFDYSxNQU5IO0FBT1JDLElBQUFBLGFBQWEsRUFBRWQsRUFBRSxDQUFDSyxJQVBWO0FBT2U7QUFDdkJVLElBQUFBLFlBQVksRUFBRWYsRUFBRSxDQUFDTyxLQVJUO0FBU1JTLElBQUFBLGdCQUFnQixFQUFFaEIsRUFB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c0NvbnRlbnQiOlsiXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWFza1BhbmVsOiBjYy5Ob2RlLC8v5ZCE56eN5by55p2/6buR6IOM5pmvXHJcbiAgICAgICAgcm9vbVByaWNlX2xhYjogY2MuTGFiZWwsLy/miL/pl7TnuqLljIXph5Hpop1cclxuICAgICAgICByb29tUnVsZV9sYWI6IGNjLkxhYmVsLC8v5oi/6Ze057qi5YyF6KeE5YiZXHJcbiAgICAgICAgZ2V0SGJDb2luX2xhYjogY2MuTGFiZWwsLy/lvpfliLDnmoTnuqLljIXph5Hpop1cclxuICAgICAgICBoYlNjcm9sbHZpZXc6IGNjLlNjcm9sbFZpZXcsXHJcbiAgICAgICAgaGJJdGVtOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgaGJEZXRhaWxQYW5lbDogY2MuTm9kZSwvL+e6ouWMheivpuaDhemdouadv1xyXG4gICAgICAgIGhiRGV0YWlsX2xhYjogY2MuTGFiZWwsXHJcbiAgICAgICAgcGxheWVyU2Nyb2xsdmlldzogY2MuU2Nyb2xsVmlldyxcclxuICAgICAgICBwbGF5ZXJJdGVtOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgcGxheWVyTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBob3JzZUxhbXBfTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBob3JzZUxhbXBfbGFiOiBjYy5MYWJlbFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgY2MubG9nKCfov5vlhaXnuqLljIXovr7kuro9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcclxuICAgICAgICB0aGlzLnBsYXllckluZm8gPSByZXF1aXJlKFwiUGxheWVySW5mb1wiKS5nZXRJbnN0YW50O1xyXG4gICAgICAgIHRoaXMucGxheWVySW5mby5zZXRHYW1lT2JqX0Z1bmN0aW9uKHRoaXMpO1xyXG4gICAgICAgIHRoaXMubmV0V29yayA9IHJlcXVpcmUoXCJIb25nQmFvTmV0V29ya1wiKS5nZXRJbnN0YW50O1xyXG4gICAgICAgIHRoaXMubmV0V29yay5zZXRob25nYmFvT2JqX0Z1bmN0aW9uKHRoaXMpO1xyXG4gICAgICAgIHRoaXMubmV0V29yay5nYW1lU29ja2V0LmVtaXQoXCJoYkluaXRcIik7XHJcbiAgICAgICAgdGhpcy5ob25nYmFvUGxheWVyID0gdGhpcy5wbGF5ZXJOb2RlLmdldENvbXBvbmVudChcIkhvbmdCYW9QbGF5ZXJcIik7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuaG9yc2VMYW1wX05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIGdhbWVJbml0KGRhdGEpIHtcclxuICAgICAgICB0aGlzLm5vd0hiSWQgPSAwO1xyXG4gICAgICAgIHRoaXMubGFtcExpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLm5vd1ByaWNlID0gZGF0YS5oYlByaWNlOy8v5q+P5Liq57qi5YyF55qE5Lu35qC8XHJcbiAgICAgICAgdGhpcy5yb29tUHJpY2VfbGFiLnN0cmluZyA9IGDph5Hpop0ke3RoaXMubm93UHJpY2UgLyB0aGlzLnBsYXllckluZm8uZXhjaGFuZ2VSYXRlfeWFg2A7XHJcbiAgICAgICAgdGhpcy5yb29tUnVsZV9sYWIuc3RyaW5nID0gZGF0YS5ydWxlVHlwZSA9PSAwID8gXCLmnIDlsI/mjqXpvplcIiA6IFwi5pyA5aSn5o6l6b6ZXCI7XHJcbiAgICAgICAgdGhpcy5oYkxpc3QgPSBkYXRhLmhiTGlzdDtcclxuICAgICAgICBjYy5sb2codGhpcy5oYkxpc3QpO1xyXG4gICAgICAgIHRoaXMuaGJTY3JvbGx2aWV3LmNvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaGJMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBpdGVtID0gbmV3IGNjLmluc3RhbnRpYXRlKHRoaXMuaGJJdGVtKTtcclxuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoXCJIb25nQmFvUHJlYlwiKS5pbml0RGF0YSh0aGlzLmhiTGlzdFtpXSk7XHJcbiAgICAgICAgICAgIHRoaXMuaGJTY3JvbGx2aWV3LmNvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGJTY3JvbGx2aWV3LnNjcm9sbFRvQm90dG9tKDAuMik7XHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZU1zZyhpbmZvKSB7XHJcblxyXG4gICAgfSxcclxuICAgIC8v6YeR5biB57uT566XXHJcbiAgICBiaWxsaW5nX0Z1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBjYy5sb2coXCJjb2lucmVzdWx0LS0tLVwiLCBkYXRhKTtcclxuICAgICAgICB0aGlzLmhvbmdiYW9QbGF5ZXIudXBkYXRlVmlldyhkYXRhKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/liLfmlrDnuqLljIXliJfooahcclxuICAgIHVwZGF0ZUhvbmdCYW9MaXN0KGRhdGEpIHtcclxuICAgICAgICB0aGlzLmhiTGlzdC5wdXNoKGRhdGEpO1xyXG4gICAgICAgIGxldCBpdGVtID0gbmV3IGNjLmluc3RhbnRpYXRlKHRoaXMuaGJJdGVtKTtcclxuICAgICAgICB0aGlzLmhiU2Nyb2xsdmlldy5jb250ZW50LmFkZENoaWxkKGl0ZW0pO1xyXG4gICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KFwiSG9uZ0Jhb1ByZWJcIikuaW5pdERhdGEoZGF0YSk7XHJcbiAgICAgICAgdGhpcy5oYlNjcm9sbHZpZXcuc2Nyb2xsVG9Cb3R0b20oMC4yKTtcclxuICAgIH0sXHJcbiAgICAvL+mihuWPlue6ouWMhVxyXG4gICAgZ2V0SG9uZ0JhbyhkYXRhKSB7XHJcbiAgICAgICAgY2MubG9nKFwiZ2V0SG9uZ0Jhby0tLS1cIiwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5tYXNrUGFuZWwuZ2V0Q2hpbGRCeU5hbWUoXCLlvIDlp4vmiqLnuqLljIVcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgc3dpdGNoIChkYXRhLlJlc3VsdENvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAwOi8v6aKG5Y+W5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUhiSW5MaXN0KGRhdGEuUmVzdWx0RGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldEhiQ29pbl9sYWIuc3RyaW5nID0gKGRhdGEucGFja2FnZU1vbmV5IC8gdGhpcy5wbGF5ZXJJbmZvLmV4Y2hhbmdlUmF0ZSkudG9GaXhlZCgyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3Blbl9wYW5lbChcIuaKouWIsOe6ouWMhVwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDA6Ly/msqHmnInliankvZnkuoZcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlSGJJbkxpc3QoZGF0YS5SZXN1bHREYXRhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3Blbl9wYW5lbChcIuacquaKouWIsOe6ouWMhVwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDE6Ly/poobov4fkuoZcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlSGJJbkxpc3QoZGF0YS5SZXN1bHREYXRhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3Blbl9oYkRldGFpbChkYXRhLlJlc3VsdERhdGEpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5pu05paw57qi5YyF54q25oCBXHJcbiAgICB1cGRhdGVIYkluTGlzdChkYXRhKSB7XHJcbiAgICAgICAgbGV0IGl0ZW1MaXN0ID0gdGhpcy5oYlNjcm9sbHZpZXcuY29udGVudC5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1MaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmhiSWQgPT0gaXRlbUxpc3RbaV0uZ2V0Q29tcG9uZW50KFwiSG9uZ0Jhb1ByZWJcIikuZGF0YS5oYklkKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtTGlzdFtpXS5nZXRDb21wb25lbnQoXCJIb25nQmFvUHJlYlwiKS5pbml0RGF0YShkYXRhKTtcclxuICAgICAgICAgICAgICAgIGl0ZW1MaXN0W2ldLmdldENvbXBvbmVudChcIkhvbmdCYW9QcmViXCIpLmluaXRVSShkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aJk+W8gOe6ouWMheivpuaDhVxyXG4gICAgb3Blbl9oYkRldGFpbChkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5oYkRldGFpbFBhbmVsLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5oYlNjcm9sbHZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAoZGF0YS5ub3dOdW0gPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGJEZXRhaWxfbGFiLnN0cmluZyA9IGDlvZPliY3liankvZnnuqLljIUke2RhdGEubm93TnVtfeS4qmA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5oYkRldGFpbF9sYWIuc3RyaW5nID0gYCR7ZGF0YS5tYXhOdW195Liq57qi5YyF77yMJHt0aGlzLnNob3dUaW1lKGRhdGEucmVjZWl2ZUxpc3RbZGF0YS5tYXhOdW0gLSAxXS5kYXRlIC0gZGF0YS5yZWNlaXZlTGlzdFswXS5kYXRlKX3miqLlroxgO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBsYXllclNjcm9sbHZpZXcuY29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5yZWNlaXZlTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IG5ldyBjYy5pbnN0YW50aWF0ZSh0aGlzLnBsYXllckl0ZW0pO1xyXG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudChcIkhvbmdCYW9QbGF5ZXJJdGVtXCIpLmluaXREYXRhKGRhdGEucmVjZWl2ZUxpc3RbaV0pO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllclNjcm9sbHZpZXcuY29udGVudC5hZGRDaGlsZChpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/lhbPpl63nuqLljIXor6bmg4VcclxuICAgIGNsb3NlX2hiRGV0YWlsKCkge1xyXG4gICAgICAgIHRoaXMuaGJEZXRhaWxQYW5lbC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmhiU2Nyb2xsdmlldy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgLy/mlq3lvIDov57mjqVcclxuICAgIGRpc2Nvbm5lY3ROZXRXb3JrX0Z1bmN0aW9uKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICAvL+aJk+W8gOafkOS4quW8ueadv1xyXG4gICAgb3Blbl9wYW5lbChuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMubWFza1BhbmVsLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5wYW5lbEFjdGlvbjEodGhpcy5tYXNrUGFuZWwuZ2V0Q2hpbGRCeU5hbWUobmFtZSksIGNhbGxiYWNrKTtcclxuICAgIH0sXHJcbiAgICAvL+WFs+mXreafkOS4quW8ueadv1xyXG4gICAgY2xvc2VfcGFuZWwobmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLnBhbmVsQWN0aW9uMih0aGlzLm1hc2tQYW5lbC5nZXRDaGlsZEJ5TmFtZShuYW1lKSwgY2FsbGJhY2spO1xyXG4gICAgfSxcclxuICAgIC8v5omT5byA5by55p2/5Yqo5pWIXHJcbiAgICBwYW5lbEFjdGlvbjEobm9kZSwgY2FsbGJhY2spIHtcclxuICAgICAgICBub2RlLnNjYWxlID0gMC44O1xyXG4gICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBub2RlLnJ1bkFjdGlvbihcclxuICAgICAgICAgICAgY2Muc2VxdWVuY2UoXHJcbiAgICAgICAgICAgICAgICBjYy5zY2FsZVRvKDAuMiwgMS4xKSxcclxuICAgICAgICAgICAgICAgIGNjLnNjYWxlVG8oMC4xLCAwLjkpLFxyXG4gICAgICAgICAgICAgICAgY2Muc2NhbGVUbygwLjEsIDEpLFxyXG4gICAgICAgICAgICAgICAgY2MuY2FsbEZ1bmMoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcbiAgICAvL+WFs+mXreW8ueadv+WKqOaViFxyXG4gICAgcGFuZWxBY3Rpb24yKG5vZGUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgbm9kZS5ydW5BY3Rpb24oXHJcbiAgICAgICAgICAgIGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICAgICAgY2Muc2NhbGVUbygwLjEsIDEuMSksXHJcbiAgICAgICAgICAgICAgICBjYy5zY2FsZVRvKDAuMiwgMC44KSxcclxuICAgICAgICAgICAgICAgIGNjLmNhbGxGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFza1BhbmVsLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcbiAgICAvL+i3kemprOeBr1xyXG4gICAgaG9yc2VMYW1wKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmxhbXBMaXN0LnB1c2goZGF0YSk7XHJcbiAgICAgICAgaWYgKHRoaXMubGFtcExpc3QubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgbGV0IGNiID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3JzZUxhbXBfTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3JzZUxhbXBfbGFiLm5vZGUueCA9IDU1MDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaG9yc2VMYW1wX2xhYi5zdHJpbmcgPSBgJHt0aGlzLmxhbXBMaXN0WzBdLmx1Y2tOYW1lfeaKveS4rSAke3RoaXMubGFtcExpc3RbMF0uaG9zdE5hbWV955qEJHt0aGlzLmxhbXBMaXN0WzBdLnR5cGUgPT0gMCA/IFwi5pyA5bCP57qi5YyFXCIgOiBcIuacgOWkp+e6ouWMhVwife+8jDLnp5LlkI7lj5HpgIHmlrDnuqLljIXlk6ZgO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3JzZUxhbXBfbGFiLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICAgICAgICAgIGNjLm1vdmVUbygxMCwgLTE1MDAsIDApLFxyXG4gICAgICAgICAgICAgICAgICAgIGNjLmNhbGxGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYW1wTGlzdC5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sYW1wTGlzdC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3JzZUxhbXBfTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgKSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5pe26Ze05beu6L2s5o2iXHJcbiAgICBzaG93VGltZSh0aW1lKSB7XHJcbiAgICAgICAgbGV0IGxlZnRkID0gTWF0aC5mbG9vcih0aW1lIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKSwgIC8v6K6h566X5aSp5pWwXHJcbiAgICAgICAgICAgIGxlZnRoID0gTWF0aC5mbG9vcih0aW1lIC8gKDEwMDAgKiA2MCAqIDYwKSAlIDI0KSwgIC8v6K6h566X5bCP5pe25pWwXHJcbiAgICAgICAgICAgIGxlZnRtID0gTWF0aC5mbG9vcih0aW1lIC8gKDEwMDAgKiA2MCkgJSA2MCksICAvL+iuoeeul+WIhumSn+aVsFxyXG4gICAgICAgICAgICBsZWZ0cyA9IE1hdGguZmxvb3IodGltZSAvIDEwMDAgJSA2MCk7ICAvL+iuoeeul+enkuaVsFxyXG4gICAgICAgIGxldCByZXN1bHQgPSBcIlwiO1xyXG4gICAgICAgIGlmIChsZWZ0ZCA+IDApIHtcclxuICAgICAgICAgICAgcmVzdWx0ICs9IChsZWZ0ZCArIFwi5aSpXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobGVmdGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCArPSAobGVmdGggKyBcIuWwj+aXtlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxlZnRtID4gMCkge1xyXG4gICAgICAgICAgICByZXN1bHQgKz0gKGxlZnRtICsgXCLliIZcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsZWZ0cyA+IDApIHtcclxuICAgICAgICAgICAgcmVzdWx0ICs9IChsZWZ0cyArIFwi56eSXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59KTtcclxuIl19