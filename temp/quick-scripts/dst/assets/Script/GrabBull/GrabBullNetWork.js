
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/GrabBull/GrabBullNetWork.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '0354d8t7uJNJ7Wc8YoFHiXL', 'GrabBullNetWork');
// Script/GrabBull/GrabBullNetWork.js

"use strict";

/**
 * 抢庄牛牛SOCKET通讯
 */
var GrabBullNetWork = function () {
  /**
   * 单例模式
   */
  function getInstant() {
    var _instance;

    if (_instance === undefined) {
      _instance = new Single();
    }

    return _instance;
  }
  /**
   * 逻辑层
   */


  function Single() {
    this.lobbyMain = null;
    this.grabBull = null;
    this.grabBullSocket = null;
    this.playerInfo = null;
    this.tableId = -1;
    this.seatId = -1;
    this.playerHead = null;
    this.tax = -1;
    this.addScore = 0;
    this.eventOn = false;
    /**
     * 初始化
     */

    this.init = function () {
      this.playerInfo = require("PlayerInfo").getInstant;
    },
    /**
     * 进入游戏
     * @param {*} loginIP 
     * @param {*} port 
     * @param {*} userid 
     * @param {*} sign 
     */
    this.loginGame_Function = function (loginIP, port, userid, sign) {
      console.log('loginIP:', loginIP);
      console.log('port:', port);
      console.log('userid:', userid);
      console.log('sign:', sign);
      var self = this;
      var socket = null;

      if (cc.sys.isNative) {
        self.grabBullSocket = SocketIO.connect(loginIP + ":" + port);
      } else {
        socket = require("socket-io");
        self.grabBullSocket = socket(loginIP + ":" + port);
      } //用户连接游戏服务器


      this.connectServer_Function(userid, sign); //连接失败

      this.grabBullSocket.on("error", function () {
        cc.sys.isBrowser && self.grabBullSocket.close();
        self.grabBullSocket = null;
        self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function("GrabBull");
      }), //连接失败
      this.grabBullSocket.on("connect_error", function () {
        cc.sys.isBrowser && self.grabBullSocket.close();
        self.grabBullSocket = null;
        self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function("GrabBull");
      }); //连接超时

      this.grabBullSocket.on("connect_timeout", function () {
        cc.sys.isBrowser && self.grabBullSocket.close();
        self.grabBullSocket = null;
        self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function("GrabBull");
      }); //连接

      this.grabBullSocket.on("connected", function (ret) {
        if (ret) {
          try {
            //进入游戏
            self.grabBullSocket.emit("LoginGame", {
              userid: userid,
              //用户ID
              gametype: 4,
              //游戏类型
              sign: sign //签名

            });
          } catch (error) {}
        }
      });
    };
    /**
     * 连接抢庄牛牛服务器
     * @param {*} userid 
     * @param {*} sign 
     */

    this.connectServer_Function = function (userid, sign) {
      var self = this;
      this.grabBullSocket && this.grabBullSocket.on("loginGameResult", function (ret) {
        /*游戏登录接口(LoginGame)的回调
            ret=
            {
                resultid: 1,    登录成功为 1
                msg: "login 抢庄牛牛 succeed!",
                Obj: {account: "账号", id: xxx, nickname: "用户名", score: 金币}
            }
        */
        var result = self.changeResultJSON_Function(ret);

        if (result.resultid) {
          //游戏登录成功
          self.playerInfo.playerCoin = result.Obj.score;
          self.lobbyMain.getComponent("LobbyMain").netWork.socket.disconnect();
          self.grabBullSocket.emit("LoginRoom", {
            //登录游戏房间接口 roomid传 1 就好
            roomid: 1
          });
          self.loginRoom_Function();
        } else {
          //游戏登录失败
          self.lobbyMain.getComponent("LobbyMain").loadGameScene = false;
          self.lobbyMain.getComponent("LobbyMain").showMessagebox_Function(result.msg, 1, 4);
          self.eventOn = true;
        }
      });
    };
    /**
     * 进入房间
     */


    this.loginRoom_Function = function () {
      var self = this; //返回房间数据

      this.grabBullSocket.on("LoginRoomResult", function (ret) {
        console.log('LoginRoomResult:', ret);
        var result = self.changeResultJSON_Function(ret);

        if (result.ResultCode) {
          self.lobbyMain.bg_Black.active = true;
          self.tableId = result.ResultData.TableId;
          self.seatId = result.ResultData.seatId;
          self.tax = result.ResultData.tax;
          self.addScore = result.ResultData.addscore;
          self.playerInfo.gameDisconnect = false;
          self.playerInfo.gameName = "GrabBull";
          cc.audioEngine.stopAll();
          cc.find("Canvas/buttonCtrl").getComponent("LobbyButtonClick").QieHuanScene_normal("GrabBullMain");
        }
      });
    };
    /**
     * 抢庄牛牛长连通讯
     */


    this.setGrabBullSocketOn_Function = function () {
      var self = this;
      /**
       * 游戏开始
       */

      this.grabBullSocket.on("readyPlay", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.gameStart_Function(result);
      });
      /**
       * 开始发牌
       */

      this.grabBullSocket.on("sendCard", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.sendCard_Function(result);
      });
      /**
       * 抢庄倍数
       */

      this.grabBullSocket.on("selectBet", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.checkBanker_Function(result);
      });
      /**
       * 抢庄回调 这段无用
       */

      this.grabBullSocket.on("callResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
      });
      /**
       * 抢庄倍数回调
       */

      this.grabBullSocket.on("callValueId", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.setXbetBankerLabel_Function(result);
      });
      /**
       * 无用
       */

      this.grabBullSocket.on("reCallResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
      });
      /**
       * 下注回调
       */

      this.grabBullSocket.on("reCallValueId", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.setXBetPlayerLabel_Function(result);
      });
      /**
       * 补牌
       */

      this.grabBullSocket.on("couCow", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.reissueCard_Function(result);
      });
      /**
       * 明牌
       */

      this.grabBullSocket.on("showResult", function (ret) {
        console.log('showResult:', ret);
        var result = self.changeResultJSON_Function(ret);

        switch (result.Result) {
          case 0:
            self.grabBull.showBullPoint_Function(result.data.cowPoint, result.data.seatId, result.data.card);
            break;
        }
      });
      /**
       * 本局金币结算回调,输了为负数
       */

      this.grabBullSocket.on("open", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        self.grabBull.billing_Function(result);
      });
      /**
       * 玩家进来的数据
       */

      this.grabBullSocket.on("playEnter", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        result.ResultCode && self.grabBull.playerEnterRoom_Function(result.ResultData);
      });
      /**
       * 离开的玩家数据
       */

      this.grabBullSocket.on("PlayerOut", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        result && self.grabBull.playerLeaveRoom_Function(result.PlayerSeatId, result.userId);
      });
      /**
       * 桌子状态信息
       */

      this.grabBullSocket.on("getDownTimeResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        result.ResultCode || self.grabBull.firstTimeEntryInit_Function(result);
      });
      /**
       * 当前桌子所有玩家信息
       */

      this.grabBullSocket.on("getTableListResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        result.ResuleCode || self.grabBull.playerMessageInit_Function(result.data.tableList);
      });
      /**
       * 金币不足,踢出房间
       */

      this.grabBullSocket.on("notEnouhtScore", function () {
        self.grabBull.noMoneyOut_Function();
      });
      /**
       * 长连接断开监听
       */

      this.grabBullSocket.on("disconnect", function (ret) {
        if (!self.grabBull.gameExit) {
          self.grabBull.disconnectNetWork_Function();
        }
      });
      this.grabBullSocket.on("noExit", function (ret) {
        ret = self.changeResultJSON_Function(ret);

        if (!!ret) {
          cc.find('Canvas/com_ingame_tips').active = true;
        } else {
          self.grabBull.gameExit = true;
          self.grabBull.exitGame_Function();
        }
      }); //vip特权

      this.grabBullSocket.on("vipGetCardResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);

        if (!!result && !!self.vipTap) {
          self.showVipBool = true;
          self.showVipIndexList = [];

          for (var i in result.card_list) {
            var seatIndex = self.grabBull.changeSeatId_Function(result.card_list[i].seatId);
            self.showVipIndexList.push(seatIndex);

            for (var j = 0; j < 5; j++) {
              self.grabBull.cardArray[j + 5 * seatIndex].getComponent("GrabBullCard").open_Function(result.card_list[i].card[j]);
            }
          }
        }
      });
      this.grabBullSocket.on("CanExit", function (ret) {
        ret = self.changeResultJSON_Function(ret);
        console.log('canExit', ret.result);
        self.grabBull.com_Button.getChildByName("bt_Exit").active = ret.result; // cc.find('Canvas/com_exit_tips').active = ret.result;
      });
    },
    /**
     * 传递this作用域
     * @param {*} scene 来自LobbyMain.js
     */
    this.setLobbyMainObj_Function = function (scene) {
      this.lobbyMain = scene;
    },
    /**
     * 传递this作用域
     * @param {*} scene 来自GrabBullMain.js
     */
    this.setGrabBullObj_Function = function (scene) {
      this.grabBull = scene;
    },
    /**
     * 解析JSON数据
     * @param {*} ret 
     */
    this.changeResultJSON_Function = function (ret) {
      if (cc.sys.isNative) {
        return JSON.parse(ret);
      }

      return ret;
    }, this.init();
  }

  return {
    getInstant: new getInstant()
  };
}();

module.exports = GrabBullNetWork;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxHcmFiQnVsbFxcR3JhYkJ1bGxOZXRXb3JrLmpzIl0sIm5hbWVzIjpbIkdyYWJCdWxsTmV0V29yayIsImdldEluc3RhbnQiLCJfaW5zdGFuY2UiLCJ1bmRlZmluZWQiLCJTaW5nbGUiLCJsb2JieU1haW4iLCJncmFiQnVsbCIsImdyYWJCdWxsU29ja2V0IiwicGxheWVySW5mbyIsInRhYmxlSWQiLCJzZWF0SWQiLCJwbGF5ZXJIZWFkIiwidGF4IiwiYWRkU2NvcmUiLCJldmVudE9uIiwiaW5pdCIsInJlcXVpcmUiLCJsb2dpbkdhbWVfRnVuY3Rpb24iLCJsb2dpbklQIiwicG9ydCIsInVzZXJpZCIsInNpZ24iLCJjb25zb2xlIiwibG9nIiwic2VsZiIsInNvY2tldCIsImNjIiwic3lzIiwiaXNOYXRpdmUiLCJTb2NrZXRJTyIsImNvbm5lY3QiLCJjb25uZWN0U2VydmVyX0Z1bmN0aW9uIiwib24iLCJpc0Jyb3dzZXIiLCJjbG9zZSIsImdhbWVEaXNjb25uZWN0IiwiY29udGVudEdhbWVTZXJ2ZXJGYWlsX0Z1bmN0aW9uIiwicmV0IiwiZW1pdCIsImdhbWV0eXBlIiwiZXJyb3IiLCJyZXN1bHQiLCJjaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uIiwicmVzdWx0aWQiLCJwbGF5ZXJDb2luIiwiT2JqIiwic2NvcmUiLCJnZXRDb21wb25lbnQiLCJuZXRXb3JrIiwiZGlzY29ubmVjdCIsInJvb21pZCIsImxvZ2luUm9vbV9GdW5jdGlvbiIsImxvYWRHYW1lU2NlbmUiLCJzaG93TWVzc2FnZWJveF9GdW5jdGlvbiIsIm1zZyIsIlJlc3VsdENvZGUiLCJiZ19CbGFjayIsImFjdGl2ZSIsIlJlc3VsdERhdGEiLCJUYWJsZUlkIiwiYWRkc2NvcmUiLCJnYW1lTmFtZSIsImF1ZGlvRW5naW5lIiwic3RvcEFsbCIsImZpbmQiLCJRaWVIdWFuU2NlbmVfbm9ybWFsIiwic2V0R3JhYkJ1bGxTb2NrZXRPbl9GdW5jdGlvbiIsImdhbWVTdGFydF9GdW5jdGlvbiIsInNlbmRDYXJkX0Z1bmN0aW9uIiwiY2hlY2tCYW5rZXJfRnVuY3Rpb24iLCJzZXRYYmV0QmFua2VyTGFiZWxfRnVuY3Rpb24iLCJzZXRYQmV0UGxheWVyTGFiZWxfRnVuY3Rpb24iLCJyZWlzc3VlQ2FyZF9GdW5jdGlvbiIsIlJlc3VsdCIsInNob3dCdWxsUG9pbnRfRnVuY3Rpb24iLCJkYXRhIiwiY293UG9pbnQiLCJjYXJkIiwiYmlsbGluZ19GdW5jdGlvbiIsInBsYXllckVudGVyUm9vbV9GdW5jdGlvbiIsInBsYXllckxlYXZlUm9vbV9GdW5jdGlvbiIsIlBsYXllclNlYXRJZCIsInVzZXJJZCIsImZpcnN0VGltZUVudHJ5SW5pdF9GdW5jdGlvbiIsIlJlc3VsZUNvZGUiLCJwbGF5ZXJNZXNzYWdlSW5pdF9GdW5jdGlvbiIsInRhYmxlTGlzdCIsIm5vTW9uZXlPdXRfRnVuY3Rpb24iLCJnYW1lRXhpdCIsImRpc2Nvbm5lY3ROZXRXb3JrX0Z1bmN0aW9uIiwiZXhpdEdhbWVfRnVuY3Rpb24iLCJ2aXBUYXAiLCJzaG93VmlwQm9vbCIsInNob3dWaXBJbmRleExpc3QiLCJpIiwiY2FyZF9saXN0Iiwic2VhdEluZGV4IiwiY2hhbmdlU2VhdElkX0Z1bmN0aW9uIiwicHVzaCIsImoiLCJjYXJkQXJyYXkiLCJvcGVuX0Z1bmN0aW9uIiwiY29tX0J1dHRvbiIsImdldENoaWxkQnlOYW1lIiwic2V0TG9iYnlNYWluT2JqX0Z1bmN0aW9uIiwic2NlbmUiLCJzZXRHcmFiQnVsbE9ial9GdW5jdGlvbiIsIkpTT04iLCJwYXJzZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0EsSUFBSUEsZUFBZSxHQUFJLFlBQVk7QUFDL0I7QUFDSjtBQUNBO0FBQ0ksV0FBU0MsVUFBVCxHQUFzQjtBQUNsQixRQUFJQyxTQUFKOztBQUNBLFFBQUlBLFNBQVMsS0FBS0MsU0FBbEIsRUFBNkI7QUFDekJELE1BQUFBLFNBQVMsR0FBRyxJ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ZUFBakIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDmiqLluoTniZvniZtTT0NLRVTpgJrorq9cclxuICovXHJcbnZhciBHcmFiQnVsbE5ldFdvcmsgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiDljZXkvovmqKHlvI9cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0SW5zdGFudCgpIHtcclxuICAgICAgICB2YXIgX2luc3RhbmNlO1xyXG4gICAgICAgIGlmIChfaW5zdGFuY2UgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBfaW5zdGFuY2UgPSBuZXcgU2luZ2xlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmAu+i+keWxglxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBTaW5nbGUoKSB7XHJcbiAgICAgICAgdGhpcy5sb2JieU1haW4gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZ3JhYkJ1bGwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucGxheWVySW5mbyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50YWJsZUlkID0gLTE7XHJcbiAgICAgICAgdGhpcy5zZWF0SWQgPSAtMTtcclxuICAgICAgICB0aGlzLnBsYXllckhlYWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudGF4ID0gLTE7XHJcbiAgICAgICAgdGhpcy5hZGRTY29yZSA9IDA7XHJcbiAgICAgICAgdGhpcy5ldmVudE9uID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWIneWni+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVySW5mbyA9IHJlcXVpcmUoXCJQbGF5ZXJJbmZvXCIpLmdldEluc3RhbnQ7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog6L+b5YWl5ri45oiPXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Kn0gbG9naW5JUCBcclxuICAgICAgICAgICAgICogQHBhcmFtIHsqfSBwb3J0IFxyXG4gICAgICAgICAgICAgKiBAcGFyYW0geyp9IHVzZXJpZCBcclxuICAgICAgICAgICAgICogQHBhcmFtIHsqfSBzaWduIFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5sb2dpbkdhbWVfRnVuY3Rpb24gPSBmdW5jdGlvbiAobG9naW5JUCwgcG9ydCwgdXNlcmlkLCBzaWduKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbG9naW5JUDonLCBsb2dpbklQKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwb3J0OicsIHBvcnQpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXJpZDonLCB1c2VyaWQpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpZ246Jywgc2lnbik7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgc29ja2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsU29ja2V0ID0gU29ja2V0SU8uY29ubmVjdChsb2dpbklQICsgXCI6XCIgKyBwb3J0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29ja2V0ID0gcmVxdWlyZShcInNvY2tldC1pb1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsU29ja2V0ID0gc29ja2V0KGxvZ2luSVAgKyBcIjpcIiArIHBvcnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy/nlKjmiLfov57mjqXmuLjmiI/mnI3liqHlmahcclxuICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdFNlcnZlcl9GdW5jdGlvbih1c2VyaWQsIHNpZ24pO1xyXG4gICAgICAgICAgICAgICAgLy/ov57mjqXlpLHotKVcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJlcnJvclwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnN5cy5pc0Jyb3dzZXIgJiYgc2VsZi5ncmFiQnVsbFNvY2tldC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsU29ja2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5ZXJJbmZvLmdhbWVEaXNjb25uZWN0IHx8IHNlbGYubG9iYnlNYWluLmNvbnRlbnRHYW1lU2VydmVyRmFpbF9GdW5jdGlvbihcIkdyYWJCdWxsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIC8v6L+e5o6l5aSx6LSlXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcImNvbm5lY3RfZXJyb3JcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5zeXMuaXNCcm93c2VyICYmIHNlbGYuZ3JhYkJ1bGxTb2NrZXQuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmFiQnVsbFNvY2tldCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGxheWVySW5mby5nYW1lRGlzY29ubmVjdCB8fCBzZWxmLmxvYmJ5TWFpbi5jb250ZW50R2FtZVNlcnZlckZhaWxfRnVuY3Rpb24oXCJHcmFiQnVsbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIC8v6L+e5o6l6LaF5pe2XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwiY29ubmVjdF90aW1lb3V0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy5zeXMuaXNCcm93c2VyICYmIHNlbGYuZ3JhYkJ1bGxTb2NrZXQuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsU29ja2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXllckluZm8uZ2FtZURpc2Nvbm5lY3QgfHwgc2VsZi5sb2JieU1haW4uY29udGVudEdhbWVTZXJ2ZXJGYWlsX0Z1bmN0aW9uKFwiR3JhYkJ1bGxcIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIC8v6L+e5o6lXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwiY29ubmVjdGVkXCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+i/m+WFpea4uOaIj1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmFiQnVsbFNvY2tldC5lbWl0KFwiTG9naW5HYW1lXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyaWQ6IHVzZXJpZCwgLy/nlKjmiLdJRFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWV0eXBlOiA0LCAvL+a4uOaIj+exu+Wei1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ246IHNpZ24gLy/nrb7lkI1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge31cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6L+e5o6l5oqi5bqE54mb54mb5pyN5Yqh5ZmoXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSB1c2VyaWQgXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSBzaWduIFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY29ubmVjdFNlcnZlcl9GdW5jdGlvbiA9IGZ1bmN0aW9uICh1c2VyaWQsIHNpZ24pIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldCAmJiB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwibG9naW5HYW1lUmVzdWx0XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgIC8q5ri45oiP55m75b2V5o6l5Y+jKExvZ2luR2FtZSnnmoTlm57osINcclxuICAgICAgICAgICAgICAgICAgICByZXQ9XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRpZDogMSwgICAg55m75b2V5oiQ5Yqf5Li6IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiBcImxvZ2luIOaKouW6hOeJm+eJmyBzdWNjZWVkIVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmo6IHthY2NvdW50OiBcIui0puWPt1wiLCBpZDogeHh4LCBuaWNrbmFtZTogXCLnlKjmiLflkI1cIiwgc2NvcmU6IOmHkeW4gX1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXN1bHRpZCkgeyAvL+a4uOaIj+eZu+W9leaIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGxheWVySW5mby5wbGF5ZXJDb2luID0gcmVzdWx0Lk9iai5zY29yZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYmJ5TWFpbi5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikubmV0V29yay5zb2NrZXQuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGxTb2NrZXQuZW1pdChcIkxvZ2luUm9vbVwiLCB7IC8v55m75b2V5ri45oiP5oi/6Ze05o6l5Y+jIHJvb21pZOS8oCAxIOWwseWlvVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb29taWQ6IDFcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luUm9vbV9GdW5jdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+a4uOaIj+eZu+W9leWksei0pVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9iYnlNYWluLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5sb2FkR2FtZVNjZW5lID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2JieU1haW4uZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLnNob3dNZXNzYWdlYm94X0Z1bmN0aW9uKHJlc3VsdC5tc2csIDEsIDQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZXZlbnRPbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOi/m+WFpeaIv+mXtFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubG9naW5Sb29tX0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIC8v6L+U5Zue5oi/6Ze05pWw5o2uXHJcbiAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJMb2dpblJvb21SZXN1bHRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvZ2luUm9vbVJlc3VsdDonLCByZXQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5SZXN1bHRDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2JieU1haW4uYmdfQmxhY2suYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnRhYmxlSWQgPSByZXN1bHQuUmVzdWx0RGF0YS5UYWJsZUlkO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhdElkID0gcmVzdWx0LlJlc3VsdERhdGEuc2VhdElkO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYudGF4ID0gcmVzdWx0LlJlc3VsdERhdGEudGF4O1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkU2NvcmUgPSByZXN1bHQuUmVzdWx0RGF0YS5hZGRzY29yZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXllckluZm8uZ2FtZURpc2Nvbm5lY3QgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXllckluZm8uZ2FtZU5hbWUgPSBcIkdyYWJCdWxsXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvYnV0dG9uQ3RybFwiKS5nZXRDb21wb25lbnQoXCJMb2JieUJ1dHRvbkNsaWNrXCIpLlFpZUh1YW5TY2VuZV9ub3JtYWwoXCJHcmFiQnVsbE1haW5cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaKouW6hOeJm+eJm+mVv+i/numAmuiur1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2V0R3JhYkJ1bGxTb2NrZXRPbl9GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIOa4uOaIj+W8gOWni1xyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwicmVhZHlQbGF5XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmFiQnVsbC5nYW1lU3RhcnRfRnVuY3Rpb24ocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5byA5aeL5Y+R54mMXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJzZW5kQ2FyZFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwuc2VuZENhcmRfRnVuY3Rpb24ocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5oqi5bqE5YCN5pWwXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJzZWxlY3RCZXRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsLmNoZWNrQmFua2VyX0Z1bmN0aW9uKHJlc3VsdClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5oqi5bqE5Zue6LCDIOi/meauteaXoOeUqFxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwiY2FsbFJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDmiqLluoTlgI3mlbDlm57osINcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcImNhbGxWYWx1ZUlkXCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmFiQnVsbC5zZXRYYmV0QmFua2VyTGFiZWxfRnVuY3Rpb24ocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5peg55SoXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJyZUNhbGxSZXN1bHRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5LiL5rOo5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJyZUNhbGxWYWx1ZUlkXCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmFiQnVsbC5zZXRYQmV0UGxheWVyTGFiZWxfRnVuY3Rpb24ocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog6KGl54mMXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJjb3VDb3dcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsLnJlaXNzdWVDYXJkX0Z1bmN0aW9uKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIOaYjueJjFxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwic2hvd1Jlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Nob3dSZXN1bHQ6JywgcmV0KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyZXN1bHQuUmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwuc2hvd0J1bGxQb2ludF9GdW5jdGlvbihyZXN1bHQuZGF0YS5jb3dQb2ludCwgcmVzdWx0LmRhdGEuc2VhdElkLCByZXN1bHQuZGF0YS5jYXJkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5pys5bGA6YeR5biB57uT566X5Zue6LCDLOi+k+S6huS4uui0n+aVsFxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwib3BlblwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwuYmlsbGluZ19GdW5jdGlvbihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDnjqnlrrbov5vmnaXnmoTmlbDmja5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcInBsYXlFbnRlclwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5SZXN1bHRDb2RlICYmIHNlbGYuZ3JhYkJ1bGwucGxheWVyRW50ZXJSb29tX0Z1bmN0aW9uKHJlc3VsdC5SZXN1bHREYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog56a75byA55qE546p5a625pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJQbGF5ZXJPdXRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgJiYgc2VsZi5ncmFiQnVsbC5wbGF5ZXJMZWF2ZVJvb21fRnVuY3Rpb24ocmVzdWx0LlBsYXllclNlYXRJZCwgcmVzdWx0LnVzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIOahjOWtkOeKtuaAgeS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwiZ2V0RG93blRpbWVSZXN1bHRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuUmVzdWx0Q29kZSB8fCBzZWxmLmdyYWJCdWxsLmZpcnN0VGltZUVudHJ5SW5pdF9GdW5jdGlvbihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDlvZPliY3moYzlrZDmiYDmnInnjqnlrrbkv6Hmga9cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcImdldFRhYmxlTGlzdFJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5SZXN1bGVDb2RlIHx8IHNlbGYuZ3JhYkJ1bGwucGxheWVyTWVzc2FnZUluaXRfRnVuY3Rpb24ocmVzdWx0LmRhdGEudGFibGVMaXN0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog6YeR5biB5LiN6LazLOi4ouWHuuaIv+mXtFxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwibm90RW5vdWh0U2NvcmVcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwubm9Nb25leU91dF9GdW5jdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDplb/ov57mjqXmlq3lvIDnm5HlkKxcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcImRpc2Nvbm5lY3RcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5ncmFiQnVsbC5nYW1lRXhpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsLmRpc2Nvbm5lY3ROZXRXb3JrX0Z1bmN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsU29ja2V0Lm9uKFwibm9FeGl0XCIsIHJldCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhcmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9jb21faW5nYW1lX3RpcHMnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwuZ2FtZUV4aXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsLmV4aXRHYW1lX0Z1bmN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy92aXDnibnmnYNcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JhYkJ1bGxTb2NrZXQub24oXCJ2aXBHZXRDYXJkUmVzdWx0XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhcmVzdWx0ICYmICEhc2VsZi52aXBUYXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93VmlwQm9vbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1ZpcEluZGV4TGlzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHJlc3VsdC5jYXJkX2xpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWF0SW5kZXggPSBzZWxmLmdyYWJCdWxsLmNoYW5nZVNlYXRJZF9GdW5jdGlvbihyZXN1bHQuY2FyZF9saXN0W2ldLnNlYXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dWaXBJbmRleExpc3QucHVzaChzZWF0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA1OyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYWJCdWxsLmNhcmRBcnJheVtqICsgNSAqIHNlYXRJbmRleF0uZ2V0Q29tcG9uZW50KFwiR3JhYkJ1bGxDYXJkXCIpLm9wZW5fRnVuY3Rpb24ocmVzdWx0LmNhcmRfbGlzdFtpXS5jYXJkW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmFiQnVsbFNvY2tldC5vbihcIkNhbkV4aXRcIiwgcmV0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2FuRXhpdCcsIHJldC5yZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JhYkJ1bGwuY29tX0J1dHRvbi5nZXRDaGlsZEJ5TmFtZShcImJ0X0V4aXRcIikuYWN0aXZlID0gcmV0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5maW5kKCdDYW52YXMvY29tX2V4aXRfdGlwcycpLmFjdGl2ZSA9IHJldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiDkvKDpgJJ0aGlz5L2c55So5Z+fXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Kn0gc2NlbmUg5p2l6IeqTG9iYnlNYWluLmpzXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLnNldExvYmJ5TWFpbk9ial9GdW5jdGlvbiA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2JieU1haW4gPSBzY2VuZTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiDkvKDpgJJ0aGlz5L2c55So5Z+fXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Kn0gc2NlbmUg5p2l6IeqR3JhYkJ1bGxNYWluLmpzXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLnNldEdyYWJCdWxsT2JqX0Z1bmN0aW9uID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYWJCdWxsID0gc2NlbmU7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog6Kej5p6QSlNPTuaVsOaNrlxyXG4gICAgICAgICAgICAgKiBAcGFyYW0geyp9IHJldCBcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbiA9IGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldEluc3RhbnQ6IG5ldyBnZXRJbnN0YW50KClcclxuICAgIH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR3JhYkJ1bGxOZXRXb3JrOyJdfQ==