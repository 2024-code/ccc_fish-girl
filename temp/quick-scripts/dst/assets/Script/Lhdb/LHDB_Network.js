
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Lhdb/LHDB_Network.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'd98b5o2AJJAFa6/4Y+v/bTy', 'LHDB_Network');
// Script/Lhdb/LHDB_Network.js

"use strict";

cc.Class({
  "extends": cc.Component,
  onLoad: function onLoad() {
    this.playerInfo = require("PlayerInfo").getInstant;
    this.gameMain = this.node.getComponent('LHDB_Main');
    this.sign = this.playerInfo.gameSign;
    this.userId = this.playerInfo.playerId;
    this.port = ':15200';
    this.timer = 0; //连接网络

    if (cc.sys.isNative) {
      this.socket = SocketIO.connect(Lhjconfig.Server_IP + this.port);
    } else {
      var socket = require("socket-io");

      this.socket = socket(Lhjconfig.Server_IP + this.port);
    }

    this.registEvent();
  },
  registEvent: function registEvent() {
    var _this = this;

    this.socket.on("connected", function (ret) {
      cc.log('connected:' + ret);

      if (ret) {
        _this.socket.emit("LoginGame", JSON.stringify({
          userid: _this.userId,
          //用户ID
          gametype: 11,
          //游戏类型
          sign: _this.sign //签名

        }));
      }
    });
    this.socket.on("loginGameResult", function (ret) {
      var result = _this.changeResultJSON_Function(ret);

      cc.log('游戏登陆成功=======================' + JSON.stringify(result));
      LHDB_LOBBYNET.disconnect();
      _this.gameMain.lblAllCoin.string = Helper.fixNum(result.Obj.score);

      if (result.resultid) {
        //游戏登录成功
        _this.socket.emit("LoginRoom", JSON.stringify({
          roomid: 1
        }));
      } else {
        cc.log(result.msg);
      }
    });
    this.socket.on("LoginRoomResult", function (ret) {
      var result = _this.changeResultJSON_Function(ret);

      cc.log('LoginRoom结果' + JSON.stringify(result)); //设置奖池

      _this.gameMain.lblCoin.string = (result.ResultData.gameDict.big_win_score * 0.01).toFixed(2);
      _this.gameMain.lblGoldPool.string = result.ResultData.score_pool;

      _this.gameMain.setLevel(result.ResultData.gameDict.game_level_num);

      var list = _this.gameMain.levelList[_this.gameMain.level - 1].children;

      for (var i = 0; i < result.ResultData.gameDict.zuan_tou; i++) {
        list[i].active = false;
      }
    });
    this.socket.on("clearGameDictResult", function (ret) {
      var result = _this.changeResultJSON_Function(ret);

      if (result) {
        _this.gameMain.exitGame();
      }
    });
    this.socket.on("lotteryResult", function (ret) {
      var result = _this.changeResultJSON_Function(ret);

      cc.log('下注结果' + JSON.stringify(result));
      var data = result.dictAnalyseResult;

      if (result.ResultCode >= 1) {
        _this.gameMain.gemList = [];
        _this.gameMain.gemPidList = [];

        _this.gameMain.areaList[data.game_level_num - 1].removeAllChildren();

        var _loop = function _loop(i) {
          _this.gameMain.scheduleOnce(function () {
            for (var j in data.res_list[i]) {
              if (parseInt(i) > 0) {
                if (_this.gameMain.gemPidList[j] != data.res_list[i][j]) {
                  _this.gameMain.levelDown(data.game_level_num, parseInt(j), data.res_list[i][j]);
                }
              } else {
                _this.gameMain.levelDown(data.game_level_num, parseInt(j), data.res_list[i][j]);
              }
            }

            if (!!data.res_list[i] && data.res_list[i].length > 0) {
              _this.scheduleOnce(function () {
                _this.gameMain.audio.playLandAudio();
              }, 0.7);
            }

            _this.gameMain.scheduleOnce(function () {
              for (var _j in data.win_temp_list[i]) {
                _this.gameMain.gemBoo(data.win_temp_list[i][_j]);
              }

              if (!!data.win_temp_list[i] && data.win_temp_list[i].length > 0) {
                _this.gameMain.audio.playBoo();
              }
            }, 1);

            _this.gameMain.scheduleOnce(function () {
              _this.gameMain.cleanBoo(data.game_level_num);
            }, 1.6);
          }, parseInt(i) * 1.8);
        };

        for (var i in data.res_list) {
          _loop(i);
        }

        _this.gameMain.scheduleOnce(function () {
          _this.gameMain.tmOffset = true;
          _this.gameMain.startBtn.interactable = true;
          _this.gameMain.tuoguan && !data.is_big_win && _this.gameMain.startGame();
          _this.gameMain.lblCoin.string = Helper.fixNum(data.user_game_dict.big_win_score);
          _this.gameMain.lblAllCoin.string = Helper.fixNum(data.user_score);

          if (data.user_game_dict.game_level_num != _this.gameMain.level) {
            _this.gameMain.setLevel(data.user_game_dict.game_level_num);
          }

          if (data.is_big_win) {
            var _this$gameMain;

            if (_this.gameMain.tuoguan) {
              _this.gameMain.tuoguan = !_this.gameMain.tuoguan;
              _this.gameMain.tuoguanList[0].active = !_this.gameMain.tuoguan;
              _this.gameMain.tuoguanList[1].active = _this.gameMain.tuoguan;
            }

            (_this$gameMain = _this.gameMain).setBox.apply(_this$gameMain, data.big_win);
          }
        }, data.res_list.length * 1.8);
      } else if (result.ResultCode == -2) {
        _this.gameMain.showTip('游戏币不足');

        _this.gameMain.startBtn.interactable = true;
        _this.gameMain.tmOffset = true;

        if (_this.gameMain.tuoguan) {
          _this.gameMain.tuoguan = !_this.gameMain.tuoguan;
          _this.gameMain.tuoguanList[0].active = !_this.gameMain.tuoguan;
          _this.gameMain.tuoguanList[1].active = _this.gameMain.tuoguan;
        }
      }
    });
  },
  changeResultJSON_Function: function changeResultJSON_Function(ret) {
    if (cc.sys.isNative) {
      return JSON.parse(ret);
    }

    return ret;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxMaGRiXFxMSERCX05ldHdvcmsuanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsIm9uTG9hZCIsInBsYXllckluZm8iLCJyZXF1aXJlIiwiZ2V0SW5zdGFudCIsImdhbWVNYWluIiwibm9kZSIsImdldENvbXBvbmVudCIsInNpZ24iLCJnYW1lU2lnbiIsInVzZXJJZCIsInBsYXllcklkIiwicG9ydCIsInRpbWVyIiwic3lzIiwiaXNOYXRpdmUiLCJzb2NrZXQiLCJTb2NrZXRJTyIsImNvbm5lY3QiLCJMaGpjb25maWciLCJTZXJ2ZXJfSVAiLCJyZWdpc3RFdmVudCIsIm9uIiwicmV0IiwibG9nIiwiZW1pdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1c2VyaWQiLCJnYW1ldHlwZSIsInJlc3VsdCIsImNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24iLCJMSERCX0xPQkJZTkVUIiwiZGlzY29ubmVjdCIsImxibEFsbENvaW4iLCJzdHJpbmciLCJIZWxwZXIiLCJmaXhOdW0iLCJPYmoiLCJzY29yZSIsInJlc3VsdGlkIiwicm9vbWlkIiwibXNnIiwibGJsQ29pbiIsIlJlc3VsdERhdGEiLCJnYW1lRGljdCIsImJpZ193aW5fc2NvcmUiLCJ0b0ZpeGVkIiwibGJsR29sZFBvb2wiLCJzY29yZV9wb29sIiwic2V0TGV2ZWwiLCJnYW1lX2xldmVsX251bSIsImxpc3QiLCJsZXZlbExpc3QiLCJsZXZlbCIsImNoaWxkcmVuIiwiaSIsInp1YW5fdG91IiwiYWN0aXZlIiwiZXhpdEdhbWUiLCJkYXRhIiwiZGljdEFuYWx5c2VSZXN1bHQiLCJSZXN1bHRDb2RlIiwiZ2VtTGlzdCIsImdlbVBpZExpc3QiLCJhcmVhTGlzdCIsInJlbW92ZUFsbENoaWxkcmVuIiwic2NoZWR1bGVPbmNlIiwiaiIsInJlc19saXN0IiwicGFyc2VJbnQiLCJsZXZlbERvd24iLCJsZW5ndGgiLCJhdWRpbyIsInBsYXlMYW5kQXVkaW8iLCJ3aW5fdGVtcF9saXN0IiwiZ2VtQm9vIiwicGxheUJvbyIsImNsZWFuQm9vIiwidG1PZmZzZXQiLCJzdGFydEJ0biIsImludGVyYWN0YWJsZSIsInR1b2d1YW4iLCJpc19iaWdfd2luIiwic3RhcnRHYW1lIiwidXNlcl9nYW1lX2RpY3QiLCJ1c2VyX3Njb3JlIiwidHVvZ3Vhbkxpc3QiLCJzZXRCb3giLCJiaWdfd2luIiwic2hvd1RpcCIsInBhcnNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxNQUhLLG9CQUdJO0FBQ0wsU0FBS0MsVUFBTCxHQUFrQkMsT0FBTyxDQUFDLFlBQUQsQ0FBUCxDQUFzQkMsVUFBeEM7QUFDQSxTQUFLQyxRQUFMLEdBQWdCLEtBQUtDLElBQUwsQ0FBVUMsWUFBVixDQUF1QixXQUF2QixDQUFoQjtBQUNBLFNBQUtDLElBQUwsR0FBWSxLQUFLTixVQUFMLENBQWdCTyxRQUE1QjtBQUNBLFNBQUtDLE1BQUwsR0FBYyxLQUFLUixVQUFMLENBQWdCUyxRQUE5QjtBQUNBLFNBQUtDLElBQUwsR0FBWSxRQUFaO0FBQ0EsU0FBS0MsS0FBTCxHQUFhLENBQWIsQ0FOSyxDQU9MOztBQUNBLFFBQUlmLEVBQUUsQ0FBQ2dCLEdBQUgsQ0FBT0MsUUFBWCxFQUFxQjtBQUNqQixXQUFLQyxNQUFMLEdBQWNDLFFBQVEsQ0FBQ0MsT0FBVCxDQUFpQkMsU0FBUyxDQUFDQyxTQUFWLEdBQXNCLEtBQUtSLElBQTVDLENBQWQ7QUFDSCxLQUZELE1BRU87QUFDSCxVQUFJSSxNQUFNLEdBQUdiLE9BQU8sQ0FBQyxXQUFELENBQXBCOztBQUNBLFdBQUthLE1BQUwsR0FBY0EsTUFBTSxDQUFDRyxTQUFTLENBQUNDLFNBQVYsR0FBc0IsS0FBS1IsSUFBNUIsQ0FBcEI7QUFDSDs7QUFDRCxTQUFLUyxXQUFMO0FBQ0gsR0FsQkk7QUFvQkxBLEVBQUFBLFdBcEJLLHlCQW9CUztBQUFBOztBQUNW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LFFBQUwsQ0FBYzBFLFFBQWQsR0FBeUIsSUFBekI7O0FBQ0EsWUFBSSxLQUFJLENBQUMxRSxRQUFMLENBQWM2RSxPQUFsQixFQUEyQjtBQUN2QixVQUFBLEtBQUksQ0FBQzdFLFFBQUwsQ0FBYzZFLE9BQWQsR0FBd0IsQ0FBQyxLQUFJLENBQUM3RSxRQUFMLENBQWM2RSxPQUF2QztBQUNBLFVBQUEsS0FBSSxDQUFDN0UsUUFBTCxDQUFja0YsV0FBZCxDQUEwQixDQUExQixFQUE2QjdCLE1BQTdCLEdBQXNDLENBQUMsS0FBSSxDQUFDckQsUUFBTCxDQUFjNkUsT0FBckQ7QUFDQSxVQUFBLEtBQUksQ0FBQzdFLFFBQUwsQ0FBY2tGLFdBQWQsQ0FBMEIsQ0FBMUIsRUFBNkI3QixNQUE3QixHQUFzQyxLQUFJLENBQUNyRCxRQUFMLENBQWM2RSxPQUFwRDtBQUNIO0FBQ0o7QUFDSixLQWxFRDtBQW1FSCxHQXJJSTtBQXVJTG5ELEVBQUFBLHlCQXZJSyxxQ0F1SXFCUixHQXZJckIsRUF1STBCO0FBQzNCLFFBQUl6QixFQUFFLENBQUNnQixHQUFILENBQU9DLFFBQVgsRUFBcUI7QUFDakIsYUFBT1csSUFBSSxDQUFDaUUsS0FBTCxDQUFXcEUsR0FBWCxDQUFQO0FBQ0g7O0FBQ0QsV0FBT0EsR0FBUDtBQUNIO0FBNUlJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJJbmZvID0gcmVxdWlyZShcIlBsYXllckluZm9cIikuZ2V0SW5zdGFudDtcclxuICAgICAgICB0aGlzLmdhbWVNYWluID0gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnTEhEQl9NYWluJyk7XHJcbiAgICAgICAgdGhpcy5zaWduID0gdGhpcy5wbGF5ZXJJbmZvLmdhbWVTaWduO1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gdGhpcy5wbGF5ZXJJbmZvLnBsYXllcklkO1xyXG4gICAgICAgIHRoaXMucG9ydCA9ICc6MTUyMDAnO1xyXG4gICAgICAgIHRoaXMudGltZXIgPSAwO1xyXG4gICAgICAgIC8v6L+e5o6l572R57ucXHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNvY2tldCA9IFNvY2tldElPLmNvbm5lY3QoTGhqY29uZmlnLlNlcnZlcl9JUCArIHRoaXMucG9ydCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHNvY2tldCA9IHJlcXVpcmUoXCJzb2NrZXQtaW9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0KExoamNvbmZpZy5TZXJ2ZXJfSVAgKyB0aGlzLnBvcnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZ2lzdEV2ZW50KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlZ2lzdEV2ZW50KCkge1xyXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKFwiY29ubmVjdGVkXCIsIHJldCA9PiB7XHJcbiAgICAgICAgICAgIGNjLmxvZygnY29ubmVjdGVkOicgKyByZXQpO1xyXG4gICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KFwiTG9naW5HYW1lXCIsIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyaWQ6IHRoaXMudXNlcklkLCAvL+eUqOaIt0lEXHJcbiAgICAgICAgICAgICAgICAgICAgZ2FtZXR5cGU6IDExLCAvL+a4uOaIj+exu+Wei1xyXG4gICAgICAgICAgICAgICAgICAgIHNpZ246IHRoaXMuc2lnbiAvL+etvuWQjVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKFwibG9naW5HYW1lUmVzdWx0XCIsIHJldCA9PiB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgY2MubG9nKCfmuLjmiI/nmbvpmYbmiJDlip89PT09PT09PT09PT09PT09PT09PT09PScgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcclxuICAgICAgICAgICAgTEhEQl9MT0JCWU5FVC5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4ubGJsQWxsQ29pbi5zdHJpbmcgPSBIZWxwZXIuZml4TnVtKHJlc3VsdC5PYmouc2NvcmUpO1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0LnJlc3VsdGlkKSB7IC8v5ri45oiP55m75b2V5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KFwiTG9naW5Sb29tXCIsIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICByb29taWQ6IDFcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhyZXN1bHQubXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNvY2tldC5vbihcIkxvZ2luUm9vbVJlc3VsdFwiLCByZXQgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgIGNjLmxvZygnTG9naW5Sb29t57uT5p6cJyArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpO1xyXG4gICAgICAgICAgICAvL+iuvue9ruWlluaxoFxyXG4gICAgICAgICAgICB0aGlzLmdhbWVNYWluLmxibENvaW4uc3RyaW5nID0gKHJlc3VsdC5SZXN1bHREYXRhLmdhbWVEaWN0LmJpZ193aW5fc2NvcmUgKiAwLjAxKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVNYWluLmxibEdvbGRQb29sLnN0cmluZyA9IHJlc3VsdC5SZXN1bHREYXRhLnNjb3JlX3Bvb2w7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2V0TGV2ZWwocmVzdWx0LlJlc3VsdERhdGEuZ2FtZURpY3QuZ2FtZV9sZXZlbF9udW0pO1xyXG4gICAgICAgICAgICBsZXQgbGlzdCA9IHRoaXMuZ2FtZU1haW4ubGV2ZWxMaXN0W3RoaXMuZ2FtZU1haW4ubGV2ZWwgLSAxXS5jaGlsZHJlbjtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQuUmVzdWx0RGF0YS5nYW1lRGljdC56dWFuX3RvdTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5zb2NrZXQub24oXCJjbGVhckdhbWVEaWN0UmVzdWx0XCIsIHJldCA9PiB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lTWFpbi5leGl0R2FtZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5zb2NrZXQub24oXCJsb3R0ZXJ5UmVzdWx0XCIsIHJldCA9PiB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgY2MubG9nKCfkuIvms6jnu5PmnpwnICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXN1bHQuZGljdEFuYWx5c2VSZXN1bHQ7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuUmVzdWx0Q29kZSA+PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLmdlbUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uZ2VtUGlkTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lTWFpbi5hcmVhTGlzdFtkYXRhLmdhbWVfbGV2ZWxfbnVtIC0gMV0ucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gZGF0YS5yZXNfbGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2NoZWR1bGVPbmNlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiBpbiBkYXRhLnJlc19saXN0W2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoaSkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZU1haW4uZ2VtUGlkTGlzdFtqXSAhPSBkYXRhLnJlc19saXN0W2ldW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4ubGV2ZWxEb3duKGRhdGEuZ2FtZV9sZXZlbF9udW0sIHBhcnNlSW50KGopLCBkYXRhLnJlc19saXN0W2ldW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4ubGV2ZWxEb3duKGRhdGEuZ2FtZV9sZXZlbF9udW0sIHBhcnNlSW50KGopLCBkYXRhLnJlc19saXN0W2ldW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFkYXRhLnJlc19saXN0W2ldICYmIGRhdGEucmVzX2xpc3RbaV0ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uYXVkaW8ucGxheUxhbmRBdWRpbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMC43KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnNjaGVkdWxlT25jZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqIGluIGRhdGEud2luX3RlbXBfbGlzdFtpXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uZ2VtQm9vKGRhdGEud2luX3RlbXBfbGlzdFtpXVtqXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFkYXRhLndpbl90ZW1wX2xpc3RbaV0gJiYgZGF0YS53aW5fdGVtcF9saXN0W2ldLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLmF1ZGlvLnBsYXlCb28oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2NoZWR1bGVPbmNlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uY2xlYW5Cb28oZGF0YS5nYW1lX2xldmVsX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEuNik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgcGFyc2VJbnQoaSkgKiAxLjgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lTWFpbi5zY2hlZHVsZU9uY2UoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4udG1PZmZzZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc3RhcnRCdG4uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnR1b2d1YW4gJiYgIWRhdGEuaXNfYmlnX3dpbiAmJiB0aGlzLmdhbWVNYWluLnN0YXJ0R2FtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4ubGJsQ29pbi5zdHJpbmcgPSBIZWxwZXIuZml4TnVtKGRhdGEudXNlcl9nYW1lX2RpY3QuYmlnX3dpbl9zY29yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lTWFpbi5sYmxBbGxDb2luLnN0cmluZyA9IEhlbHBlci5maXhOdW0oZGF0YS51c2VyX3Njb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS51c2VyX2dhbWVfZGljdC5nYW1lX2xldmVsX251bSAhPSB0aGlzLmdhbWVNYWluLmxldmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2V0TGV2ZWwoZGF0YS51c2VyX2dhbWVfZGljdC5nYW1lX2xldmVsX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmlzX2JpZ193aW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZU1haW4udHVvZ3Vhbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lTWFpbi50dW9ndWFuID0gIXRoaXMuZ2FtZU1haW4udHVvZ3VhbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4udHVvZ3Vhbkxpc3RbMF0uYWN0aXZlID0gIXRoaXMuZ2FtZU1haW4udHVvZ3VhbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4udHVvZ3Vhbkxpc3RbMV0uYWN0aXZlID0gdGhpcy5nYW1lTWFpbi50dW9ndWFuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2V0Qm94KC4uLmRhdGEuYmlnX3dpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgZGF0YS5yZXNfbGlzdC5sZW5ndGggKiAxLjgpXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LlJlc3VsdENvZGUgPT0gLTIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4uc2hvd1RpcCgn5ri45oiP5biB5LiN6LazJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnN0YXJ0QnRuLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnRtT2Zmc2V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdhbWVNYWluLnR1b2d1YW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnR1b2d1YW4gPSAhdGhpcy5nYW1lTWFpbi50dW9ndWFuO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1haW4udHVvZ3Vhbkxpc3RbMF0uYWN0aXZlID0gIXRoaXMuZ2FtZU1haW4udHVvZ3VhbjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVNYWluLnR1b2d1YW5MaXN0WzFdLmFjdGl2ZSA9IHRoaXMuZ2FtZU1haW4udHVvZ3VhbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIGNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfSxcclxufSk7Il19