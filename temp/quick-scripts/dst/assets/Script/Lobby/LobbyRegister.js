
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Lobby/LobbyRegister.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '453819kLzdK24TFcgkLOwln', 'LobbyRegister');
// Script/Lobby/LobbyRegister.js

"use strict";

/**
 * 大厅用户注册管理类
 */
window.getUrlParas = function () {
  var theRequest = new Object();
  if (cc.sys.isNative) return theRequest;
  var neturl = window.location.href;
  var neturl = location.search;

  if (neturl.indexOf("?") != -1) {
    var str = neturl.substr(1);
    var strs = str.split("&");

    for (var i = 0; i < strs.length; i++) {
      theRequest[strs[i].split("=")[0]] = strs[i].split("=")[1];
    }
  }

  return theRequest;
};

cc.Class({
  "extends": cc.Component,
  properties: {},
  onLoad: function onLoad() {
    this.md5 = require("md5").getInstant;
    this.actType = ''; //口令

    this.token = '42dfcb34fb02d8cd';
    this.canLoign = false;
    this.account = null;
    this.password = null;
    this.messFire = onfire.on("onplatform_login", this.onPlatformLogin.bind(this)); //监听第三方相关事件
  },
  onPlatformLogin: function onPlatformLogin(acc, pwd) {
    this.mlapiRegister_Function_wx(acc, pwd);
  },
  onDestroy: function onDestroy() {
    onfire.un(this.messFire);
  },

  /**
   * 
   * @param {*} url 
   */
  checkAccount_Function: function checkAccount_Function(url) {
    var userData = null; //获取缓存中的用户数据

    if (cc.sys.isNative) {
      userData = JSON.parse(cc.sys.localStorage.getItem("userData"));
    } else {
      userData = JSON.parse(localStorage.getItem("userData"));
    }

    if (userData == null) {
      this.registerAccount_Function(url, true); //对苹果手机进行特殊处理

      if (cc.sys.os === cc.sys.OS_IOS) {
        jsb.reflection.callStaticMethod("RootViewController", "UserId:", this.getComponent("LobbyMain").playerInfo.playerId);
      }
    } else {
      //获取到缓存数据后，进行赋值
      this.account = userData.account;
      this.password = userData.password;
      this.canLoign = true; //通过缓存数据进行用户登录

      if (this.getComponent("LobbyMain").netWork.socket !== null) {
        this.getComponent("LobbyMain").netWork.socket.emit("login", {
          userName: this.account,
          password: this.password
        });
      }
    }
  },

  /**
   * 将用户数据写入缓存
   * @param {*} account 
   * @param {*} password 
   */
  changeUserData_Function: function changeUserData_Function(account, password) {
    var data = {
      account: account,
      password: password
    };
    this.writeUserDate_Function(data);
  },

  /**
   * 将用户数据写入缓存
   * @param {*} data 
   * @param {*} callback 
   */
  writeUserDate_Function: function writeUserDate_Function(data, callback) {
    if (cc.sys.isNative) {
      cc.sys.localStorage.setItem("userData", JSON.stringify(data));
    } else {
      localStorage.setItem("userData", JSON.stringify(data));
    }

    callback && callback();
  },

  /**
   * 注册游客，并进行登录
   * @param {*} url 
   * @param {*} isLogin 
   */
  registerAccount_Function: function registerAccount_Function(url, isLogin) {
    var self = this; //游客登录

    this.getAccount_Function(url, function (account, password) {
      var data = {
        account: account,
        password: password
      }; //将游客账号写入缓存中,并进行socket登录

      self.writeUserDate_Function(data, function () {
        self.account = data.account;
        self.password = data.password;
        self.canLoign = true; //是否socket登录

        if (isLogin) {
          self.getComponent("LobbyMain").netWork.socket.emit("login", {
            userName: self.account,
            password: self.password
          });
        } else {
          self.getComponent("LobbyMain").netWork.loginAccount_Function(self.getComponent("LobbyMain").playerInfo.loginIp, self.account, self.password);
        }
      });
    });
  },

  /**
   * 游客登录
   * @param {*} url 
   * @param {*} callback 
   */
  getAccount_Function: function getAccount_Function(url, callback) {
    this.actType = "getGuessA";
    var daili = this.node.getComponent("LobbyMain").playerInfo.guest;

    if (cc.sys.isNative) {
      if (this.getComponent("LobbyMain").playerInfo.iosChannel !== '') {
        daili = this.getComponent("LobbyMain").playerInfo.iosChannel;
      }
    } else {
      if (this.getUrlCode_Function("channel") !== null) {
        daili = this.getUrlCode_Function("channel");
      }
    }

    var time = parseInt(Date.parse(new Date()) / 1000);
    var sign = this.md5.hex_md5(this.actType + daili + time + this.token);
    var apiUrl = url + "/weixinLogin?act=" + this.actType + "&time=" + time + "&daili=" + daili + "&sign=" + sign;
    var xhr = new XMLHttpRequest();

    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
        var response = xhr.response;

        if (xhr.response !== null) {
          try {
            response = JSON.parse(response);
          } catch (error) {
            cc.log("JSON wrong");
          }

          callback && callback(response.data.account, response.data.password);
        }
      }
    };

    xhr.open("get", apiUrl);
    xhr.send();
  },

  /**
   * HTTP注册账号
   * @param {*} account 
   * @param {*} password 
   */
  mlapiRegister_Function: function mlapiRegister_Function(account, password) {
    this.actType = "register";
    var guest = this.node.getComponent("LobbyMain").playerInfo.guest;
    var time = parseInt(Date.parse(new Date()) / 1000);
    var sign = this.md5.hex_md5(this.actType + account + account + password + time + this.token);
    var url = this.node.getComponent("LobbyMain").playerInfo.loginIp;
    var apiUrl = url + "/ml_api?act=" + this.actType + "&accountname=" + account + "&nickname=" + account + "&pwd=" + password + "&time=" + time + "&agc=" + guest + "&sign=" + sign;
    cc.log('账号注册:' + apiUrl);
    this.mlapiRegisterAccount_Function(apiUrl, function (errormsg) {
      cc.log('注册返回信息=================================' + errormsg);

      switch (errormsg) {
        case 0:
          //注册成功
          this.node.getComponent("LobbyMain").netWork.accountChange = true;
          this.node.getComponent("LobbyMain").netWork.loginAccount_Function(this.node.getComponent("LobbyMain").playerInfo.loginIp, account, password);
          break;

        case 1:
          break;

        case 2:
          //注册失败，账号已存在
          this.node.getComponent("LobbyMain").com_Register.getChildByName("eb_Account").getComponent("cc.EditBox").string = "账号已存在";
          break;

        case 3:
          //注册失败，账号已存在
          this.node.getComponent("LobbyMain").com_Register.getChildByName("eb_Account").getComponent("cc.EditBox").string = "账号已存在";
          break;
      }
    }.bind(this));
  },
  mlapiRegister_Function_wx: function mlapiRegister_Function_wx(account, password) {
    this.actType = "register";
    var guest = this.node.getComponent("LobbyMain").playerInfo.guest;
    var time = parseInt(Date.parse(new Date()) / 1000);
    var sign = this.md5.hex_md5(this.actType + account + account + password + time + this.token);
    var url = this.node.getComponent("LobbyMain").playerInfo.loginIp;
    var apiUrl = "";
    var str_mix = "weixinLogin" + account + password + time + this.token;
    sign = this.md5.hex_md5(str_mix);
    apiUrl = url + "/weixinLogin?act=" + "weixinLogin" + "&accountname=" + account + "&nickname=" + window.platform_name + "&pwd=" + password + "&time=" + time + "&agc=" + guest + "&sign=" + sign;

    if (window.platform_head != undefined) {
      apiUrl += "&headimgurl=" + encodeURIComponent(window.platform_head);
    }

    apiUrl = "https://fangka.youmegame.cn/nxp.php?url=" + encodeURIComponent(apiUrl);
    window.global_post = true;
    var theRequest = window.getUrlParas();

    if (theRequest.aid) {
      apiUrl += "&aid=";
      apiUrl += theRequest.aid;
    }

    cc.log('账号注册:' + apiUrl);
    this.mlapiRegisterAccount_Function(apiUrl, function (errormsg) {
      cc.log('注册返回信息=================================' + errormsg);
      errormsg = parseInt(errormsg);

      switch (errormsg) {
        case 0:
          //注册成功
          this.node.getComponent("LobbyMain").netWork.accountChange = true;
          this.node.getComponent("LobbyMain").netWork.loginAccount_Function(this.node.getComponent("LobbyMain").playerInfo.loginIp, account, password);
          break;

        case 1:
          this.node.getComponent("LobbyMain").com_Register.getChildByName("eb_Account").getComponent("cc.EditBox").string = "信息错误或用户名重复";
          break;

        case 2:
          //注册失败，账号已存在
          this.node.getComponent("LobbyMain").com_Register.getChildByName("eb_Account").getComponent("cc.EditBox").string = "账号已存在";

          if (cc.sys.isNative) {
            this.node.getComponent("LobbyMain").netWork.loginAccount_Function(this.node.getComponent("LobbyMain").playerInfo.loginIp, account, password);
          }

          break;

        case 3:
          //注册失败，账号已存在
          this.node.getComponent("LobbyMain").com_Register.getChildByName("eb_Account").getComponent("cc.EditBox").string = "账号已存在";

          if (cc.sys.isNative) {
            this.node.getComponent("LobbyMain").netWork.loginAccount_Function(this.node.getComponent("LobbyMain").playerInfo.loginIp, account, password);
          }

          break;
      }
    }.bind(this));
  },

  /**
   * 发送HTTP注册请求
   * @param {*} url 
   * @param {*} callback 
   */
  mlapiRegisterAccount_Function: function mlapiRegisterAccount_Function(url, callback) {
    var xhr = new XMLHttpRequest();

    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
        var response = xhr.response;

        if (null !== xhr.response !== null) {
          try {
            response = JSON.parse(response);
          } catch (errot) {
            cc.log("JSON wrong");
          }

          callback && callback(response.status);
        }
      }
    };

    if (window.global_post) {
      window.global_post = false;
      xhr.open("post", url);
    } else {
      xhr.open("get", url);
    }

    xhr.send();
  },

  /**
   * 获取url参数
   * @param {*} name 
   */
  getUrlCode_Function: function getUrlCode_Function(name) {
    var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');
    var result = window.location.search.substr(1).match(reg);
    return result ? decodeURIComponent(result[2]) : null;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxMb2JieVxcTG9iYnlSZWdpc3Rlci5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJnZXRVcmxQYXJhcyIsInRoZVJlcXVlc3QiLCJPYmplY3QiLCJjYyIsInN5cyIsImlzTmF0aXZlIiwibmV0dXJsIiwibG9jYXRpb24iLCJocmVmIiwic2VhcmNoIiwiaW5kZXhPZiIsInN0ciIsInN1YnN0ciIsInN0cnMiLCJzcGxpdCIsImkiLCJsZW5ndGgiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJvbkxvYWQiLCJtZDUiLCJyZXF1aXJlIiwiZ2V0SW5zdGFudCIsImFjdFR5cGUiLCJ0b2tlbiIsImNhbkxvaWduIiwiYWNjb3VudCIsInBhc3N3b3JkIiwibWVzc0ZpcmUiLCJvbmZpcmUiLCJvbiIsIm9uUGxhdGZvcm1Mb2dpbiIsImJpbmQiLCJhY2MiLCJwd2QiLCJtbGFwaVJlZ2lzdGVyX0Z1bmN0aW9uX3d4Iiwib25EZXN0cm95IiwidW4iLCJjaGVja0FjY291bnRfRnVuY3Rpb24iLCJ1cmwiLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJyZWdpc3RlckFjY291bnRfRnVuY3Rpb24iLCJvcyIsIk9TX0lPUyIsImpzYiIsInJlZmxlY3Rpb24iLCJjYWxsU3RhdGljTWV0aG9kIiwiZ2V0Q29tcG9uZW50IiwicGxheWVySW5mbyIsInBsYXllcklkIiwibmV0V29yayIsInNvY2tldCIsImVtaXQiLCJ1c2VyTmFtZSIsImNoYW5nZVVzZXJEYXRhX0Z1bmN0aW9uIiwiZGF0YSIsIndyaXRlVXNlckRhdGVfRnVuY3Rpb24iLCJjYWxsYmFjayIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJpc0xvZ2luIiwic2VsZiIsImdldEFjY291bnRfRnVuY3Rpb24iLCJsb2dpbkFjY291bnRfRnVuY3Rpb24iLCJsb2dpbklwIiwiZGFpbGkiLCJub2RlIiwiZ3Vlc3QiLCJpb3NDaGFubmVsIiwiZ2V0VXJsQ29kZV9GdW5jdGlvbiIsInRpbWUiLCJwYXJzZUludCIsIkRhdGUiLCJzaWduIiwiaGV4X21kNSIsImFwaVVybCIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlIiwiZXJyb3IiLCJsb2ciLCJvcGVuIiwic2VuZCIsIm1sYXBpUmVnaXN0ZXJfRnVuY3Rpb24iLCJtbGFwaVJlZ2lzdGVyQWNjb3VudF9GdW5jdGlvbiIsImVycm9ybXNnIiwiYWNjb3VudENoYW5nZSIsImNvbV9SZWdpc3RlciIsImdldENoaWxkQnlOYW1lIiwic3RyaW5nIiwic3RyX21peCIsInBsYXRmb3JtX25hbWUiLCJwbGF0Zm9ybV9oZWFkIiwidW5kZWZpbmVkIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZ2xvYmFsX3Bvc3QiLCJhaWQiLCJlcnJvdCIsIm5hbWUiLCJyZWciLCJSZWdFeHAiLCJyZXN1bHQiLCJtYXRjaCIsImRlY29kZVVSSUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQUEsTUFBTSxDQUFDQyxXQUFQLEdBQXFCLFlBQ3JCO0FBQ0csTUFBSUMsVUFBVSxHQUFHLElBQUlDLE1BQUosRUFBakI7QUFDQSxNQUFJQyxFQUFFLENBQUNDLEdBQUgsQ0FBT0MsUUFBWCxFQUFxQixPQUFPSixVQUFQO0FBQ3JCLE1BQUlLLE1BQU0sR0FBQ1AsTUFBTSxDQUFDUSxRQUFQLENBQWdCQyxJQUEzQjtBQUNBLE1BQUlGLE1BQU0sR0FBR0MsUUFBUSxDQUFDRSxNQUF0Qjs7QUFDQSxNQUFJSCxNQUFNLENBQUNJLE9BQVAsQ0FBZSxHQUFmLEtBQXVCLENBQUMsQ0FBNUIsRUFBK0I7QUFDM0IsUUFBSUMsR0FBRyxHQUFHTCxNQUFNLENBQUNNLE1BQVAsQ0FBYyxDQUFkLENBQVY7QUFDQSxRQUFJQyxJQUFJLEdBQUdGLEdBQUcsQ0FBQ0csS0FBSixDQUFVLEdBQVYsQ0FBWDs7QUFDQSxT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QVQsRUFBaUJqRCxHQUFqQjtBQUNILEtBSkQsTUFJSztBQUNHeUMsTUFBQUEsR0FBRyxDQUFDUSxJQUFKLENBQVMsS0FBVCxFQUFnQmpELEdBQWhCO0FBQ1A7O0FBQ0R5QyxJQUFBQSxHQUFHLENBQUNTLElBQUo7QUFDSCxHQWhUSTs7QUFrVEw7QUFDSjtBQUNBO0FBQ0E7QUFDSWhCLEVBQUFBLG1CQUFtQixFQUFFLDZCQUFVZ0MsSUFBVixFQUFnQjtBQUNqQyxRQUFJQyxHQUFHLEdBQUcsSUFBSUMsTUFBSixDQUFXLFVBQVVGLElBQVYsR0FBaUIsZUFBNUIsQ0FBVjtBQUNBLFFBQUlHLE1BQU0sR0FBRzlHLE1BQU0sQ0FBQ1EsUUFBUCxDQUFnQkUsTUFBaEIsQ0FBdUJHLE1BQXZCLENBQThCLENBQTlCLEVBQWlDa0csS0FBakMsQ0FBdUNILEdBQXZDLENBQWI7QUFDQSxXQUFPRSxNQUFNLEdBQUdFLGtCQUFrQixDQUFDRixNQUFNLENBQUMsQ0FBRCxDQUFQLENBQXJCLEdBQW1DLElBQWhEO0FBQ0g7QUExVEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOWkp+WOheeUqOaIt+azqOWGjOeuoeeQhuexu1xyXG4gKi9cclxud2luZG93LmdldFVybFBhcmFzID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgIHZhciB0aGVSZXF1ZXN0ID0gbmV3IE9iamVjdCgpO1xyXG4gICBpZiAoY2Muc3lzLmlzTmF0aXZlKSByZXR1cm4gdGhlUmVxdWVzdDtcclxuICAgdmFyIG5ldHVybD13aW5kb3cubG9jYXRpb24uaHJlZjsgIFxyXG4gICB2YXIgbmV0dXJsID0gbG9jYXRpb24uc2VhcmNoO1xyXG4gICBpZiAobmV0dXJsLmluZGV4T2YoXCI/XCIpICE9IC0xKSB7XHJcbiAgICAgICB2YXIgc3RyID0gbmV0dXJsLnN1YnN0cigxKTtcclxuICAgICAgIHZhciBzdHJzID0gc3RyLnNwbGl0KFwiJlwiKTtcclxuICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzdHJzLmxlbmd0aDsgaSArKykge1xyXG4gICAgICAgICAgIHRoZVJlcXVlc3Rbc3Ryc1tpXS5zcGxpdChcIj1cIilbMF1dPShzdHJzW2ldLnNwbGl0KFwiPVwiKVsxXSk7XHJcbiAgICAgICB9XHJcbiAgIH1cclxuICAgcmV0dXJuIHRoZVJlcXVlc3Q7XHJcbn1cclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tZDUgPSByZXF1aXJlKFwibWQ1XCIpLmdldEluc3RhbnQ7XHJcbiAgICAgICAgdGhpcy5hY3RUeXBlID0gJyc7XHJcbiAgICAgICAgLy/lj6Pku6RcclxuICAgICAgICB0aGlzLnRva2VuID0gJzQyZGZjYjM0ZmIwMmQ4Y2QnO1xyXG4gICAgICAgIHRoaXMuY2FuTG9pZ24gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFjY291bnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucGFzc3dvcmQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLm1lc3NGaXJlID0gb25maXJlLm9uKFwib25wbGF0Zm9ybV9sb2dpblwiLCB0aGlzLm9uUGxhdGZvcm1Mb2dpbi5iaW5kKHRoaXMpKTsgLy/nm5HlkKznrKzkuInmlrnnm7jlhbPkuovku7ZcclxuICAgIH0sXHJcblxyXG4gICAgb25QbGF0Zm9ybUxvZ2luKGFjYywgcHdkKSB7XHJcbiAgICAgICAgdGhpcy5tbGFwaVJlZ2lzdGVyX0Z1bmN0aW9uX3d4KGFjYywgcHdkKTtcclxuICAgIH0sXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBvbmZpcmUudW4odGhpcy5tZXNzRmlyZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0geyp9IHVybCBcclxuICAgICAqL1xyXG4gICAgY2hlY2tBY2NvdW50X0Z1bmN0aW9uOiBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIHVzZXJEYXRhID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy/ojrflj5bnvJPlrZjkuK3nmoTnlKjmiLfmlbDmja5cclxuICAgICAgICBpZihjYy5zeXMuaXNOYXRpdmUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB1c2VyRGF0YSA9IEpTT04ucGFyc2UoY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlckRhdGFcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB1c2VyRGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyRGF0YVwiKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih1c2VyRGF0YSA9PSBudWxsKVxyXG4gICAgICAgIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJBY2NvdW50X0Z1bmN0aW9uKHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIC8v5a+56Iu55p6c5omL5py66L+b6KGM54m55q6K5aSE55CGXHJcbiAgICAgICAgICAgIGlmKGNjLnN5cy5vcyA9PT0gY2Muc3lzLk9TX0lPUylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIlJvb3RWaWV3Q29udHJvbGxlclwiLCBcIlVzZXJJZDpcIiwgdGhpcy5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikucGxheWVySW5mby5wbGF5ZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy/ojrflj5bliLDnvJPlrZjmlbDmja7lkI7vvIzov5vooYzotYvlgLxcclxuICAgICAgICAgICAgdGhpcy5hY2NvdW50ID0gdXNlckRhdGEuYWNjb3VudDtcclxuICAgICAgICAgICAgdGhpcy5wYXNzd29yZCA9IHVzZXJEYXRhLnBhc3N3b3JkO1xyXG4gICAgICAgICAgICB0aGlzLmNhbkxvaWduID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy/pgJrov4fnvJPlrZjmlbDmja7ov5vooYznlKjmiLfnmbvlvZVcclxuICAgICAgICAgICAgaWYodGhpcy5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikubmV0V29yay5zb2NrZXQgIT09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLm5ldFdvcmsuc29ja2V0LmVtaXQoXCJsb2dpblwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlck5hbWU6IHRoaXMuYWNjb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5wYXNzd29yZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bCG55So5oi35pWw5o2u5YaZ5YWl57yT5a2YXHJcbiAgICAgKiBAcGFyYW0geyp9IGFjY291bnQgXHJcbiAgICAgKiBAcGFyYW0geyp9IHBhc3N3b3JkIFxyXG4gICAgICovXHJcbiAgICBjaGFuZ2VVc2VyRGF0YV9GdW5jdGlvbjogZnVuY3Rpb24gKGFjY291bnQsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGFjY291bnQsXHJcbiAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy53cml0ZVVzZXJEYXRlX0Z1bmN0aW9uKGRhdGEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhueUqOaIt+aVsOaNruWGmeWFpee8k+WtmFxyXG4gICAgICogQHBhcmFtIHsqfSBkYXRhIFxyXG4gICAgICogQHBhcmFtIHsqfSBjYWxsYmFjayBcclxuICAgICAqL1xyXG4gICAgd3JpdGVVc2VyRGF0ZV9GdW5jdGlvbjogZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ1c2VyRGF0YVwiLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInVzZXJEYXRhXCIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozmuLjlrqLvvIzlubbov5vooYznmbvlvZVcclxuICAgICAqIEBwYXJhbSB7Kn0gdXJsIFxyXG4gICAgICogQHBhcmFtIHsqfSBpc0xvZ2luIFxyXG4gICAgICovXHJcbiAgICByZWdpc3RlckFjY291bnRfRnVuY3Rpb246IGZ1bmN0aW9uICh1cmwsIGlzTG9naW4pIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy/muLjlrqLnmbvlvZVcclxuICAgICAgICB0aGlzLmdldEFjY291bnRfRnVuY3Rpb24odXJsLCBmdW5jdGlvbiAoYWNjb3VudCwgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8v5bCG5ri45a6i6LSm5Y+35YaZ5YWl57yT5a2Y5LitLOW5tui/m+ihjHNvY2tldOeZu+W9lVxyXG4gICAgICAgICAgICBzZWxmLndyaXRlVXNlckRhdGVfRnVuY3Rpb24oZGF0YSwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuYWNjb3VudCA9IGRhdGEuYWNjb3VudDtcclxuICAgICAgICAgICAgICAgIHNlbGYucGFzc3dvcmQgPSBkYXRhLnBhc3N3b3JkO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jYW5Mb2lnbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvL+aYr+WQpnNvY2tldOeZu+W9lVxyXG4gICAgICAgICAgICAgICAgaWYgKGlzTG9naW4pIFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLm5ldFdvcmsuc29ja2V0LmVtaXQoXCJsb2dpblwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiBzZWxmLmFjY291bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBzZWxmLnBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5uZXRXb3JrLmxvZ2luQWNjb3VudF9GdW5jdGlvbihzZWxmLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmxvZ2luSXAsIHNlbGYuYWNjb3VudCwgc2VsZi5wYXNzd29yZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmuLjlrqLnmbvlvZVcclxuICAgICAqIEBwYXJhbSB7Kn0gdXJsIFxyXG4gICAgICogQHBhcmFtIHsqfSBjYWxsYmFjayBcclxuICAgICAqL1xyXG4gICAgZ2V0QWNjb3VudF9GdW5jdGlvbjogZnVuY3Rpb24gKHVybCwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmFjdFR5cGUgPSBcImdldEd1ZXNzQVwiO1xyXG4gICAgICAgIHZhciBkYWlsaSA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikucGxheWVySW5mby5ndWVzdDtcclxuICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmlvc0NoYW5uZWwgIT09ICcnKSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZGFpbGkgPSB0aGlzLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmlvc0NoYW5uZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZ2V0VXJsQ29kZV9GdW5jdGlvbihcImNoYW5uZWxcIikgIT09IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRhaWxpID0gdGhpcy5nZXRVcmxDb2RlX0Z1bmN0aW9uKFwiY2hhbm5lbFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRpbWUgPSBwYXJzZUludChEYXRlLnBhcnNlKG5ldyBEYXRlKSAvIDEwMDApO1xyXG4gICAgICAgIHZhciBzaWduID0gdGhpcy5tZDUuaGV4X21kNSh0aGlzLmFjdFR5cGUgKyBkYWlsaSArIHRpbWUgKyB0aGlzLnRva2VuKTtcclxuICAgICAgICB2YXIgYXBpVXJsID0gdXJsICsgXCIvd2VpeGluTG9naW4/YWN0PVwiICsgdGhpcy5hY3RUeXBlICsgXCImdGltZT1cIiArIHRpbWUgKyBcIiZkYWlsaT1cIiArIGRhaWxpICsgXCImc2lnbj1cIiArIHNpZ247XHJcbiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG5cclxuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQgJiYgeGhyLnN0YXR1cyA9PT0gMjAwKSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0geGhyLnJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZSAhPT0gbnVsbCkgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSBcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcIkpTT04gd3JvbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEuYWNjb3VudCwgcmVzcG9uc2UuZGF0YS5wYXNzd29yZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHhoci5vcGVuKFwiZ2V0XCIsIGFwaVVybCk7XHJcbiAgICAgICAgeGhyLnNlbmQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIVFRQ5rOo5YaM6LSm5Y+3XHJcbiAgICAgKiBAcGFyYW0geyp9IGFjY291bnQgXHJcbiAgICAgKiBAcGFyYW0geyp9IHBhc3N3b3JkIFxyXG4gICAgICovXHJcbiAgICBtbGFwaVJlZ2lzdGVyX0Z1bmN0aW9uOiBmdW5jdGlvbiAoYWNjb3VudCwgcGFzc3dvcmQpIHtcclxuICAgICAgICB0aGlzLmFjdFR5cGUgPSBcInJlZ2lzdGVyXCI7XHJcbiAgICAgICAgdmFyIGd1ZXN0ID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmd1ZXN0O1xyXG4gICAgICAgIHZhciB0aW1lID0gcGFyc2VJbnQoRGF0ZS5wYXJzZShuZXcgRGF0ZSkgLyAxMDAwKTtcclxuICAgICAgICB2YXIgc2lnbiA9IHRoaXMubWQ1LmhleF9tZDUodGhpcy5hY3RUeXBlICsgYWNjb3VudCArIGFjY291bnQgKyBwYXNzd29yZCArIHRpbWUgKyB0aGlzLnRva2VuKTtcclxuICAgICAgICB2YXIgdXJsID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmxvZ2luSXA7XHJcbiAgICAgICAgdmFyIGFwaVVybCA9IHVybCArIFwiL21sX2FwaT9hY3Q9XCIgKyB0aGlzLmFjdFR5cGUgKyBcIiZhY2NvdW50bmFtZT1cIiArIGFjY291bnQgKyBcIiZuaWNrbmFtZT1cIiArIGFjY291bnQgKyBcIiZwd2Q9XCIgKyBwYXNzd29yZCArIFwiJnRpbWU9XCIgKyB0aW1lICsgXCImYWdjPVwiICsgZ3Vlc3QgKyBcIiZzaWduPVwiICsgc2lnbjtcclxuICAgICAgICBjYy5sb2coJ+i0puWPt+azqOWGjDonICsgYXBpVXJsKTtcclxuICAgICAgICB0aGlzLm1sYXBpUmVnaXN0ZXJBY2NvdW50X0Z1bmN0aW9uKGFwaVVybCwgZnVuY3Rpb24gKGVycm9ybXNnKSB7XHJcbiAgICAgICAgICAgIGNjLmxvZygn5rOo5YaM6L+U5Zue5L+h5oGvPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09JyArIGVycm9ybXNnKTtcclxuICAgICAgICAgICAgc3dpdGNoIChlcnJvcm1zZykge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOi8v5rOo5YaM5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5uZXRXb3JrLmFjY291bnRDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikubmV0V29yay5sb2dpbkFjY291bnRfRnVuY3Rpb24odGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5wbGF5ZXJJbmZvLmxvZ2luSXAsIGFjY291bnQsIHBhc3N3b3JkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjovL+azqOWGjOWksei0pe+8jOi0puWPt+W3suWtmOWcqFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1JlZ2lzdGVyLmdldENoaWxkQnlOYW1lKFwiZWJfQWNjb3VudFwiKS5nZXRDb21wb25lbnQoXCJjYy5FZGl0Qm94XCIpLnN0cmluZyA9IFwi6LSm5Y+35bey5a2Y5ZyoXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6Ly/ms6jlhozlpLHotKXvvIzotKblj7flt7LlrZjlnKhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9SZWdpc3Rlci5nZXRDaGlsZEJ5TmFtZShcImViX0FjY291bnRcIikuZ2V0Q29tcG9uZW50KFwiY2MuRWRpdEJveFwiKS5zdHJpbmcgPSBcIui0puWPt+W3suWtmOWcqFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIFxyXG4gICAgbWxhcGlSZWdpc3Rlcl9GdW5jdGlvbl93eDogZnVuY3Rpb24gKGFjY291bnQsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgdGhpcy5hY3RUeXBlID0gXCJyZWdpc3RlclwiO1xyXG4gICAgICAgIHZhciBndWVzdCA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikucGxheWVySW5mby5ndWVzdDtcclxuICAgICAgICB2YXIgdGltZSA9IHBhcnNlSW50KERhdGUucGFyc2UobmV3IERhdGUpIC8gMTAwMCk7XHJcbiAgICAgICAgdmFyIHNpZ24gPSB0aGlzLm1kNS5oZXhfbWQ1KHRoaXMuYWN0VHlwZSArIGFjY291bnQgKyBhY2NvdW50ICsgcGFzc3dvcmQgKyB0aW1lICsgdGhpcy50b2tlbik7XHJcbiAgICAgICAgdmFyIHVybCA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikucGxheWVySW5mby5sb2dpbklwO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBhcGlVcmwgPSBcIlwiO1xyXG5cclxuICAgICAgICB2YXIgc3RyX21peCA9IFwid2VpeGluTG9naW5cIiArIGFjY291bnQgKyBwYXNzd29yZCArIHRpbWUgKyB0aGlzLnRva2VuO1xyXG4gICAgICAgIHNpZ24gPSB0aGlzLm1kNS5oZXhfbWQ1KHN0cl9taXgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGFwaVVybCA9IHVybCArIFwiL3dlaXhpbkxvZ2luP2FjdD1cIiArIFwid2VpeGluTG9naW5cIiArIFwiJmFjY291bnRuYW1lPVwiICsgYWNjb3VudCArIFwiJm5pY2tuYW1lPVwiICsgd2luZG93LnBsYXRmb3JtX25hbWUgKyBcIiZwd2Q9XCIgKyBwYXNzd29yZCArIFwiJnRpbWU9XCIgKyB0aW1lICsgXCImYWdjPVwiICsgZ3Vlc3QgKyBcIiZzaWduPVwiICsgc2lnbjtcclxuICAgICAgICBpZiAod2luZG93LnBsYXRmb3JtX2hlYWQgIT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYXBpVXJsKz1cIiZoZWFkaW1ndXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5wbGF0Zm9ybV9oZWFkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFwaVVybCA9IFwiaHR0cHM6Ly9mYW5na2EueW91bWVnYW1lLmNuL254cC5waHA/dXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGFwaVVybCk7XHJcbiAgICAgICAgd2luZG93Lmdsb2JhbF9wb3N0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdmFyIHRoZVJlcXVlc3QgPSB3aW5kb3cuZ2V0VXJsUGFyYXMoKTtcclxuICAgICAgICBpZiAodGhlUmVxdWVzdC5haWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBhcGlVcmwrPVwiJmFpZD1cIjtcclxuICAgICAgICAgICAgYXBpVXJsKz10aGVSZXF1ZXN0LmFpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY2MubG9nKCfotKblj7fms6jlhow6JyArIGFwaVVybCk7XHJcbiAgICAgICAgdGhpcy5tbGFwaVJlZ2lzdGVyQWNjb3VudF9GdW5jdGlvbihhcGlVcmwsIGZ1bmN0aW9uIChlcnJvcm1zZykge1xyXG4gICAgICAgICAgICBjYy5sb2coJ+azqOWGjOi/lOWbnuS/oeaBrz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScgKyBlcnJvcm1zZyk7XHJcbiAgICAgICAgICAgIGVycm9ybXNnID0gcGFyc2VJbnQoZXJyb3Jtc2cpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGVycm9ybXNnKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6Ly/ms6jlhozmiJDlip9cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLm5ldFdvcmsuYWNjb3VudENoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5uZXRXb3JrLmxvZ2luQWNjb3VudF9GdW5jdGlvbih0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLnBsYXllckluZm8ubG9naW5JcCwgYWNjb3VudCwgcGFzc3dvcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikuY29tX1JlZ2lzdGVyLmdldENoaWxkQnlOYW1lKFwiZWJfQWNjb3VudFwiKS5nZXRDb21wb25lbnQoXCJjYy5FZGl0Qm94XCIpLnN0cmluZyA9IFwi5L+h5oGv6ZSZ6K+v5oiW55So5oi35ZCN6YeN5aSNXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6Ly/ms6jlhozlpLHotKXvvIzotKblj7flt7LlrZjlnKhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLmNvbV9SZWdpc3Rlci5nZXRDaGlsZEJ5TmFtZShcImViX0FjY291bnRcIikuZ2V0Q29tcG9uZW50KFwiY2MuRWRpdEJveFwiKS5zdHJpbmcgPSBcIui0puWPt+W3suWtmOWcqFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLm5ldFdvcmsubG9naW5BY2NvdW50X0Z1bmN0aW9uKHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJMb2JieU1haW5cIikucGxheWVySW5mby5sb2dpbklwLCBhY2NvdW50LCBwYXNzd29yZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOi8v5rOo5YaM5aSx6LSl77yM6LSm5Y+35bey5a2Y5ZyoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5jb21fUmVnaXN0ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJlYl9BY2NvdW50XCIpLmdldENvbXBvbmVudChcImNjLkVkaXRCb3hcIikuc3RyaW5nID0gXCLotKblj7flt7LlrZjlnKhcIjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcIkxvYmJ5TWFpblwiKS5uZXRXb3JrLmxvZ2luQWNjb3VudF9GdW5jdGlvbih0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiTG9iYnlNYWluXCIpLnBsYXllckluZm8ubG9naW5JcCwgYWNjb3VudCwgcGFzc3dvcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y+R6YCBSFRUUOazqOWGjOivt+axglxyXG4gICAgICogQHBhcmFtIHsqfSB1cmwgXHJcbiAgICAgKiBAcGFyYW0geyp9IGNhbGxiYWNrIFxyXG4gICAgICovXHJcbiAgICBtbGFwaVJlZ2lzdGVyQWNjb3VudF9GdW5jdGlvbjogZnVuY3Rpb24gKHVybCwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0ICYmIHhoci5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0geGhyLnJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IHhoci5yZXNwb25zZSAhPT0gbnVsbCkgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm90KSBcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcIkpTT04gd3JvbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKHJlc3BvbnNlLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh3aW5kb3cuZ2xvYmFsX3Bvc3QpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB3aW5kb3cuZ2xvYmFsX3Bvc3QgPSBmYWxzZTtcclxuICAgICAgICAgICAgeGhyLm9wZW4oXCJwb3N0XCIsIHVybCk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB4aHIub3BlbihcImdldFwiLCB1cmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlnVybOWPguaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBuYW1lIFxyXG4gICAgICovXHJcbiAgICBnZXRVcmxDb2RlX0Z1bmN0aW9uOiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCcoXnwmKScgKyBuYW1lICsgJz0oW14mXSopKCZ8JCknKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0ID8gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdFsyXSkgOiBudWxsO1xyXG4gICAgfVxyXG59KTtcclxuIl19