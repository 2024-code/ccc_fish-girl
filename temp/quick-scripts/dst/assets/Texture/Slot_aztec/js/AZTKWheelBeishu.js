
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Texture/Slot_aztec/js/AZTKWheelBeishu.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '880d7emZC5GsKeqbwvVzq3B', 'AZTKWheelBeishu');
// Texture/Slot_aztec/js/AZTKWheelBeishu.js

"use strict";

var ROLENUM = 40; //每一轮的角色数量

var TIMEMIN = 1; //第一轮摇奖时间

cc.Class({
  "extends": cc.Component,
  properties: {
    wheelId: 0,
    excludeId: {
      "default": 0,
      displayName: '不会出现的数字id'
    }
  },
  onLoad: function onLoad() {
    this.audio = cc.director.getScene().getChildByName('Canvas').getComponent('AZTKAudio');
    this.mainObj = cc.director.getScene().getChildByName('Canvas').getComponent('AZTKMain');
    this.mainObj.wheelList[this.wheelId] = this;
    this.status = 0; //0停止 1转 

    this.lastResult = [0, 0, 0, 0, 0]; //中间一位是上一局结果 其余是为了防止露出部分转起来不一样 

    this.rolePbList = []; //roles

    this.roleIdList = []; //role ID
  },
  start: function start() {
    //初始化场景role
    this.initWheel();
  },
  initWheel: function initWheel() {
    this.rolePbList = [];
    this.roleIdList = [];
    this.node.removeAllChildren();

    for (var i in this.lastResult) {
      this.lastResult[i] = this.getRandomId();
      this.addRole(this.lastResult[i]);
    }

    this.addRole(this.getRandomId());
    this.node.y = -100;
    this.mainObj.rollIndex++;
    this.mainObj.closeShine();
  },
  startRoll: function startRoll(args) {
    var _this = this;

    this.status = 1;
    this.rolePbList = [];
    this.roleIdList = [];
    this.node.removeAllChildren();
    this.node.y = -100; //滚轮启动位移距离

    for (var i in this.lastResult) {
      this.lastResult[i] = this.lastResult[i] == 0 ? this.getRandomId() : this.lastResult[i];
      this.addRole(this.lastResult[i]);
    }

    for (var _i = 0; _i < ROLENUM - 12; _i++) {
      this.addRole(this.getRandomId());
    }

    this.addRole(this.getRandomId());
    var indexArray = [0, 1, 2, 3, 5, 10, 15];

    for (var _i2 = 0; _i2 < indexArray.length; _i2++) {
      if (indexArray[_i2] == args) {
        this.addRole(_i2);
        break;
      }
    }

    this.addRole(this.getRandomId());
    this.addRole(this.getRandomId());
    setTimeout(function () {
      var timer = TIMEMIN + _this.wheelId * 0.2;
      timer = !_this.mainObj.auto ? TIMEMIN : timer;

      _this.node.runAction(cc.sequence(cc.delayTime(0.2), cc.moveTo(timer, cc.v2(_this.node.x, -_this.node.height + 595)), cc.moveTo(0.1, cc.v2(_this.node.x, -_this.node.height + 650)), cc.moveTo(0.1, cc.v2(_this.node.x, -_this.node.height + 595)), cc.callFunc(_this.rollCallBack.bind(_this))));
    }, 100);
  },
  getRandomId: function getRandomId() {
    var randomId = 0;

    while (randomId == 0) {
      randomId = Math.floor(Math.random() * (this.mainObj.roleBeishuPb.length - 1) + 1);
      randomId = randomId == this.excludeId ? 0 : randomId;
    }

    ;
    return randomId;
  },
  addRole: function addRole(id) {
    var pb = cc.instantiate(this.mainObj.roleBeishuPb[id]);
    this.rolePbList.push(pb);
    this.roleIdList.push(id);
    this.node.addChild(pb);
  },
  rollCallBack: function rollCallBack() {
    this.audio.playStopWheel();
    this.lastResult = this.roleIdList.slice(-4);
    this.status = 0;
    this.mainObj.stateCallBack();
  },
  stopImmediately: function stopImmediately() {
    var _this2 = this;

    this.lastResult = this.roleIdList.slice(-4);
    this.node.stopAllActions();
    setTimeout(function () {
      _this2.node.y = -_this2.node.height + 595;
    }, 50);
    this.status = 0;
    this.mainObj.stateCallBack();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcVGV4dHVyZVxcU2xvdF9henRlY1xcanNcXEFaVEtXaGVlbEJlaXNodS5qcyJdLCJuYW1lcyI6WyJST0xFTlVNIiwiVElNRU1JTiIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwid2hlZWxJZCIsImV4Y2x1ZGVJZCIsImRpc3BsYXlOYW1lIiwib25Mb2FkIiwiYXVkaW8iLCJkaXJlY3RvciIsImdldFNjZW5lIiwiZ2V0Q2hpbGRCeU5hbWUiLCJnZXRDb21wb25lbnQiLCJtYWluT2JqIiwid2hlZWxMaXN0Iiwic3RhdHVzIiwibGFzdFJlc3VsdCIsInJvbGVQYkxpc3QiLCJyb2xlSWRMaXN0Iiwic3RhcnQiLCJpbml0V2hlZWwiLCJub2RlIiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJpIiwiZ2V0UmFuZG9tSWQiLCJhZGRSb2xlIiwieSIsInJvbGxJbmRleCIsImNsb3NlU2hpbmUiLCJzdGFydFJvbGwiLCJhcmdzIiwiaW5kZXhBcnJheSIsImxlbmd0aCIsInNldFRpbWVvdXQiLCJ0aW1lciIsImF1dG8iLCJydW5BY3Rpb24iLCJzZXF1ZW5jZSIsImRlbGF5VGltZSIsIm1vdmVUbyIsInYyIiwieCIsImhlaWdodCIsImNhbGxGdW5jIiwicm9sbENhbGxCYWNrIiwiYmluZCIsInJhbmRvbUlkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicm9sZUJlaXNodVBiIiwiaWQiLCJwYiIsImluc3RhbnRpYXRlIiwicHVzaCIsImFkZENoaWxkIiwicGxheVN0b3BXaGVlbCIsInNsaWNlIiwic3RhdGVDYWxsQmFjayIsInN0b3BJbW1lZGlhdGVseSIsInN0b3BBbGxBY3Rpb25zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLE9BQU8sR0FBRyxFQUFoQixFQUFvQjs7QUFDcEIsSUFBTUMsT0FBTyxHQUFHLENBQWhCLEVBQW1COztBQUVuQkMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFF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V2dELGFBQVg7QUFDQSxTQUFLeEMsVUFBTCxHQUFrQixLQUFLRSxVQUFMLENBQWdCdUMsS0FBaEIsQ0FBc0IsQ0FBQyxDQUF2QixDQUFsQjtBQUNBLFNBQUsxQyxNQUFMLEdBQWMsQ0FBZDtBQUNBLFNBQUtGLE9BQUwsQ0FBYTZDLGFBQWI7QUFDSCxHQW5HSTtBQXFHTEMsRUFBQUEsZUFyR0ssNkJBcUdhO0FBQUE7O0FBQ2QsU0FBSzNDLFVBQUwsR0FBa0IsS0FBS0UsVUFBTCxDQUFnQnVDLEtBQWhCLENBQXNCLENBQUMsQ0FBdkIsQ0FBbEI7QUFDQSxTQUFLcEMsSUFBTCxDQUFVdUMsY0FBVjtBQUNBM0IsSUFBQUEsVUFBVSxDQUFDLFlBQU07QUFDYixNQUFBLE1BQUksQ0FBQ1osSUFBTCxDQUFVSyxDQUFWLEdBQWMsQ0FBQyxNQUFJLENBQUNMLElBQUwsQ0FBVXFCLE1BQVgsR0FBb0IsR0FBbEM7QUFDSCxLQUZTLEVBRVAsRUFGTyxDQUFWO0FBR0EsU0FBSzNCLE1BQUwsR0FBYyxDQUFkO0FBQ0EsU0FBS0YsT0FBTCxDQUFhNkMsYUFBYjtBQUNIO0FBN0dJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJPTEVOVU0gPSA0MDsgLy/mr4/kuIDova7nmoTop5LoibLmlbDph49cclxuY29uc3QgVElNRU1JTiA9IDE7IC8v56ys5LiA6L2u5pGH5aWW5pe26Ze0XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHdoZWVsSWQ6IDAsXHJcbiAgICAgICAgZXhjbHVkZUlkOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IDAsXHJcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAn5LiN5Lya5Ye6546w55qE5pWw5a2XaWQnLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLmF1ZGlvID0gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKS5nZXRDaGlsZEJ5TmFtZSgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdBWlRLQXVkaW8nKTtcclxuICAgICAgICB0aGlzLm1haW5PYmogPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpLmdldENoaWxkQnlOYW1lKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ0FaVEtNYWluJyk7XHJcbiAgICAgICAgdGhpcy5tYWluT2JqLndoZWVsTGlzdFt0aGlzLndoZWVsSWRdID0gdGhpcztcclxuICAgICAgICB0aGlzLnN0YXR1cyA9IDA7IC8vMOWBnOatoiAx6L2sIFxyXG4gICAgICAgIHRoaXMubGFzdFJlc3VsdCA9IFswLCAwLCAwLCAwLCAwXTsgLy/kuK3pl7TkuIDkvY3mmK/kuIrkuIDlsYDnu5Pmnpwg5YW25L2Z5piv5Li65LqG6Ziy5q2i6Zyy5Ye66YOo5YiG6L2s6LW35p2l5LiN5LiA5qC3IFxyXG4gICAgICAgIHRoaXMucm9sZVBiTGlzdCA9IFtdOyAvL3JvbGVzXHJcbiAgICAgICAgdGhpcy5yb2xlSWRMaXN0ID0gW107IC8vcm9sZSBJRFxyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICAvL+WIneWni+WMluWcuuaZr3JvbGVcclxuICAgICAgICB0aGlzLmluaXRXaGVlbCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbml0V2hlZWwoKSB7XHJcbiAgICAgICAgdGhpcy5yb2xlUGJMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5yb2xlSWRMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLmxhc3RSZXN1bHQpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVzdWx0W2ldID0gdGhpcy5nZXRSYW5kb21JZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmFkZFJvbGUodGhpcy5sYXN0UmVzdWx0W2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRSb2xlKHRoaXMuZ2V0UmFuZG9tSWQoKSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLnkgPSAtMTAwOyAgXHJcbiAgICAgICAgdGhpcy5tYWluT2JqLnJvbGxJbmRleCsrO1xyXG4gICAgICAgIHRoaXMubWFpbk9iai5jbG9zZVNoaW5lKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0Um9sbChhcmdzKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAxO1xyXG4gICAgICAgIHRoaXMucm9sZVBiTGlzdCA9IFtdO1xyXG4gICAgICAgIHRoaXMucm9sZUlkTGlzdCA9IFtdO1xyXG4gICAgICAgIHRoaXMubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIHRoaXMubm9kZS55ID0gLTEwMDsgLy/mu5rova7lkK/liqjkvY3np7vot53nprtcclxuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMubGFzdFJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZXN1bHRbaV0gPSB0aGlzLmxhc3RSZXN1bHRbaV0gPT0gMCA/IHRoaXMuZ2V0UmFuZG9tSWQoKSA6IHRoaXMubGFzdFJlc3VsdFtpXTtcclxuICAgICAgICAgICAgdGhpcy5hZGRSb2xlKHRoaXMubGFzdFJlc3VsdFtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgUk9MRU5VTSAtIDEyOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5hZGRSb2xlKHRoaXMuZ2V0UmFuZG9tSWQoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWRkUm9sZSh0aGlzLmdldFJhbmRvbUlkKCkpO1xyXG4gICAgICAgIGxldCBpbmRleEFycmF5ID0gWzAsIDEsIDIsIDMsIDUsIDEwLCAxNV07XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRleEFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpbmRleEFycmF5W2ldID09IGFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkUm9sZShpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWRkUm9sZSh0aGlzLmdldFJhbmRvbUlkKCkpO1xyXG4gICAgICAgIHRoaXMuYWRkUm9sZSh0aGlzLmdldFJhbmRvbUlkKCkpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGltZXIgPSBUSU1FTUlOICsgdGhpcy53aGVlbElkICogMC4yO1xyXG4gICAgICAgICAgICB0aW1lciA9ICF0aGlzLm1haW5PYmouYXV0byA/IFRJTUVNSU4gOiB0aW1lcjtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihcclxuICAgICAgICAgICAgICAgIGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICAgICAgICAgIGNjLmRlbGF5VGltZSgwLjIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNjLm1vdmVUbyh0aW1lciwgY2MudjIodGhpcy5ub2RlLngsIC10aGlzLm5vZGUuaGVpZ2h0ICsgNTk1KSksXHJcbiAgICAgICAgICAgICAgICAgICAgY2MubW92ZVRvKDAuMSwgY2MudjIodGhpcy5ub2RlLngsIC10aGlzLm5vZGUuaGVpZ2h0ICsgNjUwKSksXHJcbiAgICAgICAgICAgICAgICAgICAgY2MubW92ZVRvKDAuMSwgY2MudjIodGhpcy5ub2RlLngsIC10aGlzLm5vZGUuaGVpZ2h0ICsgNTk1KSksXHJcbiAgICAgICAgICAgICAgICAgICAgY2MuY2FsbEZ1bmModGhpcy5yb2xsQ2FsbEJhY2suYmluZCh0aGlzKSlcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRSYW5kb21JZCgpIHtcclxuICAgICAgICBsZXQgcmFuZG9tSWQgPSAwO1xyXG4gICAgICAgIHdoaWxlIChyYW5kb21JZCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJhbmRvbUlkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHRoaXMubWFpbk9iai5yb2xlQmVpc2h1UGIubGVuZ3RoIC0gMSkgKyAxKTtcclxuICAgICAgICAgICAgcmFuZG9tSWQgPSByYW5kb21JZCA9PSB0aGlzLmV4Y2x1ZGVJZCA/IDAgOiByYW5kb21JZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiByYW5kb21JZDtcclxuICAgIH0sXHJcblxyXG4gICAgYWRkUm9sZShpZCkge1xyXG4gICAgICAgIGxldCBwYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMubWFpbk9iai5yb2xlQmVpc2h1UGJbaWRdKTtcclxuICAgICAgICB0aGlzLnJvbGVQYkxpc3QucHVzaChwYik7XHJcbiAgICAgICAgdGhpcy5yb2xlSWRMaXN0LnB1c2goaWQpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChwYik7XHJcbiAgICB9LFxyXG5cclxuICAgIHJvbGxDYWxsQmFjaygpIHtcclxuICAgICAgICB0aGlzLmF1ZGlvLnBsYXlTdG9wV2hlZWwoKTtcclxuICAgICAgICB0aGlzLmxhc3RSZXN1bHQgPSB0aGlzLnJvbGVJZExpc3Quc2xpY2UoLTQpO1xyXG4gICAgICAgIHRoaXMuc3RhdHVzID0gMDtcclxuICAgICAgICB0aGlzLm1haW5PYmouc3RhdGVDYWxsQmFjaygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzdG9wSW1tZWRpYXRlbHkoKSB7XHJcbiAgICAgICAgdGhpcy5sYXN0UmVzdWx0ID0gdGhpcy5yb2xlSWRMaXN0LnNsaWNlKC00KTtcclxuICAgICAgICB0aGlzLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLnkgPSAtdGhpcy5ub2RlLmhlaWdodCArIDU5NTtcclxuICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAwO1xyXG4gICAgICAgIHRoaXMubWFpbk9iai5zdGF0ZUNhbGxCYWNrKCk7XHJcbiAgICB9LFxyXG59KTsiXX0=