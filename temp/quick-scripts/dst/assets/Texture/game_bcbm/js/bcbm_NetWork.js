
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Texture/game_bcbm/js/bcbm_NetWork.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '273eeGc0JhNVIfjnYbpxQWE', 'bcbm_NetWork');
// Texture/game_bcbm/js/bcbm_NetWork.js

"use strict";

//sgttest
var LandNetWork = function () {
  function getInstant() {
    var _instance;

    if (_instance === undefined) {
      _instance = new Single();
    }

    return _instance;
  }

  function Single() {
    var _this = this;

    this.lobbyMain = null;
    this.Landlords = null;
    this.LandlordsSocket = null;
    this.playerInfo = null;
    this.playerHead = null;
    this.playerList = null;
    this.roomBet = 1;
    this.LandlordsData = null;
    this.maxLint = [0, 0, 0]; //单压 串  豹子

    this.gameData = []; //单局数据

    this.mineData = []; //单局个人数据

    this.tmpMoveTm = 0; //挪的次数

    this.tmpSubsequent = {}; //局内串的组合

    this.enterGameType = 0; // 正常房卡场 0   俱乐部房卡场1

    this.init = function () {
      this.playerInfo = require("PlayerInfo").getInstant;
    };
    /**
     * 房卡场进入游戏
     */


    this.loginGame_Function = function (ip, prot, playerId, sign) {
      _this.ip = Lhjconfig.Server_IP;
      _this.prot = prot;
      _this.playerId = playerId;
      _this.sign = sign;

      if (!_this.playerInfo) {
        _this.init();
      }

      _this.enterGameType = 0;
      _this.playerInfo.gameName = "lottery";
      _this.playerInfo.gameDisconnect = false;
      _this.lobbyMainSocket = require('../../../Script/Lobby/LobbyNetWork').socket;

      _this.startGameFunction();
    };

    this.initCLubObj = function (clubObj) {
      this.clubObj = clubObj;
      this.clubObj.loginGameResult();
    };
    /**
     * 开始游戏
     */


    this.startGameFunction = function () {
      var ip = this.ip;
      var prot = this.prot;
      var playerId = this.playerId;
      var sign = this.sign;
      var self = this;
      var socket = null;

      if (cc.sys.isNative) {
        self.LandlordsSocket = SocketIO.connect(ip + ":" + prot);
      } else {
        socket = require("socket-io"), self.LandlordsSocket = socket(ip + ":" + prot);
      }

      self.LandlordsSocket.on("connect_error", function () {
        cc.log("连接失败");
      });
      self.LandlordsSocket.on("connect_timeout", function () {
        cc.log("连接超时");
      });
      self.LandlordsSocket.on("connected", function (ret) {
        //cc.log('进入游戏=====' + JSON.stringify(ret));
        self.LandlordsSocket.emit("LoginGame", JSON.stringify({
          userid: playerId,
          gametype: 1,
          sign: sign
        }));
      });
      self.LandlordsSocket.on("loginGameResult", function (ret) {
        cc.log('进入奔驰宝马， 返回游戏信息:' + JSON.stringify(ret));
        ret = self.changeResultJSON_Function(ret);
        window.yadaxiao_sc = ret.Obj;

        if (ret.resultid) {
          self.playerInfo.playerCoin = ret.Obj.score;
          self.lobbyMainSocket.disconnect(); //self.LandlordsSocket.emit("getGameRankingList","");

          cc.find("Canvas/buttonCtrl").getComponent("LobbyButtonClick").QieHuanScene_normal("game_benchibaoma");
        }
      }); // //当前状态

      self.LandlordsSocket.on("getGameTypeResult", function (ret) {
        //1开始下注 2开奖 3结束 4可以抢庄
        var result = self.changeResultJSON_Function(ret);
        console.log(result);
        window.BCBM_ins.init_stat(result);
      });
      self.LandlordsSocket.on("qiangZhuangResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        console.log('抢庄结果');
        console.log(result);

        if (result.ResultCode == 1) {
          window.BCBM_ins.showHint(result);
        } else {//window.BCBM_ins.showHint('抢庄失败');
        }
      });
      self.LandlordsSocket.on("qiangStart", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        console.log("开始抢庄");
        console.log(result);

        if (window.BCBM_ins) {
          window.BCBM_ins.qiangBegin();
        }
      });
      self.LandlordsSocket.on("sendZhuang", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        console.log("发送庄");
        console.log(result);

        if (window.BCBM_ins) {
          window.BCBM_ins.setzhuang(result);
        }
      });
      self.LandlordsSocket.on("lotteryResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        console.log("～～～～～～下注返回");
        console.log(result);

        if (result.ResultCode == -1) {
          return;
        } else if (result.ResultCode == 2) {
          try {
            self.playerInfo.playerCoin = result.score;
            window.BCBM_ins.onBet(result.bet_dict);
          } catch (e) {}
        }
      });
      self.LandlordsSocket.on("OpenWinResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);

        if (window.BCBM_ins) {
          window.BCBM_ins.showResult(result);
        }

        console.log("～～～～～～开牌");
        console.log(ret);
      });
      self.LandlordsSocket.on("BetStart", function (ret) {
        var result = self.changeResultJSON_Function(ret); //var ss = {result:true,type:1};

        if (window.BCBM_ins) {
          window.BCBM_ins.betBegin();
        }

        console.log("～～～～～～开局");
        console.log(result);
      });
      self.LandlordsSocket.on("BetPool", function (ret) {
        var result = self.changeResultJSON_Function(ret); //var ss = {result:true,type:1};

        if (window.BCBM_ins) {
          window.BCBM_ins.betUpdate(result.betPool);
        } // console.log("～～～～～～获取下注池子");
        // console.log(result);

      }); //记录

      self.LandlordsSocket.on("getGameRecordListResult", function (ret) {
        var result = self.changeResultJSON_Function(ret);
        console.log(result);

        for (var i = 0; i < result.game_record_list.length; i++) {
          window.BCBM_ins.history(result.game_record_list[i].win_car);
        }
      });
    };
    /**
     * 设置场景对象
     */


    this.setLobbyMainObj_Function = function (scene) {
      this.lobbyMain = scene;
    };

    this.setLandlordsObj_Function = function (scene) {
      this.Landlords = scene;
    };

    this.changeResultJSON_Function = function (ret) {
      if (cc.sys.isNative) {
        return JSON.parse(ret);
      }

      return ret;
    };

    this.init();
  }

  return {
    getInstant: new getInstant()
  };
}();

module.exports = LandNetWork;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcVGV4dHVyZVxcZ2FtZV9iY2JtXFxqc1xcYmNibV9OZXRXb3JrLmpzIl0sIm5hbWVzIjpbIkxhbmROZXRXb3JrIiwiZ2V0SW5zdGFudCIsIl9pbnN0YW5jZSIsInVuZGVmaW5lZCIsIlNpbmdsZSIsImxvYmJ5TWFpbiIsIkxhbmRsb3JkcyIsIkxhbmRsb3Jkc1NvY2tldCIsInBsYXllckluZm8iLCJwbGF5ZXJIZWFkIiwicGxheWVyTGlzdCIsInJvb21CZXQiLCJMYW5kbG9yZHNEYXRhIiwibWF4TGludCIsImdhbWVEYXRhIiwibWluZURhdGEiLCJ0bXBNb3ZlVG0iLCJ0bXBTdWJzZXF1ZW50IiwiZW50ZXJHYW1lVHlwZSIsImluaXQiLCJyZXF1aXJlIiwibG9naW5HYW1lX0Z1bmN0aW9uIiwiaXAiLCJwcm90IiwicGxheWVySWQiLCJzaWduIiwiTGhqY29uZmlnIiwiU2VydmVyX0lQIiwiZ2FtZU5hbWUiLCJnYW1lRGlzY29ubmVjdCIsImxvYmJ5TWFpblNvY2tldCIsInNvY2tldCIsInN0YXJ0R2FtZUZ1bmN0aW9uIiwiaW5pdENMdWJPYmoiLCJjbHViT2JqIiwibG9naW5HYW1lUmVzdWx0Iiwic2VsZiIsImNjIiwic3lzIiwiaXNOYXRpdmUiLCJTb2NrZXRJTyIsImNvbm5lY3QiLCJvbiIsImxvZyIsInJldCIsImVtaXQiLCJKU09OIiwic3RyaW5naWZ5IiwidXNlcmlkIiwiZ2FtZXR5cGUiLCJjaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uIiwid2luZG93IiwieWFkYXhpYW9fc2MiLCJPYmoiLCJyZXN1bHRpZCIsInBsYXllckNvaW4iLCJzY29yZSIsImRpc2Nvbm5lY3QiLCJmaW5kIiwiZ2V0Q29tcG9uZW50IiwiUWllSHVhblNjZW5lX25vcm1hbCIsInJlc3VsdCIsImNvbnNvbGUiLCJCQ0JNX2lucyIsImluaXRfc3RhdCIsIlJlc3VsdENvZGUiLCJzaG93SGludCIsInFpYW5nQmVnaW4iLCJzZXR6aHVhbmciLCJvbkJldCIsImJldF9kaWN0IiwiZSIsInNob3dSZXN1bHQiLCJiZXRCZWdpbiIsImJldFVwZGF0ZSIsImJldFBvb2wiLCJpIiwiZ2FtZV9yZWNvcmRfbGlzdCIsImxlbmd0aCIsImhpc3RvcnkiLCJ3aW5fY2FyIiwic2V0TG9iYnlNYWluT2JqX0Z1bmN0aW9uIiwic2NlbmUiLCJzZXRMYW5kbG9yZHNPYmpfRnVuY3Rpb24iLCJwYXJzZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQSxJQUFJQSxXQUFXLEdBQUksWUFBWTtBQUMzQixXQUFTQyxVQUFULEdBQXNCO0FBQ2xCLFFBQUlDLFNBQUo7O0FBQ0EsUUFBSUEsU0FBUyxLQUFLQyxTQUFsQixFQUE2QjtBQUN6QkQsTUFBQUEsU0FBUyxHQUFHLElBQUlFLE1BQUosRUFBWjtBQUNIOztBQUNELFdBQU9GLFNBQVA7QUFDSDs7QUFFRCxXQUFTRSxNQUFULEdBQWtCO0FBQUE7O0FBQ2QsU0FBS0MsU0FBTCxHQUFpQixJQUFqQjtBQUNBLFNBQUtDLFNBQUwsR0FBaUIsSUFBakI7QUFDQSxTQUFLQyxlQUFMLEdBQXVCLElBQXZCO0FBQ0EsU0FBS0MsVUFBTCxHQUFrQixJQUFsQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0IsSUFBbEI7QUFDQSxTQUFLQyxVQUFMLEdBQWtCLElBQWxCO0FBQ0EsU0FBS0MsT0FBTCxHQUFlLENBQWY7QUFDQSxTQUFLQyxhQUFMLEdBQXFCLElBQXJCO0FBQ0EsU0FBS0MsT0FBTCxHQUFlLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLENBQWYsQ0FUYyxDQVNZOztBQUMxQixTQUFLQyxRQUFMLEdBQWdCLEVBQWhCLENBVmMsQ0FVTTs7QUFDcEIsU0FBS0MsUUFBTCxHQUFnQixFQUFoQixDQVhjLENBV007O0FBQ3BCLFNBQUtDLFNBQUwsR0FBaUIsQ0FBakIsQ0FaYyxDQVlNOztBQUNwQixTQUFLQyxhQUFMLEdBQXFCLEVBQXJCLENBYmMsQ0FhVzs7QUFDekIsU0FBS0MsYUFBTCxHQUFxQixD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Z0IsT0FBaEIsQ0FBd0JsQixNQUFNLENBQUNnQixnQkFBUCxDQUF3QkQsQ0FBeEIsRUFBMkJJLE9BQW5EO0FBQ0g7QUFDSixPQU5EO0FBUUgsS0F0SUQ7QUF3SUE7QUFDUjtBQUNBOzs7QUFDUSxTQUFLQyx3QkFBTCxHQUFnQyxVQUFVQyxLQUFWLEVBQWlCO0FBQzdDLFdBQUs3RSxTQUFMLEdBQWlCNkUsS0FBakI7QUFDSCxLQUZEOztBQUlBLFNBQUtDLHdCQUFMLEdBQWdDLFVBQVVELEtBQVYsRUFBaUI7QUFDN0MsV0FBSzVFLFNBQUwsR0FBaUI0RSxLQUFqQjtBQUNILEtBRkQ7O0FBSUEsU0FBS2hDLHlCQUFMLEdBQWlDLFVBQVVOLEdBQVYsRUFBZTtBQUM1QyxVQUFJUCxFQUFFLENBQUNDLEdBQUgsQ0FBT0MsUUFBWCxFQUFxQjtBQUNqQixlQUFPTyxJQUFJLENBQUNzQyxLQUFMLENBQVd4QyxHQUFYLENBQVA7QUFDSDs7QUFDRCxhQUFPQSxHQUFQO0FBQ0gsS0FMRDs7QUFNQSxTQUFLekIsSUFBTDtBQUNIOztBQUNELFNBQU87QUFDSGxCLElBQUFBLFVBQVUsRUFBRSxJQUFJQSxVQUFKO0FBRFQsR0FBUDtBQUdILENBdE5pQixFQUFsQjs7QUF3TkFvRixNQUFNLENBQUNDLE9BQVAsR0FBaUJ0RixXQUFqQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLy9zZ3R0ZXN0XHJcbnZhciBMYW5kTmV0V29yayA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBnZXRJbnN0YW50KCkge1xyXG4gICAgICAgIHZhciBfaW5zdGFuY2U7XHJcbiAgICAgICAgaWYgKF9pbnN0YW5jZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIF9pbnN0YW5jZSA9IG5ldyBTaW5nbGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF9pbnN0YW5jZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBTaW5nbGUoKSB7XHJcbiAgICAgICAgdGhpcy5sb2JieU1haW4gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuTGFuZGxvcmRzID0gbnVsbDtcclxuICAgICAgICB0aGlzLkxhbmRsb3Jkc1NvY2tldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJJbmZvID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBsYXllckhlYWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucGxheWVyTGlzdCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yb29tQmV0ID0gMTtcclxuICAgICAgICB0aGlzLkxhbmRsb3Jkc0RhdGEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWF4TGludCA9IFswLCAwLCAwXTsgLy/ljZXljosg5LiyICDosbnlrZBcclxuICAgICAgICB0aGlzLmdhbWVEYXRhID0gW107IC8v5Y2V5bGA5pWw5o2uXHJcbiAgICAgICAgdGhpcy5taW5lRGF0YSA9IFtdOyAvL+WNleWxgOS4quS6uuaVsOaNrlxyXG4gICAgICAgIHRoaXMudG1wTW92ZVRtID0gMDsgLy/mjKrnmoTmrKHmlbBcclxuICAgICAgICB0aGlzLnRtcFN1YnNlcXVlbnQgPSB7fTsgLy/lsYDlhoXkuLLnmoTnu4TlkIhcclxuICAgICAgICB0aGlzLmVudGVyR2FtZVR5cGUgPSAwOyAvLyDmraPluLjmiL/ljaHlnLogMCAgIOS/seS5kOmDqOaIv+WNoeWcujFcclxuXHJcbiAgICAgICAgdGhpcy5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllckluZm8gPSByZXF1aXJlKFwiUGxheWVySW5mb1wiKS5nZXRJbnN0YW50O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaIv+WNoeWcuui/m+WFpea4uOaIj1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubG9naW5HYW1lX0Z1bmN0aW9uID0gKGlwLCBwcm90LCBwbGF5ZXJJZCwgc2lnbikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlwID0gTGhqY29uZmlnLlNlcnZlcl9JUDtcclxuICAgICAgICAgICAgdGhpcy5wcm90ID0gcHJvdDtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJJZCA9IHBsYXllcklkO1xyXG4gICAgICAgICAgICB0aGlzLnNpZ24gPSBzaWduO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMucGxheWVySW5mbykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5lbnRlckdhbWVUeXBlID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJJbmZvLmdhbWVOYW1lID0gXCJsb3R0ZXJ5XCI7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVySW5mby5nYW1lRGlzY29ubmVjdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmxvYmJ5TWFpblNvY2tldCA9IHJlcXVpcmUoJy4uLy4uLy4uL1NjcmlwdC9Mb2JieS9Mb2JieU5ldFdvcmsnKS5zb2NrZXQ7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRHYW1lRnVuY3Rpb24oKTtcclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0Q0x1Yk9iaiA9IGZ1bmN0aW9uIChjbHViT2JqKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2x1Yk9iaiA9IGNsdWJPYmo7XHJcbiAgICAgICAgICAgIHRoaXMuY2x1Yk9iai5sb2dpbkdhbWVSZXN1bHQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlvIDlp4vmuLjmiI9cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnN0YXJ0R2FtZUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgaXAgPSB0aGlzLmlwO1xyXG4gICAgICAgICAgICB2YXIgcHJvdCA9IHRoaXMucHJvdDtcclxuICAgICAgICAgICAgdmFyIHBsYXllcklkID0gdGhpcy5wbGF5ZXJJZDtcclxuICAgICAgICAgICAgdmFyIHNpZ24gPSB0aGlzLnNpZ247XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHNvY2tldCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldCA9IFNvY2tldElPLmNvbm5lY3QoaXAgKyBcIjpcIiArIHByb3QpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc29ja2V0ID0gcmVxdWlyZShcInNvY2tldC1pb1wiKSwgc2VsZi5MYW5kbG9yZHNTb2NrZXQgPSBzb2NrZXQoaXAgKyBcIjpcIiArIHByb3QpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldC5vbihcImNvbm5lY3RfZXJyb3JcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2MubG9nKFwi6L+e5o6l5aSx6LSlXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuTGFuZGxvcmRzU29ja2V0Lm9uKFwiY29ubmVjdF90aW1lb3V0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhcIui/nuaOpei2heaXtlwiKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldC5vbihcImNvbm5lY3RlZFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAvL2NjLmxvZygn6L+b5YWl5ri45oiPPT09PT0nICsgSlNPTi5zdHJpbmdpZnkocmV0KSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldC5lbWl0KFwiTG9naW5HYW1lXCIsIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyaWQ6IHBsYXllcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGdhbWV0eXBlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpZ246IHNpZ25cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldC5vbihcImxvZ2luR2FtZVJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBjYy5sb2coJ+i/m+WFpeWllOmpsOWunemprO+8jCDov5Tlm57muLjmiI/kv6Hmga86JyArIEpTT04uc3RyaW5naWZ5KHJldCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cueWFkYXhpYW9fc2MgPSByZXQuT2JqO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5yZXN1bHRpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGxheWVySW5mby5wbGF5ZXJDb2luID0gcmV0Lk9iai5zY29yZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYmJ5TWFpblNvY2tldC5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9zZWxmLkxhbmRsb3Jkc1NvY2tldC5lbWl0KFwiZ2V0R2FtZVJhbmtpbmdMaXN0XCIsXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9idXR0b25DdHJsXCIpLmdldENvbXBvbmVudChcIkxvYmJ5QnV0dG9uQ2xpY2tcIikuUWllSHVhblNjZW5lX25vcm1hbChcImdhbWVfYmVuY2hpYmFvbWFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gLy/lvZPliY3nirbmgIFcclxuICAgICAgICAgICAgc2VsZi5MYW5kbG9yZHNTb2NrZXQub24oXCJnZXRHYW1lVHlwZVJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICAvLzHlvIDlp4vkuIvms6ggMuW8gOWlliAz57uT5p2fIDTlj6/ku6XmiqLluoRcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgd2luZG93LkJDQk1faW5zLmluaXRfc3RhdChyZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzZWxmLkxhbmRsb3Jkc1NvY2tldC5vbihcInFpYW5nWmh1YW5nUmVzdWx0XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmiqLluoTnu5PmnpwnKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LlJlc3VsdENvZGUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5CQ0JNX2lucy5zaG93SGludChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3dpbmRvdy5CQ0JNX2lucy5zaG93SGludCgn5oqi5bqE5aSx6LSlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc2VsZi5MYW5kbG9yZHNTb2NrZXQub24oXCJxaWFuZ1N0YXJ0XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5byA5aeL5oqi5bqEXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuQkNCTV9pbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuQkNCTV9pbnMucWlhbmdCZWdpbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuTGFuZGxvcmRzU29ja2V0Lm9uKFwic2VuZFpodWFuZ1wiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWPkemAgeW6hFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5CQ0JNX2lucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5CQ0JNX2lucy5zZXR6aHVhbmcocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc2VsZi5MYW5kbG9yZHNTb2NrZXQub24oXCJsb3R0ZXJ5UmVzdWx0XCIsIGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNoYW5nZVJlc3VsdEpTT05fRnVuY3Rpb24ocmV0KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi772e772e772e772e772e772e5LiL5rOo6L+U5ZueXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuUmVzdWx0Q29kZSA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LlJlc3VsdENvZGUgPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGxheWVySW5mby5wbGF5ZXJDb2luID0gcmVzdWx0LnNjb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuQkNCTV9pbnMub25CZXQocmVzdWx0LmJldF9kaWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHNlbGYuTGFuZGxvcmRzU29ja2V0Lm9uKFwiT3BlbldpblJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LkJDQk1faW5zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LkJDQk1faW5zLnNob3dSZXN1bHQocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi772e772e772e772e772e772e5byA54mMXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHNlbGYuTGFuZGxvcmRzU29ja2V0Lm9uKFwiQmV0U3RhcnRcIiwgZnVuY3Rpb24gKHJldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbihyZXQpO1xyXG4gICAgICAgICAgICAgICAgLy92YXIgc3MgPSB7cmVzdWx0OnRydWUsdHlwZToxfTtcclxuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuQkNCTV9pbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuQkNCTV9pbnMuYmV0QmVnaW4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi772e772e772e772e772e772e5byA5bGAXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHNlbGYuTGFuZGxvcmRzU29ja2V0Lm9uKFwiQmV0UG9vbFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICAvL3ZhciBzcyA9IHtyZXN1bHQ6dHJ1ZSx0eXBlOjF9O1xyXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5CQ0JNX2lucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5CQ0JNX2lucy5iZXRVcGRhdGUocmVzdWx0LmJldFBvb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCLvvZ7vvZ7vvZ7vvZ7vvZ7vvZ7ojrflj5bkuIvms6jmsaDlrZBcIik7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy/orrDlvZVcclxuICAgICAgICAgICAgc2VsZi5MYW5kbG9yZHNTb2NrZXQub24oXCJnZXRHYW1lUmVjb3JkTGlzdFJlc3VsdFwiLCBmdW5jdGlvbiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gc2VsZi5jaGFuZ2VSZXN1bHRKU09OX0Z1bmN0aW9uKHJldCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQuZ2FtZV9yZWNvcmRfbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5CQ0JNX2lucy5oaXN0b3J5KHJlc3VsdC5nYW1lX3JlY29yZF9saXN0W2ldLndpbl9jYXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u5Zy65pmv5a+56LGhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zZXRMb2JieU1haW5PYmpfRnVuY3Rpb24gPSBmdW5jdGlvbiAoc2NlbmUpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2JieU1haW4gPSBzY2VuZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLnNldExhbmRsb3Jkc09ial9GdW5jdGlvbiA9IGZ1bmN0aW9uIChzY2VuZSkge1xyXG4gICAgICAgICAgICB0aGlzLkxhbmRsb3JkcyA9IHNjZW5lO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuY2hhbmdlUmVzdWx0SlNPTl9GdW5jdGlvbiA9IGZ1bmN0aW9uIChyZXQpIHtcclxuICAgICAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UocmV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldEluc3RhbnQ6IG5ldyBnZXRJbnN0YW50KCksXHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IExhbmROZXRXb3JrOyJdfQ==