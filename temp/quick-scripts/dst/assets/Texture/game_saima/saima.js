
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Texture/game_saima/saima.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ee2a8uHyFJGS4TcSlbz37Aw', 'saima');
// Texture/game_saima/saima.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    Timeout: {
      "default": 10,
      tooltip: "连接超时倒计时(秒)"
    },
    Default_chip: 10,
    //默认初始筹码
    bet_Zone: cc.Node,
    //下注区域
    bet_mask: cc.Node,
    //下注区遮罩
    times_lab: cc.Label,
    //当前局号
    LabelJinBi: cc.Label,
    //金币文字
    time1_lab: cc.Label,
    time2_lab: cc.Label,
    PanelXinXi: cc.Node,
    //信息界面
    NodeAudioParent: cc.Node,
    //所有音效的父节点
    Prefab_HorseRacing: cc.Prefab,
    //跑马界面的预制件
    Panel_qianbugou: cc.Node,
    //钱不够界面
    Panel_qingxiazhu: cc.Node,
    //请下注界面
    Panel_jilu: cc.Node,
    //开奖记录界面
    scrollView_jilu: cc.ScrollView,
    jilu_preb: cc.Prefab
  },
  onLoad: function onLoad() {
    this.network = this.getComponent('sm_Network');
    this.playerInfo = require("PlayerInfo").getInstant;
    this.initGame();
  },
  initGame: function initGame() {
    this.LabelArray_Bet = []; //下注文本数组

    this.LabelArray_PeiLv = []; //赔率文本数组

    this.AnimationArray_run = []; //奔跑动画数组

    this._arrayBet = [];
    this.gameRecord = null; //动态添加下注节点

    for (var i = 0; i < this.bet_Zone.children.length; i++) {
      this.LabelArray_Bet.push(this.bet_Zone.children[i].getChildByName("下注").getComponent(cc.Label));
      this.LabelArray_PeiLv.push(this.bet_Zone.children[i].getChildByName("赔率").getComponent(cc.Label));
      this.AnimationArray_run.push(this.bet_Zone.children[i].getChildByName("动画").getComponent(cc.Animation));

      this._arrayBet.push(0);
    }

    this._chip = this.Default_chip; //初始筹码

    this.onBtnClick_ClearBet();
  },
  showInfo: function showInfo(data) {
    this.nowCoin = this.network.userCoin;
    var str = data.times_id.toString();
    this.times_id = str.substring(str.length - 4, str.length);
    this.times_lab.string = this.times_id;
    this.LabelJinBi.string = this.nowCoin.toFixed(2);
    this.game_second = data.game_second;
    this.game_type = data.game_type;
    this.bet_mask.active = this.game_type > 1; //游戏状态 1:下注  2:封盘  3:开奖

    for (var i in this.LabelArray_PeiLv) {
      this.LabelArray_PeiLv[i].string = "1\u966A" + data.game_odd[i];
    }

    this.setTime();
    cc.log(data.game_second, data.game_type);
  },
  start: function start() {
    cc.audioEngine.stopAll();
  },
  setTime: function setTime() {
    var _this = this;

    this.unschedule(this.timedown);

    if (this.network.time_openPrice > this.game_second) {
      this.time1_lab.string = this.network.time_openPrice - this.game_second + "秒";
    } else {
      this.time1_lab.string = "0秒";
    }

    if (this.network.time_betClose > this.game_second) {
      this.time2_lab.string = this.network.time_betClose - this.game_second + "秒";
    } else {
      this.time2_lab.string = "0秒";
    }

    this.timedown = function () {
      _this.game_second += 1;

      if (_this.network.time_openPrice > _this.game_second) {
        _this.time1_lab.string = _this.network.time_openPrice - _this.game_second + "秒";
      } else {
        _this.time1_lab.string = "0秒";
      }

      if (_this.network.time_betClose > _this.game_second) {
        _this.time2_lab.string = _this.network.time_betClose - _this.game_second + "秒";
      } else {
        _this.time2_lab.string = "0秒";
      }
    };

    this.schedule(this.timedown, 1);
  },
  //下注
  onBtnClick_Bet: function onBtnClick_Bet(event, index) {
    //刷新当前金币数
    if (this.nowCoin < this._chip) {
      this.Panel_qianbugou.active = true;
      return;
    }

    this.nowCoin -= this._chip;
    this.LabelJinBi.string = this.nowCoin.toFixed(2);
    this._arrayBet[index] += this._chip; //增加下注

    this.RefreshLabel_Bet(index); //刷新下注文本
    //播放奔跑动画

    if (this.AnimationArray_run[index].state && this.AnimationArray_run[index].state.isPlaying) {
      return;
    }

    this.AnimationArray_run[index].state = this.AnimationArray_run[index].play();
  },
  //开始下注
  startBets: function startBets(data) {
    this.showInfo(data);
    this.onBtnClick_ClearBet();
    this.bet_mask.active = false;
  },
  //停止下注
  closeBets: function closeBets() {
    this.bet_mask.active = true;
    var sendJsonList = [];

    for (var i in this._arrayBet) {
      if (this._arrayBet[i] > 0) {
        sendJsonList.push({
          nBetItem: parseInt(i),
          nBet: this._arrayBet[i] * this.playerInfo.exchangeRate
        });
      }
    }

    if (sendJsonList.length > 0) {
      this.network.socket.emit('lottery', JSON.stringify(sendJsonList));
    }
  },
  //开奖结果
  getResult: function getResult(res) {
    cc.log("\u80DC\u5229\u7684\u662F" + (res.win_card_index + 1) + "\u53F7"); // let getWinCoin = res.win / this.playerInfo.exchangeRate - this.GetDuZhu() > 0 ? res.win / this.playerInfo.exchangeRate - this.GetDuZhu() > 0 : 0;

    var panel = cc.instantiate(this.Prefab_HorseRacing); //克隆

    panel.getComponent("paoma").SetData(res.win_list, res.win / this.playerInfo.exchangeRate);
    panel.parent = cc.find("Canvas");
  },
  //点击清除下注按钮
  onBtnClick_ClearBet: function onBtnClick_ClearBet() {
    for (var i = 0; i < this._arrayBet.length; i++) {
      this._arrayBet[i] = 0; //下注清零

      this.RefreshLabel_Bet(i); //下注文本赋值“0”
    } //停止所有奔跑动画


    for (var j = 0; j < this.AnimationArray_run.length; j++) {
      this.AnimationArray_run[j].state = this.AnimationArray_run[j].stop();
    }
  },
  //换筹码
  RadioButtonClicked_chip: function RadioButtonClicked_chip(toggle, chip) {
    this._chip = parseInt(chip);
  },
  //刷新下注文本
  RefreshLabel_Bet: function RefreshLabel_Bet(index) {
    if (this._arrayBet[index] > 0) {
      this.LabelArray_Bet[index].string = this._arrayBet[index].toFixed(2);
    } else {
      this.LabelArray_Bet[index].string = "0.00";
    }
  },
  //点击信息按钮
  onBtnClick_XinXi: function onBtnClick_XinXi() {
    this.PanelXinXi.active = !this.PanelXinXi.active;
  },
  //点击开奖记录按钮
  onBtnClick_JiLu: function onBtnClick_JiLu() {
    this.Panel_jilu.active = !this.Panel_jilu.active;
    this.scrollView_jilu.content.removeAllChildren();

    for (var i = 0; i < this.gameRecord.length; i++) {
      var item = new cc.instantiate(this.jilu_preb);
      item.getComponent("sm_recordItem").initData(this.gameRecord[i]);
      this.scrollView_jilu.content.addChild(item);
    }
  },
  //点击开始按钮
  onBtnClick_KaiShi: function onBtnClick_KaiShi() {
    var duzhu = this.GetDuZhu();

    if (duzhu <= 0) {
      this.Panel_qingxiazhu.active = true; //请下注

      return;
    } else {// this.stateMachine.Input_Start(0.01, this.Timeout);
    }
  },
  //点击声音开关
  onToggleClick_ShengYin: function onToggleClick_ShengYin(toggle, customEventData) {
    if (toggle.isChecked) {
      for (var i = 0; i < this.NodeAudioParent.children.length; i++) {
        this.NodeAudioParent.children[i].getComponent(cc.AudioSource).volume = 1;
      }
    } else {
      for (var i = 0; i < this.NodeAudioParent.children.length; i++) {
        this.NodeAudioParent.children[i].getComponent(cc.AudioSource).volume = 0;
      }
    }
  },
  //点击返回大厅按钮
  onBtnClick_BackHall: function onBtnClick_BackHall() {
    this.network.socket.disconnect();
    cc.director.loadScene("LobbyMain");
  },
  //计算得到下注金额
  GetDuZhu: function GetDuZhu() {
    var duzhu = 0;

    for (var i = 0; i < this._arrayBet.length; i++) {
      duzhu += this._arrayBet[i];
    }

    return duzhu;
  },
  //点击关闭界面按钮
  onBtnClick_ClosePanel: function onBtnClick_ClosePanel(event, customEventData) {
    event.target.parent.active = false;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcVGV4dHVyZVxcZ2FtZV9zYWltYVxcc2FpbWEuanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJUaW1lb3V0IiwidG9vbHRpcCIsIkRlZmF1bHRfY2hpcCIsImJldF9ab25lIiwiTm9kZSIsImJldF9tYXNrIiwidGltZXNfbGFiIiwiTGFiZWwiLCJMYWJlbEppbkJpIiwidGltZTFfbGFiIiwidGltZTJfbGFiIiwiUGFuZWxYaW5YaSIsIk5vZGVBdWRpb1BhcmVudCIsIlByZWZhYl9Ib3JzZVJhY2luZyIsIlByZWZhYiIsIlBhbmVsX3FpYW5idWdvdSIsIlBhbmVsX3Fpbmd4aWF6aHUiLCJQYW5lbF9qaWx1Iiwic2Nyb2xsVmlld19qaWx1IiwiU2Nyb2xsVmlldyIsImppbHVfcHJlYiIsIm9uTG9hZCIsIm5ldHdvcmsiLCJnZXRDb21wb25lbnQiLCJwbGF5ZXJJbmZvIiwicmVxdWlyZSIsImdldEluc3RhbnQiLCJpbml0R2FtZSIsIkxhYmVsQXJyYXlfQmV0IiwiTGFiZWxBcnJheV9QZWlMdiIsIkFuaW1hdGlvbkFycmF5X3J1biIsIl9hcnJheUJldCIsImdhbWVSZWNvcmQiLCJpIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJwdXNoIiwiZ2V0Q2hpbGRCeU5hbWUiLCJBbmltYXRpb24iLCJfY2hpcCIsIm9uQnRuQ2xpY2tfQ2xlYXJCZXQiLCJzaG93SW5mbyIsImRhdGEiLCJub3dDb2luIiwidXNlckNvaW4iLCJzdHIiLCJ0aW1lc19pZCIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwic3RyaW5nIiwidG9GaXhlZCIsImdhbWVfc2Vjb25kIiwiZ2FtZV90eXBlIiwiYWN0aXZlIiwiZ2FtZV9vZGQiLCJzZXRUaW1lIiwibG9nIiwic3RhcnQiLCJhdWRpb0VuZ2luZSIsInN0b3BBbGwiLCJ1bnNjaGVkdWxlIiwidGltZWRvd24iLCJ0aW1lX29wZW5QcmljZSIsInRpbWVfYmV0Q2xvc2UiLCJzY2hlZHVsZSIsIm9uQnRuQ2xpY2tfQmV0IiwiZXZlbnQiLCJpbmRleCIsIlJlZnJlc2hMYWJlbF9CZXQiLCJzdGF0ZSIsImlzUGxheWluZyIsInBsYXkiLCJzdGFydEJldHMiLCJjbG9zZUJldHMiLCJzZW5kSnNvbkxpc3QiLCJuQmV0SXRlbSIsInBhcnNlSW50IiwibkJldCIsImV4Y2hhbmdlUmF0ZSIsInNvY2tldCIsImVtaXQiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0UmVzdWx0IiwicmVzIiwid2luX2NhcmRfaW5kZXgiLCJwYW5lbCIsImluc3RhbnRpYXRlIiwiU2V0RGF0YSIsIndpbl9saXN0Iiwid2luIiwicGFyZW50IiwiZmluZCIsImoiLCJzdG9wIiwiUmFkaW9CdXR0b25DbGlja2VkX2NoaXAiLCJ0b2dnbGUiLCJjaGlwIiwib25CdG5DbGlja19YaW5YaSIsIm9uQnRuQ2xpY2tfSmlMdSIsImNvbnRlbnQiLCJyZW1vdmVBbGxDaGlsZHJlbiIsIml0ZW0iLCJpbml0RGF0YSIsImFkZENoaWxkIiwib25CdG5DbGlja19LYWlTaGkiLCJkdXpodSIsIkdldER1Wmh1Iiwib25Ub2dnbGVDbGlja19TaGVuZ1lpbiIsImN1c3RvbUV2ZW50RGF0YSIsImlzQ2hlY2tlZCIsIkF1ZGlvU291cmNlIiwidm9sdW1lIiwib25CdG5DbGlja19CYWNrSGFsbCIsImRpc2Nvbm5lY3QiLCJkaXJlY3RvciIsImxvYWRTY2VuZSIsIm9uQnRuQ2xpY2tfQ2xvc2VQYW5lbCIsInRhcmdldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLE9BQU8sRUFBRTtBQUNMLGlCQUFTLEVBREo7QUFFTEMsTUFBQUEsT0FBTyxFQUFFO0FBRkosS0FERDtBQUtSQyxJQUFBQSxZQUFZLEVBQUUsRUFMTjtBQUtTO0FBQ2pCQyxJQUFBQSxRQUFRLEVBQUVQLEVBQUUsQ0FBQ1EsSUFO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T0ksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBUaW1lb3V0OiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IDEwLFxyXG4gICAgICAgICAgICB0b29sdGlwOiBcIui/nuaOpei2heaXtuWAkuiuoeaXtijnp5IpXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBEZWZhdWx0X2NoaXA6IDEwLC8v6buY6K6k5Yid5aeL562556CBXHJcbiAgICAgICAgYmV0X1pvbmU6IGNjLk5vZGUsLy/kuIvms6jljLrln59cclxuICAgICAgICBiZXRfbWFzazogY2MuTm9kZSwvL+S4i+azqOWMuumBrue9qVxyXG4gICAgICAgIHRpbWVzX2xhYjogY2MuTGFiZWwsLy/lvZPliY3lsYDlj7dcclxuICAgICAgICBMYWJlbEppbkJpOiBjYy5MYWJlbCwvL+mHkeW4geaWh+Wtl1xyXG4gICAgICAgIHRpbWUxX2xhYjogY2MuTGFiZWwsXHJcbiAgICAgICAgdGltZTJfbGFiOiBjYy5MYWJlbCxcclxuICAgICAgICBQYW5lbFhpblhpOiBjYy5Ob2RlLC8v5L+h5oGv55WM6Z2iXHJcbiAgICAgICAgTm9kZUF1ZGlvUGFyZW50OiBjYy5Ob2RlLC8v5omA5pyJ6Z+z5pWI55qE54i26IqC54K5XHJcblxyXG4gICAgICAgIFByZWZhYl9Ib3JzZVJhY2luZzogY2MuUHJlZmFiLC8v6LeR6ams55WM6Z2i55qE6aKE5Yi25Lu2XHJcbiAgICAgICAgUGFuZWxfcWlhbmJ1Z291OiBjYy5Ob2RlLCAvL+mSseS4jeWkn+eVjOmdolxyXG4gICAgICAgIFBhbmVsX3Fpbmd4aWF6aHU6IGNjLk5vZGUsLy/or7fkuIvms6jnlYzpnaJcclxuICAgICAgICBQYW5lbF9qaWx1OiBjYy5Ob2RlLC8v5byA5aWW6K6w5b2V55WM6Z2iXHJcbiAgICAgICAgc2Nyb2xsVmlld19qaWx1OiBjYy5TY3JvbGxWaWV3LFxyXG4gICAgICAgIGppbHVfcHJlYjogY2MuUHJlZmFiLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm5ldHdvcmsgPSB0aGlzLmdldENvbXBvbmVudCgnc21fTmV0d29yaycpO1xyXG4gICAgICAgIHRoaXMucGxheWVySW5mbyA9IHJlcXVpcmUoXCJQbGF5ZXJJbmZvXCIpLmdldEluc3RhbnQ7XHJcbiAgICAgICAgdGhpcy5pbml0R2FtZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbml0R2FtZSgpIHtcclxuICAgICAgICB0aGlzLkxhYmVsQXJyYXlfQmV0ID0gW107Ly/kuIvms6jmlofmnKzmlbDnu4RcclxuICAgICAgICB0aGlzLkxhYmVsQXJyYXlfUGVpTHYgPSBbXTsvL+i1lOeOh+aWh+acrOaVsOe7hFxyXG4gICAgICAgIHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuID0gW107Ly/lpZTot5HliqjnlLvmlbDnu4RcclxuICAgICAgICB0aGlzLl9hcnJheUJldCA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ2FtZVJlY29yZCA9IG51bGw7XHJcbiAgICAgICAgLy/liqjmgIHmt7vliqDkuIvms6joioLngrlcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmV0X1pvbmUuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5MYWJlbEFycmF5X0JldC5wdXNoKHRoaXMuYmV0X1pvbmUuY2hpbGRyZW5baV0uZ2V0Q2hpbGRCeU5hbWUoXCLkuIvms6hcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSk7XHJcbiAgICAgICAgICAgIHRoaXMuTGFiZWxBcnJheV9QZWlMdi5wdXNoKHRoaXMuYmV0X1pvbmUuY2hpbGRyZW5baV0uZ2V0Q2hpbGRCeU5hbWUoXCLotZTnjodcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSk7XHJcbiAgICAgICAgICAgIHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuLnB1c2godGhpcy5iZXRfWm9uZS5jaGlsZHJlbltpXS5nZXRDaGlsZEJ5TmFtZShcIuWKqOeUu1wiKS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2FycmF5QmV0LnB1c2goMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9jaGlwID0gdGhpcy5EZWZhdWx0X2NoaXA7Ly/liJ3lp4vnrbnnoIFcclxuICAgICAgICB0aGlzLm9uQnRuQ2xpY2tfQ2xlYXJCZXQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0luZm8oZGF0YSkge1xyXG4gICAgICAgIHRoaXMubm93Q29pbiA9IHRoaXMubmV0d29yay51c2VyQ29pbjtcclxuICAgICAgICBsZXQgc3RyID0gZGF0YS50aW1lc19pZC50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMudGltZXNfaWQgPSBzdHIuc3Vic3RyaW5nKHN0ci5sZW5ndGggLSA0LCBzdHIubGVuZ3RoKTtcclxuICAgICAgICB0aGlzLnRpbWVzX2xhYi5zdHJpbmcgPSB0aGlzLnRpbWVzX2lkO1xyXG4gICAgICAgIHRoaXMuTGFiZWxKaW5CaS5zdHJpbmcgPSB0aGlzLm5vd0NvaW4udG9GaXhlZCgyKTtcclxuICAgICAgICB0aGlzLmdhbWVfc2Vjb25kID0gZGF0YS5nYW1lX3NlY29uZDtcclxuICAgICAgICB0aGlzLmdhbWVfdHlwZSA9IGRhdGEuZ2FtZV90eXBlO1xyXG4gICAgICAgIHRoaXMuYmV0X21hc2suYWN0aXZlID0gdGhpcy5nYW1lX3R5cGUgPiAxOy8v5ri45oiP54q25oCBIDE65LiL5rOoICAyOuWwgeebmCAgMzrlvIDlpZZcclxuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMuTGFiZWxBcnJheV9QZWlMdikge1xyXG4gICAgICAgICAgICB0aGlzLkxhYmVsQXJyYXlfUGVpTHZbaV0uc3RyaW5nID0gYDHpmaoke2RhdGEuZ2FtZV9vZGRbaV19YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRUaW1lKCk7XHJcbiAgICAgICAgY2MubG9nKGRhdGEuZ2FtZV9zZWNvbmQsIGRhdGEuZ2FtZV90eXBlKTtcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wQWxsKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldFRpbWUoKSB7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMudGltZWRvd24pO1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmsudGltZV9vcGVuUHJpY2UgPiB0aGlzLmdhbWVfc2Vjb25kKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZTFfbGFiLnN0cmluZyA9ICh0aGlzLm5ldHdvcmsudGltZV9vcGVuUHJpY2UgLSB0aGlzLmdhbWVfc2Vjb25kKSArIFwi56eSXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lMV9sYWIuc3RyaW5nID0gXCIw56eSXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrLnRpbWVfYmV0Q2xvc2UgPiB0aGlzLmdhbWVfc2Vjb25kKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZTJfbGFiLnN0cmluZyA9ICh0aGlzLm5ldHdvcmsudGltZV9iZXRDbG9zZSAtIHRoaXMuZ2FtZV9zZWNvbmQpICsgXCLnp5JcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUyX2xhYi5zdHJpbmcgPSBcIjDnp5JcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50aW1lZG93biA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lX3NlY29uZCArPSAxO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5uZXR3b3JrLnRpbWVfb3BlblByaWNlID4gdGhpcy5nYW1lX3NlY29uZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lMV9sYWIuc3RyaW5nID0gKHRoaXMubmV0d29yay50aW1lX29wZW5QcmljZSAtIHRoaXMuZ2FtZV9zZWNvbmQpICsgXCLnp5JcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZTFfbGFiLnN0cmluZyA9IFwiMOenklwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5uZXR3b3JrLnRpbWVfYmV0Q2xvc2UgPiB0aGlzLmdhbWVfc2Vjb25kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWUyX2xhYi5zdHJpbmcgPSAodGhpcy5uZXR3b3JrLnRpbWVfYmV0Q2xvc2UgLSB0aGlzLmdhbWVfc2Vjb25kKSArIFwi56eSXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWUyX2xhYi5zdHJpbmcgPSBcIjDnp5JcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMudGltZWRvd24sIDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+S4i+azqFxyXG4gICAgb25CdG5DbGlja19CZXQ6IGZ1bmN0aW9uIChldmVudCwgaW5kZXgpIHtcclxuICAgICAgICAvL+WIt+aWsOW9k+WJjemHkeW4geaVsFxyXG4gICAgICAgIGlmICh0aGlzLm5vd0NvaW4gPCB0aGlzLl9jaGlwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuUGFuZWxfcWlhbmJ1Z291LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ub3dDb2luIC09IHRoaXMuX2NoaXA7XHJcbiAgICAgICAgdGhpcy5MYWJlbEppbkJpLnN0cmluZyA9IHRoaXMubm93Q29pbi50b0ZpeGVkKDIpO1xyXG5cclxuICAgICAgICB0aGlzLl9hcnJheUJldFtpbmRleF0gKz0gdGhpcy5fY2hpcDsvL+WinuWKoOS4i+azqFxyXG4gICAgICAgIHRoaXMuUmVmcmVzaExhYmVsX0JldChpbmRleCk7Ly/liLfmlrDkuIvms6jmlofmnKxcclxuICAgICAgICAvL+aSreaUvuWllOi3keWKqOeUu1xyXG4gICAgICAgIGlmICh0aGlzLkFuaW1hdGlvbkFycmF5X3J1bltpbmRleF0uc3RhdGUgJiYgdGhpcy5BbmltYXRpb25BcnJheV9ydW5baW5kZXhdLnN0YXRlLmlzUGxheWluZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuW2luZGV4XS5zdGF0ZSA9IHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuW2luZGV4XS5wbGF5KCk7XHJcbiAgICB9LFxyXG4gICAgLy/lvIDlp4vkuIvms6hcclxuICAgIHN0YXJ0QmV0cyhkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5zaG93SW5mbyhkYXRhKTtcclxuICAgICAgICB0aGlzLm9uQnRuQ2xpY2tfQ2xlYXJCZXQoKTtcclxuICAgICAgICB0aGlzLmJldF9tYXNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5YGc5q2i5LiL5rOoXHJcbiAgICBjbG9zZUJldHMoKSB7XHJcbiAgICAgICAgdGhpcy5iZXRfbWFzay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGxldCBzZW5kSnNvbkxpc3QgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMuX2FycmF5QmV0KSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hcnJheUJldFtpXSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbmRKc29uTGlzdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBuQmV0SXRlbTogcGFyc2VJbnQoaSksXHJcbiAgICAgICAgICAgICAgICAgICAgbkJldDogdGhpcy5fYXJyYXlCZXRbaV0gKiB0aGlzLnBsYXllckluZm8uZXhjaGFuZ2VSYXRlLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2VuZEpzb25MaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrLnNvY2tldC5lbWl0KCdsb3R0ZXJ5JywgSlNPTi5zdHJpbmdpZnkoc2VuZEpzb25MaXN0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5byA5aWW57uT5p6cXHJcbiAgICBnZXRSZXN1bHQocmVzKSB7XHJcbiAgICAgICAgY2MubG9nKGDog5zliKnnmoTmmK8ke3Jlcy53aW5fY2FyZF9pbmRleCArIDF95Y+3YCk7XHJcbiAgICAgICAgLy8gbGV0IGdldFdpbkNvaW4gPSByZXMud2luIC8gdGhpcy5wbGF5ZXJJbmZvLmV4Y2hhbmdlUmF0ZSAtIHRoaXMuR2V0RHVaaHUoKSA+IDAgPyByZXMud2luIC8gdGhpcy5wbGF5ZXJJbmZvLmV4Y2hhbmdlUmF0ZSAtIHRoaXMuR2V0RHVaaHUoKSA+IDAgOiAwO1xyXG4gICAgICAgIHZhciBwYW5lbCA9IGNjLmluc3RhbnRpYXRlKHRoaXMuUHJlZmFiX0hvcnNlUmFjaW5nKTsvL+WFi+mahlxyXG4gICAgICAgIHBhbmVsLmdldENvbXBvbmVudChcInBhb21hXCIpLlNldERhdGEocmVzLndpbl9saXN0LCByZXMud2luIC8gdGhpcy5wbGF5ZXJJbmZvLmV4Y2hhbmdlUmF0ZSk7XHJcbiAgICAgICAgcGFuZWwucGFyZW50ID0gY2MuZmluZChcIkNhbnZhc1wiKTtcclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+a4hemZpOS4i+azqOaMiemSrlxyXG4gICAgb25CdG5DbGlja19DbGVhckJldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYXJyYXlCZXQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5fYXJyYXlCZXRbaV0gPSAwOy8v5LiL5rOo5riF6Zu2XHJcbiAgICAgICAgICAgIHRoaXMuUmVmcmVzaExhYmVsX0JldChpKTsvL+S4i+azqOaWh+acrOi1i+WAvOKAnDDigJ1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/lgZzmraLmiYDmnInlpZTot5HliqjnlLtcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuQW5pbWF0aW9uQXJyYXlfcnVuW2pdLnN0YXRlID0gdGhpcy5BbmltYXRpb25BcnJheV9ydW5bal0uc3RvcCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/mjaLnrbnnoIFcclxuICAgIFJhZGlvQnV0dG9uQ2xpY2tlZF9jaGlwOiBmdW5jdGlvbiAodG9nZ2xlLCBjaGlwKSB7XHJcbiAgICAgICAgdGhpcy5fY2hpcCA9IHBhcnNlSW50KGNoaXApO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+WIt+aWsOS4i+azqOaWh+acrFxyXG4gICAgUmVmcmVzaExhYmVsX0JldDogZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2FycmF5QmV0W2luZGV4XSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5MYWJlbEFycmF5X0JldFtpbmRleF0uc3RyaW5nID0gdGhpcy5fYXJyYXlCZXRbaW5kZXhdLnRvRml4ZWQoMik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLkxhYmVsQXJyYXlfQmV0W2luZGV4XS5zdHJpbmcgPSBcIjAuMDBcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+S/oeaBr+aMiemSrlxyXG4gICAgb25CdG5DbGlja19YaW5YaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuUGFuZWxYaW5YaS5hY3RpdmUgPSAhdGhpcy5QYW5lbFhpblhpLmFjdGl2ZTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vlvIDlpZborrDlvZXmjInpkq5cclxuICAgIG9uQnRuQ2xpY2tfSmlMdTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuUGFuZWxfamlsdS5hY3RpdmUgPSAhdGhpcy5QYW5lbF9qaWx1LmFjdGl2ZTtcclxuICAgICAgICB0aGlzLnNjcm9sbFZpZXdfamlsdS5jb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmdhbWVSZWNvcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGl0ZW0gPSBuZXcgY2MuaW5zdGFudGlhdGUodGhpcy5qaWx1X3ByZWIpO1xyXG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudChcInNtX3JlY29yZEl0ZW1cIikuaW5pdERhdGEodGhpcy5nYW1lUmVjb3JkW2ldKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3X2ppbHUuY29udGVudC5hZGRDaGlsZChpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75byA5aeL5oyJ6ZKuXHJcbiAgICBvbkJ0bkNsaWNrX0thaVNoaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkdXpodSA9IHRoaXMuR2V0RHVaaHUoKTtcclxuICAgICAgICBpZiAoZHV6aHUgPD0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLlBhbmVsX3Fpbmd4aWF6aHUuYWN0aXZlID0gdHJ1ZTsvL+ivt+S4i+azqFxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGlzLnN0YXRlTWFjaGluZS5JbnB1dF9TdGFydCgwLjAxLCB0aGlzLlRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vlo7Dpn7PlvIDlhbNcclxuICAgIG9uVG9nZ2xlQ2xpY2tfU2hlbmdZaW46IGZ1bmN0aW9uICh0b2dnbGUsIGN1c3RvbUV2ZW50RGF0YSkge1xyXG4gICAgICAgIGlmICh0b2dnbGUuaXNDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5Ob2RlQXVkaW9QYXJlbnQuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuTm9kZUF1ZGlvUGFyZW50LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChjYy5BdWRpb1NvdXJjZSkudm9sdW1lID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLk5vZGVBdWRpb1BhcmVudC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Ob2RlQXVkaW9QYXJlbnQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KGNjLkF1ZGlvU291cmNlKS52b2x1bWUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+i/lOWbnuWkp+WOheaMiemSrlxyXG4gICAgb25CdG5DbGlja19CYWNrSGFsbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubmV0d29yay5zb2NrZXQuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIkxvYmJ5TWFpblwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/orqHnrpflvpfliLDkuIvms6jph5Hpop1cclxuICAgIEdldER1Wmh1OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGR1emh1ID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2FycmF5QmV0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGR1emh1ICs9IHRoaXMuX2FycmF5QmV0W2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZHV6aHU7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75YWz6Zet55WM6Z2i5oyJ6ZKuXHJcbiAgICBvbkJ0bkNsaWNrX0Nsb3NlUGFuZWw6IGZ1bmN0aW9uIChldmVudCwgY3VzdG9tRXZlbnREYXRhKSB7XHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxufSk7Il19