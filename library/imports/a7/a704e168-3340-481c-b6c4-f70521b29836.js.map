{"version":3,"sources":["assets\\Script\\Fish_haiwang2\\Fishhaiwang2NetWork.js"],"names":["Fishhaiwang2NetWork","getInstant","_instance","undefined","Single","lobbyMain","fishMain","fishSocket","playerInfo","eventMgr","userList","tableId","seatId","seatIndex","roomBet","init","require","self","loginGame_Function","loginIP","port","userid","sign","socket","cc","sys","isNative","SocketIO","connect","on","isBrowser","close","gameDisconnect","contentGameServerFail_Function","e","openAlert","ret","emit","gametype","error","result","changeResultJSON_Function","resultid","Obj","bet","playerCoin","score","getComponent","netWork","disconnect","setFishSocketOn_Fuction","loginRoom_Function","find","QieHuanScene_normal","roomid","com_Tips","loadGameScene","showMessagebox_Function","msg","ResultCode","ResultData","TableId","gameName","audioEngine","stopAll","start_","res","onFishHit","createFish","shoot_r","position","bulletId","setPlayerEnter","UserId","nickname","headimgurl","diamond","setPlayerExit","PlayerSeatId","changePower","console","log","cast_skill_r","uid","playerId","_gameSocket","onBoomFishHit","setLobbyMainObj_Function","scene","setFishObj_Funtion","JSON","parse","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 捕鱼达人SOCKET通讯\r\n */\r\nvar Fishhaiwang2NetWork = (() => {\r\n    /**\r\n     * 单例模式\r\n     */\r\n    function getInstant() {\r\n        var _instance;\r\n        if (_instance === undefined) {\r\n            _instance = new Single();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    /**\r\n     * 逻辑层\r\n     */\r\n    function Single() {\r\n        //TODO:变量初始化未完成\r\n        this.lobbyMain = null;\r\n        this.fishMain = null;\r\n        this.fishSocket = null;\r\n        this.playerInfo = null;\r\n        this.eventMgr = null;\r\n        this.userList = null;\r\n        this.tableId = -1;\r\n        this.seatId = -1;\r\n        this.seatIndex = -1;\r\n        this.roomBet = 1;\r\n\r\n        /**\r\n         * 初始化\r\n         */\r\n        this.init = () => {\r\n            this.playerInfo = require(\"PlayerInfo\").getInstant;\r\n        };\r\n\r\n        /**\r\n         * 进入游戏\r\n         * @param {*} loginIP \r\n         * @param {*} port \r\n         * @param {*} userid \r\n         * @param {*} sign \r\n         */\r\n\r\n        let self = this;\r\n\r\n        self.loginGame_Function = (loginIP, port, userid, sign) => {\r\n            var socket = null;\r\n            if (cc.sys.isNative) {\r\n                self.fishSocket = SocketIO.connect(loginIP + \":\" + port);\r\n            } else {\r\n                socket = require(\"socket-io\");\r\n                self.fishSocket = socket(loginIP + \":\" + port);\r\n            }\r\n\r\n            //连接失败\r\n            self.fishSocket.on(\"error\", () => {\r\n                try {\r\n                    cc.sys.isBrowser && self.fishSocket.close();\r\n                    self.fishSocket = null;\r\n                    self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function(\"Fishhaiwang2\");\r\n                } catch (e) {\r\n                    self.fishMain.openAlert();\r\n                }\r\n            });\r\n            //连接失败\r\n            self.fishSocket.on(\"connect_error\", () => {\r\n                try {\r\n                    cc.sys.isBrowser && self.fishSocket.close();\r\n                    self.fishSocket = null;\r\n                    self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function(\"Fishhaiwang2\");\r\n                } catch (e) {\r\n                    self.fishMain.openAlert();\r\n                }\r\n            });\r\n            //连接超时\r\n            self.fishSocket.on(\"connect_timeout\", () => {\r\n                try {\r\n                    cc.sys.isBrowser && self.fishSocket.close();\r\n                    self.fishSocket = null;\r\n                    self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function(\"Fishhaiwang2\");\r\n                } catch (e) {\r\n                    self.fishMain.openAlert();\r\n                }\r\n            });\r\n            //连接\r\n            self.fishSocket.on(\"connected\", ret => {\r\n                if (ret) {\r\n                    try {\r\n                        //进入游戏\r\n                        self.fishSocket.emit(\"LoginGame\", {\r\n                            userid: userid, //用户ID\r\n                            gametype: 11, //游戏类型\r\n                            sign: sign //签名\r\n                        });\r\n                    } catch (error) { }\r\n                }\r\n            });\r\n\r\n            self.fishSocket.on(\"loginGameResult\", ret => {\r\n                let result = self.changeResultJSON_Function(ret);\r\n                //console.log('游戏登陆成功=======================' + JSON.stringify(result));\r\n                if (result.resultid) { //游戏登录成功\r\n                    self.roomBet = result.Obj.bet;\r\n                    self.playerInfo.playerCoin = result.Obj.score;\r\n                    self.lobbyMain.getComponent(\"LobbyMain\").netWork.socket.disconnect();\r\n\r\n                    self.setFishSocketOn_Fuction();\r\n                    self.loginRoom_Function();\r\n\r\n                    cc.find(\"Canvas/buttonCtrl\").getComponent(\"LobbyButtonClick\").QieHuanScene_normal(\"Fish_haiwang2Main\", () => {\r\n                        self.fishSocket.emit(\"LoginRoom\", { //登录游戏房间接口 roomid传 1 就好\r\n                            roomid: 1\r\n                        });\r\n                    });\r\n                } else {\r\n                    //游戏登录失败\r\n                    if (self.lobbyMain.com_Tips) {\r\n                        self.lobbyMain.getComponent(\"LobbyMain\").loadGameScene = false;\r\n                        self.lobbyMain.getComponent(\"LobbyMain\").showMessagebox_Function(result.msg, 1, 4);\r\n                    } else {\r\n                        self.fishMain.openAlert();\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        /**\r\n         * 进入房间\r\n         */\r\n        self.loginRoom_Function = () => {\r\n            //返回房间数据\r\n            self.fishSocket.on(\"LoginRoomResult\", ret => {\r\n                let result = self.changeResultJSON_Function(ret);\r\n                if (result.ResultCode) {\r\n                    self.tableId = result.ResultData.TableId;\r\n                    self.seatId = result.ResultData.seatId;\r\n                    //所有用户信息 userId: 3120, seatId: 0, nickname: \"cv123456\", score: 1004900, userType: 0,\r\n                    self.userList = result.ResultData.userList;\r\n                    self.playerInfo.gameDisconnect = false;\r\n                    self.playerInfo.gameName = \"Fishhaiwang2\";\r\n                    cc.audioEngine.stopAll();\r\n                    self.fishMain.start_();\r\n                }\r\n            });\r\n        };\r\n\r\n        /**\r\n         * 长连通讯\r\n         */\r\n        self.setFishSocketOn_Fuction = function () {\r\n            //击杀结果\r\n            self.fishSocket.on('HitResult', res => {\r\n                //console.log('hit: '+res);\r\n                let result = self.changeResultJSON_Function(res);\r\n                if (result.ResultCode == 1) {\r\n                    self.fishMain.onFishHit(result.ResultData);\r\n                }\r\n            });\r\n\r\n            //鱼进入场景\r\n            self.fishSocket.on('FishOut', res => {\r\n                // {\"fishId\":[7217],\"fishType\":18,\"fishPath\":13,\"fishCount\":1,\"fishLineup\":0,\"lineup\":false,\"propCount\":0}\r\n                //console.log('1111111' + JSON.stringify(res));\r\n\r\n                //console.log(\"出鱼：\"+JSON.stringify(res));\r\n                let result = self.changeResultJSON_Function(res);\r\n                // console.log(result);\r\n                if (self.fishMain) {\r\n                    self.fishMain.createFish(result);\r\n                    //var t = result;\r\n                    //self.fishMain.BirdCreat_Function(t.fishId, 16, t.fishPath, t.fishCount, t.fishLineup, t.lineup, t.propCount)\r\n                }\r\n            });\r\n\r\n            //发射结果\r\n            self.fishSocket.on('fishShoot', res => {\r\n                let result = self.changeResultJSON_Function(res);\r\n                //console.log('fishShoot=======================' + JSON.stringify(result));\r\n                self.fishMain.shoot_r(result.userid, result.position, result.bet, result.bulletId);\r\n            });\r\n\r\n            self.fishSocket.on('getDownTimeResult', res => {\r\n                let result = self.changeResultJSON_Function(ret);\r\n                //console.log('getDownTimeResult=======================' + JSON.stringify(result));\r\n            });\r\n\r\n            //用户进入\r\n            self.fishSocket.on('playEnter', res => {\r\n                let result = self.changeResultJSON_Function(res);\r\n                if (result.ResultCode) {\r\n                    self.fishMain.setPlayerEnter(result.ResultData.UserId, result.ResultData.seatId, result.ResultData.nickname, result.ResultData.score, result.ResultData.headimgurl, result.ResultData.diamond);\r\n                }\r\n            });\r\n\r\n            //用户退出\r\n            self.fishSocket.on('PlayerOut', res => {\r\n                let result = self.changeResultJSON_Function(res);\r\n                self.fishMain.setPlayerExit(result.PlayerSeatId);\r\n            });\r\n\r\n            self.fishSocket.on('changePowerResult', res => {\r\n                let result = self.changeResultJSON_Function(res);\r\n                self.fishMain.changePower(result);\r\n            });\r\n\r\n            self.fishSocket.on('useSkillResult', res => {\r\n                let result = self.changeResultJSON_Function(res);\r\n                console.log(\"useSkillResult\", result);\r\n                self.fishMain.cast_skill_r(result);\r\n            });\r\n\r\n\r\n            self.fishSocket.on('fishHit_boardResult', res => {\r\n                res = self.changeResultJSON_Function(res);\r\n                if (res.uid == self.playerInfo.playerId) {\r\n                    this._gameSocket.emit('fishHit', res);\r\n                }\r\n            })\r\n\r\n            self.fishSocket.on('userGoldUpdate', res => {\r\n\r\n            });\r\n\r\n            self.fishSocket.on('pool', res => {\r\n\r\n            });\r\n\r\n            self.fishSocket.on('fishSceneChange', res => {\r\n\r\n            });\r\n\r\n            self.fishSocket.on('getFishListResult', res => {\r\n\r\n            });\r\n\r\n            self.fishSocket.on('getMoguiCountResult', res => {\r\n\r\n            });\r\n\r\n            self.fishSocket.on('boomFishHitResult', res => {\r\n                // ResultData:{userId:_userId,hitSocre:score,fishList:outfishList}}\r\n                let result = self.changeResultJSON_Function(res);\r\n                self.fishMain.onBoomFishHit(result.ResultData);\r\n            });\r\n\r\n            self.fishSocket.on('disconnect', res => {\r\n                self.fishMain.openAlert();\r\n                try {\r\n                    cc.sys.isBrowser && self.fishSocket.close();\r\n                    self.fishSocket = null;\r\n                    self.playerInfo.gameDisconnect || self.lobbyMain.contentGameServerFail_Function(\"Fishhaiwang2\");\r\n                } catch (e) {\r\n\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * 传递this作用域\r\n         * @param {*} scene 来自LobbyMain.js\r\n         */\r\n        this.setLobbyMainObj_Function = scene => {\r\n            this.lobbyMain = scene;\r\n        };\r\n\r\n        /**\r\n         * 保存当前场景\r\n         */\r\n        this.setFishObj_Funtion = scene => {\r\n            this.fishMain = scene;\r\n        };\r\n\r\n        /**\r\n         * 解析JSON数据\r\n         * @param {*} ret \r\n         */\r\n        this.changeResultJSON_Function = ret => {\r\n            if (cc.sys.isNative) {\r\n                return JSON.parse(ret);\r\n            }\r\n            return ret;\r\n        };\r\n        this.init();\r\n    };\r\n    return {\r\n        getInstant: new getInstant()\r\n    }\r\n})();\r\n\r\nmodule.exports = Fishhaiwang2NetWork;"]}