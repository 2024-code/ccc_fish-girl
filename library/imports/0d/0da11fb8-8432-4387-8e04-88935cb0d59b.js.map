{"version":3,"sources":["assets\\Script\\platform\\onfire.js"],"names":["root","factory","module","exports","onfire","window","__onfireEvents","__cnt","string_str","function_str","hasOwnKey","Function","call","bind","Object","hasOwnProperty","slice","Array","prototype","_bind","eventName","callback","is_one","context","Error","_each","obj","key","on","one","_fire_func","args","item","apply","fire","arguments","setTimeout","fireSync","un","event","r","type","key_1","item_1","key_2","item_2","clear"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n  Copyright (c) 2016 hustcc http://www.atool.org/\r\n  License: MIT \r\n  https://github.com/hustcc/onfire.js\r\n**/\r\n/* jshint expr: true */ \r\n!function (root, factory) {\r\n    if (typeof module === 'object' && module.exports)\r\n      module.exports = factory();\r\n    else\r\n      root.onfire = factory();\r\n  }(typeof window !== 'undefined' ? window : this, function () {\r\n    var __onfireEvents = {},\r\n     __cnt = 0, // evnet counter\r\n     string_str = 'string',\r\n     function_str = 'function',\r\n     hasOwnKey = Function.call.bind(Object.hasOwnProperty),\r\n     slice = Function.call.bind(Array.prototype.slice);\r\n  \r\n    function _bind(eventName, callback, is_one, context) {\r\n      if (typeof eventName !== string_str || typeof callback !== function_str) {\r\n        throw new Error('args: '+string_str+', '+function_str+'');\r\n      }\r\n      if (! hasOwnKey(__onfireEvents, eventName)) {\r\n        __onfireEvents[eventName] = {};\r\n      }\r\n      __onfireEvents[eventName][++__cnt] = [callback, is_one, context];\r\n  \r\n      return [eventName, __cnt];\r\n    }\r\n    function _each(obj, callback) {\r\n      for (var key in obj) {\r\n        if (hasOwnKey(obj, key)) callback(key, obj[key]);\r\n      }\r\n    }\r\n    /**\r\n     *  onfire.on( event, func, context ) -> Object\r\n     *  - event (String): The event name to subscribe / bind to\r\n     *  - func (Function): The function to call when a new event is published / triggered\r\n     *  Bind / subscribe the event name, and the callback function when event is triggered, will return an event Object\r\n    **/\r\n    function on(eventName, callback, context) {\r\n      return _bind(eventName, callback, 0, context);\r\n    }\r\n    /**\r\n     *  onfire.one( event, func, context ) -> Object\r\n     *  - event (String): The event name to subscribe / bind to\r\n     *  - func (Function): The function to call when a new event is published / triggered\r\n     *  Bind / subscribe the event name, and the callback function when event is triggered only once(can be triggered for one time), will return an event Object\r\n    **/\r\n    function one(eventName, callback, context) {\r\n      return _bind(eventName, callback, 1, context);\r\n    }\r\n    function _fire_func(eventName, args) {\r\n      if (hasOwnKey(__onfireEvents, eventName)) {\r\n        _each(__onfireEvents[eventName], function(key, item) {\r\n          item[0].apply(item[2], args); // do the function\r\n          if (item[1]) delete __onfireEvents[eventName][key]; // when is one, delete it after triggle\r\n        });\r\n      }\r\n    }\r\n    /**\r\n     *  onfire.fire( event[, data1 [,data2] ... ] )\r\n     *  - event (String): The event name to publish\r\n     *  - data...: The data to pass to subscribers / callbacks\r\n     *  Async Publishes / fires the the event, passing the data to it's subscribers / callbacks\r\n    **/\r\n    function fire(eventName) {\r\n      // fire events\r\n      var args = slice(arguments, 1);\r\n      setTimeout(function () {\r\n        _fire_func(eventName, args);\r\n      });\r\n    }\r\n    /**\r\n     *  onfire.fireSync( event[, data1 [,data2] ... ] )\r\n     *  - event (String): The event name to publish\r\n     *  - data...: The data to pass to subscribers / callbacks\r\n     *  Sync Publishes / fires the the event, passing the data to it's subscribers / callbacks\r\n    **/\r\n    function fireSync(eventName) {\r\n      _fire_func(eventName, slice(arguments, 1));\r\n    }\r\n    /**\r\n     * onfire.un( event ) -> Boolean\r\n     *  - event (String / Object): The message to publish\r\n     * When passed a event Object, removes a specific subscription.\r\n     * When passed event name String, removes all subscriptions for that event name(hierarchy)\r\n    *\r\n     * Unsubscribe / unbind an event or event object.\r\n     *\r\n     * Examples\r\n     *\r\n     *  // Example 1 - unsubscribing with a event object\r\n     *  var event_object = onfire.on('my_event', myFunc);\r\n     *  onfire.un(event_object);\r\n     *\r\n     *  // Example 2 - unsubscribing with a event name string\r\n     *  onfire.un('my_event');\r\n    **/\r\n    function un(event) {\r\n      var eventName, key, r = false, type = typeof event;\r\n      if (type === string_str) {\r\n        // cancel the event name if exist\r\n        if (hasOwnKey(__onfireEvents, event)) {\r\n          delete __onfireEvents[event];\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n      else if (type === 'object') {\r\n        eventName = event[0];\r\n        key = event[1];\r\n        if (hasOwnKey(__onfireEvents, eventName) && hasOwnKey(__onfireEvents[eventName], key)) {\r\n          delete __onfireEvents[eventName][key];\r\n          return true;\r\n        }\r\n        // can not find this event, return false\r\n        return false;\r\n      }\r\n      else if (type === function_str) {\r\n        _each(__onfireEvents, function(key_1, item_1) {\r\n          _each(item_1, function(key_2, item_2) {\r\n            if (item_2[0] === event) {\r\n              delete __onfireEvents[key_1][key_2];\r\n              r = true;\r\n            }\r\n          });\r\n        });\r\n        return r;\r\n      }\r\n      return true;\r\n    }\r\n    /**\r\n     *  onfire.clear()\r\n     *  Clears all subscriptions\r\n    **/\r\n    function clear() {\r\n      __onfireEvents = {};\r\n    }\r\n    return {\r\n      on: on,\r\n      one: one,\r\n      un: un,\r\n      fire: fire,\r\n      fireSync: fireSync,\r\n      clear: clear\r\n    };\r\n  });"]}