{"version":3,"sources":["assets\\Script\\Lobby\\LobbyRegister.js"],"names":["window","getUrlParas","theRequest","Object","cc","sys","isNative","neturl","location","href","search","indexOf","str","substr","strs","split","i","length","Class","Component","properties","onLoad","md5","require","getInstant","actType","token","canLoign","account","password","messFire","onfire","on","onPlatformLogin","bind","acc","pwd","mlapiRegister_Function_wx","onDestroy","un","checkAccount_Function","url","userData","JSON","parse","localStorage","getItem","registerAccount_Function","os","OS_IOS","jsb","reflection","callStaticMethod","getComponent","playerInfo","playerId","netWork","socket","emit","userName","changeUserData_Function","data","writeUserDate_Function","callback","setItem","stringify","isLogin","self","getAccount_Function","loginAccount_Function","loginIp","daili","node","guest","iosChannel","getUrlCode_Function","time","parseInt","Date","sign","hex_md5","apiUrl","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","error","log","open","send","mlapiRegister_Function","mlapiRegisterAccount_Function","errormsg","accountChange","com_Register","getChildByName","string","str_mix","platform_name","platform_head","undefined","encodeURIComponent","global_post","aid","errot","name","reg","RegExp","result","match","decodeURIComponent"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 大厅用户注册管理类\r\n */\r\nwindow.getUrlParas = function()\r\n{\r\n   var theRequest = new Object();\r\n   if (cc.sys.isNative) return theRequest;\r\n   var neturl=window.location.href;  \r\n   var neturl = location.search;\r\n   if (neturl.indexOf(\"?\") != -1) {\r\n       var str = neturl.substr(1);\r\n       var strs = str.split(\"&\");\r\n       for(var i = 0; i < strs.length; i ++) {\r\n           theRequest[strs[i].split(\"=\")[0]]=(strs[i].split(\"=\")[1]);\r\n       }\r\n   }\r\n   return theRequest;\r\n}\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    },\r\n    onLoad: function () {\r\n        this.md5 = require(\"md5\").getInstant;\r\n        this.actType = '';\r\n        //口令\r\n        this.token = '42dfcb34fb02d8cd';\r\n        this.canLoign = false;\r\n        this.account = null;\r\n        this.password = null;\r\n\r\n        this.messFire = onfire.on(\"onplatform_login\", this.onPlatformLogin.bind(this)); //监听第三方相关事件\r\n    },\r\n\r\n    onPlatformLogin(acc, pwd) {\r\n        this.mlapiRegister_Function_wx(acc, pwd);\r\n    },\r\n    onDestroy: function () {\r\n        onfire.un(this.messFire);\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @param {*} url \r\n     */\r\n    checkAccount_Function: function (url) {\r\n        var userData = null;\r\n\r\n        //获取缓存中的用户数据\r\n        if(cc.sys.isNative)\r\n        {\r\n            userData = JSON.parse(cc.sys.localStorage.getItem(\"userData\"));\r\n        }\r\n        else\r\n        {\r\n            userData = JSON.parse(localStorage.getItem(\"userData\"));\r\n        }\r\n\r\n        if(userData == null)\r\n        {\r\n\r\n            this.registerAccount_Function(url, true);\r\n            //对苹果手机进行特殊处理\r\n            if(cc.sys.os === cc.sys.OS_IOS)\r\n            {\r\n                jsb.reflection.callStaticMethod(\"RootViewController\", \"UserId:\", this.getComponent(\"LobbyMain\").playerInfo.playerId);\r\n            }\r\n        }\r\n        else\r\n        {\r\n            //获取到缓存数据后，进行赋值\r\n            this.account = userData.account;\r\n            this.password = userData.password;\r\n            this.canLoign = true;\r\n            //通过缓存数据进行用户登录\r\n            if(this.getComponent(\"LobbyMain\").netWork.socket !== null)\r\n            {\r\n                this.getComponent(\"LobbyMain\").netWork.socket.emit(\"login\", {\r\n                    userName: this.account,\r\n                    password: this.password\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 将用户数据写入缓存\r\n     * @param {*} account \r\n     * @param {*} password \r\n     */\r\n    changeUserData_Function: function (account, password) {\r\n        var data = {\r\n            account: account,\r\n            password: password\r\n        };\r\n        this.writeUserDate_Function(data);\r\n    },\r\n\r\n    /**\r\n     * 将用户数据写入缓存\r\n     * @param {*} data \r\n     * @param {*} callback \r\n     */\r\n    writeUserDate_Function: function (data, callback) {\r\n        if (cc.sys.isNative) \r\n        {\r\n            cc.sys.localStorage.setItem(\"userData\", JSON.stringify(data));\r\n        }\r\n        else \r\n        {\r\n            localStorage.setItem(\"userData\", JSON.stringify(data));\r\n        }\r\n        callback && callback();\r\n    },\r\n\r\n    /**\r\n     * 注册游客，并进行登录\r\n     * @param {*} url \r\n     * @param {*} isLogin \r\n     */\r\n    registerAccount_Function: function (url, isLogin) {\r\n        var self = this;\r\n        //游客登录\r\n        this.getAccount_Function(url, function (account, password) {\r\n            var data = {\r\n                account: account,\r\n                password: password\r\n            };\r\n            //将游客账号写入缓存中,并进行socket登录\r\n            self.writeUserDate_Function(data, function(){\r\n                self.account = data.account;\r\n                self.password = data.password;\r\n                self.canLoign = true;\r\n                //是否socket登录\r\n                if (isLogin) \r\n                {\r\n                    self.getComponent(\"LobbyMain\").netWork.socket.emit(\"login\", {\r\n                        userName: self.account,\r\n                        password: self.password\r\n                    });\r\n                }\r\n                else {\r\n                    self.getComponent(\"LobbyMain\").netWork.loginAccount_Function(self.getComponent(\"LobbyMain\").playerInfo.loginIp, self.account, self.password);\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    /**\r\n     * 游客登录\r\n     * @param {*} url \r\n     * @param {*} callback \r\n     */\r\n    getAccount_Function: function (url, callback) {\r\n        this.actType = \"getGuessA\";\r\n        var daili = this.node.getComponent(\"LobbyMain\").playerInfo.guest;\r\n        if (cc.sys.isNative) \r\n        {\r\n            if (this.getComponent(\"LobbyMain\").playerInfo.iosChannel !== '') \r\n            {\r\n                daili = this.getComponent(\"LobbyMain\").playerInfo.iosChannel;\r\n            }\r\n        }\r\n        else \r\n        {\r\n            if(this.getUrlCode_Function(\"channel\") !== null)\r\n            {\r\n                daili = this.getUrlCode_Function(\"channel\");\r\n            }\r\n        }\r\n\r\n        var time = parseInt(Date.parse(new Date) / 1000);\r\n        var sign = this.md5.hex_md5(this.actType + daili + time + this.token);\r\n        var apiUrl = url + \"/weixinLogin?act=\" + this.actType + \"&time=\" + time + \"&daili=\" + daili + \"&sign=\" + sign;\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4 && xhr.status === 200) \r\n            {\r\n                var response = xhr.response;\r\n                if (xhr.response !== null) \r\n                {\r\n                    try \r\n                    {\r\n                        response = JSON.parse(response);\r\n                    }\r\n                    catch (error) \r\n                    {\r\n                        cc.log(\"JSON wrong\");\r\n                    }\r\n                    callback && callback(response.data.account, response.data.password);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"get\", apiUrl);\r\n        xhr.send();\r\n    },\r\n\r\n    /**\r\n     * HTTP注册账号\r\n     * @param {*} account \r\n     * @param {*} password \r\n     */\r\n    mlapiRegister_Function: function (account, password) {\r\n        this.actType = \"register\";\r\n        var guest = this.node.getComponent(\"LobbyMain\").playerInfo.guest;\r\n        var time = parseInt(Date.parse(new Date) / 1000);\r\n        var sign = this.md5.hex_md5(this.actType + account + account + password + time + this.token);\r\n        var url = this.node.getComponent(\"LobbyMain\").playerInfo.loginIp;\r\n        var apiUrl = url + \"/ml_api?act=\" + this.actType + \"&accountname=\" + account + \"&nickname=\" + account + \"&pwd=\" + password + \"&time=\" + time + \"&agc=\" + guest + \"&sign=\" + sign;\r\n        cc.log('账号注册:' + apiUrl);\r\n        this.mlapiRegisterAccount_Function(apiUrl, function (errormsg) {\r\n            cc.log('注册返回信息=================================' + errormsg);\r\n            switch (errormsg) {\r\n                case 0://注册成功\r\n                    this.node.getComponent(\"LobbyMain\").netWork.accountChange = true;\r\n                    this.node.getComponent(\"LobbyMain\").netWork.loginAccount_Function(this.node.getComponent(\"LobbyMain\").playerInfo.loginIp, account, password);\r\n                    break;\r\n                case 1:\r\n                    break;\r\n                case 2://注册失败，账号已存在\r\n                    this.node.getComponent(\"LobbyMain\").com_Register.getChildByName(\"eb_Account\").getComponent(\"cc.EditBox\").string = \"账号已存在\";\r\n                    break;\r\n                case 3://注册失败，账号已存在\r\n                    this.node.getComponent(\"LobbyMain\").com_Register.getChildByName(\"eb_Account\").getComponent(\"cc.EditBox\").string = \"账号已存在\";\r\n                    break;\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n\r\n    \r\n    mlapiRegister_Function_wx: function (account, password) {\r\n        this.actType = \"register\";\r\n        var guest = this.node.getComponent(\"LobbyMain\").playerInfo.guest;\r\n        var time = parseInt(Date.parse(new Date) / 1000);\r\n        var sign = this.md5.hex_md5(this.actType + account + account + password + time + this.token);\r\n        var url = this.node.getComponent(\"LobbyMain\").playerInfo.loginIp;\r\n        \r\n        var apiUrl = \"\";\r\n\r\n        var str_mix = \"weixinLogin\" + account + password + time + this.token;\r\n        sign = this.md5.hex_md5(str_mix);\r\n        \r\n        apiUrl = url + \"/weixinLogin?act=\" + \"weixinLogin\" + \"&accountname=\" + account + \"&nickname=\" + window.platform_name + \"&pwd=\" + password + \"&time=\" + time + \"&agc=\" + guest + \"&sign=\" + sign;\r\n        if (window.platform_head != undefined)\r\n        {\r\n            apiUrl+=\"&headimgurl=\" + encodeURIComponent(window.platform_head);\r\n        }\r\n\r\n        apiUrl = \"https://fangka.youmegame.cn/nxp.php?url=\" + encodeURIComponent(apiUrl);\r\n        window.global_post = true;\r\n\r\n        var theRequest = window.getUrlParas();\r\n        if (theRequest.aid)\r\n        {\r\n            apiUrl+=\"&aid=\";\r\n            apiUrl+=theRequest.aid;\r\n        }\r\n        \r\n        cc.log('账号注册:' + apiUrl);\r\n        this.mlapiRegisterAccount_Function(apiUrl, function (errormsg) {\r\n            cc.log('注册返回信息=================================' + errormsg);\r\n            errormsg = parseInt(errormsg);\r\n            switch (errormsg) {\r\n                case 0://注册成功\r\n                    this.node.getComponent(\"LobbyMain\").netWork.accountChange = true;\r\n                    \r\n                    this.node.getComponent(\"LobbyMain\").netWork.loginAccount_Function(this.node.getComponent(\"LobbyMain\").playerInfo.loginIp, account, password);\r\n                    break;\r\n                case 1:\r\n                    this.node.getComponent(\"LobbyMain\").com_Register.getChildByName(\"eb_Account\").getComponent(\"cc.EditBox\").string = \"信息错误或用户名重复\";\r\n                    break;\r\n                case 2://注册失败，账号已存在\r\n                    this.node.getComponent(\"LobbyMain\").com_Register.getChildByName(\"eb_Account\").getComponent(\"cc.EditBox\").string = \"账号已存在\";\r\n                    if (cc.sys.isNative){\r\n                        this.node.getComponent(\"LobbyMain\").netWork.loginAccount_Function(this.node.getComponent(\"LobbyMain\").playerInfo.loginIp, account, password);\r\n                    }\r\n                    break;\r\n                case 3://注册失败，账号已存在\r\n                    this.node.getComponent(\"LobbyMain\").com_Register.getChildByName(\"eb_Account\").getComponent(\"cc.EditBox\").string = \"账号已存在\";\r\n                    if (cc.sys.isNative){\r\n                        this.node.getComponent(\"LobbyMain\").netWork.loginAccount_Function(this.node.getComponent(\"LobbyMain\").playerInfo.loginIp, account, password);\r\n                    }\r\n                    break;\r\n            }\r\n        }.bind(this));\r\n    },\r\n\r\n    /**\r\n     * 发送HTTP注册请求\r\n     * @param {*} url \r\n     * @param {*} callback \r\n     */\r\n    mlapiRegisterAccount_Function: function (url, callback) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4 && xhr.status === 200) {\r\n                var response = xhr.response;\r\n                if (null !== xhr.response !== null) \r\n                {\r\n                    try \r\n                    {\r\n                        response = JSON.parse(response);\r\n                    }\r\n                    catch (errot) \r\n                    {\r\n                        cc.log(\"JSON wrong\");\r\n                    }\r\n                    callback && callback(response.status);\r\n                }\r\n            }\r\n        };\r\n        if (window.global_post)\r\n        {\r\n            window.global_post = false;\r\n            xhr.open(\"post\", url);\r\n        }else{\r\n                xhr.open(\"get\", url);\r\n        }\r\n        xhr.send();\r\n    },\r\n\r\n    /**\r\n     * 获取url参数\r\n     * @param {*} name \r\n     */\r\n    getUrlCode_Function: function (name) {\r\n        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');\r\n        var result = window.location.search.substr(1).match(reg);\r\n        return result ? decodeURIComponent(result[2]) : null;\r\n    }\r\n});\r\n"]}